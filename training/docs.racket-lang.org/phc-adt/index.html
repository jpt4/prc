<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Algebraic Data Types for compilers</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Algebraic Data Types for compilers</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Tagged_structures.html" class="tocviewlink" data-pltdoc="x">Tagged structures</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Untagged_structures.html" class="tocviewlink" data-pltdoc="x">Untagged structures</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Constructors.html" class="tocviewlink" data-pltdoc="x">Constructors</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Variants.html" class="tocviewlink" data-pltdoc="x">Variants</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">Algebraic Data Types for compilers</a></td></tr><tr><td><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">adt-<wbr></wbr>init</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<a href="Tagged_structures.html" title="forward to &quot;1 Tagged structures&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h2 x-source-module="(lib &quot;phc-adt/scribblings/phc-adt.scrbl&quot;)" x-source-pkg="phc-adt-doc" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.Algebraic_.Data_.Types_for_compilers)"></a><a name="(mod-path._phc-adt)"></a><a name="(mod-path._phc-adt/declarations)"></a>Algebraic Data Types for compilers</h2><p></p><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">phc-adt</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/phc-adt-lib" title="Install this package using `raco pkg install phc-adt-lib`"><span class="stt">phc-adt-lib</span></a></span></td></tr></table></p><p>This library is implmented using literate programming. The
implementation details are presented in
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=phc-adt-implementation&amp;rel=index.html&amp;version=7.4" class="Sq" data-pltdoc="x">Algebraic Data Types for compilers: Implementation</a>.</p><p>This library defines <a href="Tagged_structures.html#%28tech._tagged._structure%29" class="techoutside" data-pltdoc="x"><span class="techinside">tagged structures</span></a>, <a href="Untagged_structures.html#%28tech._untagged._structure%29" class="techoutside" data-pltdoc="x"><span class="techinside">untagged structures</span></a>,
<a href="Constructors.html#%28tech._constructor%29" class="techoutside" data-pltdoc="x"><span class="techinside">constructors</span></a> and <a href="Variants.html#%28tech._variant%29" class="techoutside" data-pltdoc="x"><span class="techinside">variants</span></a>. While uses of Racket&rsquo;s
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span> need the struct to be declared before they are used, the
structures implemented by this library can be used anonymously, without
declaring them in advance. All uses of a tagged structure with the same tag
name and set of fields are equivalent, even if they are declared in separate
files. It is also possible to access a field on a tagged structure instance
without specifying the tagged structure&rsquo;s tag name. This is used in a separate
library (not published yet) to implement the dotted notation commonly used in
object-oriented languages for field accesses, <span class="RktSym">instance.field</span>.</p><p>This library works by saving across compilations the list of all tagged
structures used across the program. The tag name and list of field names for
each tagged structure is written to a file. That file is, by default, located
in the same directory as the source file, and it is called
<span class="stt">"adt-pre-declarations.rkt"</span>, but this can be changed using the optional
argument to <span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxLink" data-pltdoc="x">adt-init</a></span>. These "remembered" tagged structure definitions
are used to pre-declare the <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span>s corresponding to each tagged
structure, so that all the code using the same
<span class="stt">"adt-pre-declarations.rkt"</span> file sees the same structure definitions.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._phc-adt/adt-init..rkt)._adt-init))"></a><span title="Provided from: phc-adt | Package: phc-adt-lib"><span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">adt-init</a></span></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">adt-init</a></span><span class="hspace">&nbsp;</span><span class="RktVar">pre-declarations-file</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">pre-declarations-file</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxLink" data-pltdoc="x">adt-init</a></span><span class="RktPn">)</span> macro has to be called in a
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=syntax-model.html%23%2528tech._module._context%2529&amp;version=7.4" class="techoutside Sq" data-pltdoc="x"><span class="techinside">module context</span></a>,
after the <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">phc-adt</span><span class="RktPn">)</span> but before using any of the identifiers
provided by this library.</div></p><p>The <span class="RktVar">pre-declarations-file</span> (which defaults to <span class="stt">"adt-pre-declarations.rkt"</span>) should be the string representation of a path,
relative to the directory containing the file which uses <span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxLink" data-pltdoc="x">adt-init</a></span>.</p><p>The <span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxLink" data-pltdoc="x">adt-init</a></span> macro creates the <span class="RktVar">pre-declarations-file</span> if it
does not exist, and <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span>s it. The <span class="RktVar">pre-declarations-file</span>
contains a list of remembered tagged structures (specifically, the tag name
followed by a list of field names). It uses the <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a>
<a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">phc-adt/declarations</span></a> which pre-declares the <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=ts-reference&amp;rel=special-forms.html%23%2528form._%2528%2528lib._typed-racket%252Fbase-env%252Fprims..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span>s
corresponding to each remembered tagged structure.</p><p>It then makes all the identifiers defined by this library available (the
identifiers cannot otherwise be used before calling <span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxLink" data-pltdoc="x">adt-init</a></span>).</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">phc-adt/declarations</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/phc-adt-lib" title="Install this package using `raco pkg install phc-adt-lib`"><span class="stt">phc-adt-lib</span></a></span></td></tr></table></div><div class="SIntrapara">This <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a> is used by the <span class="RktVar">pre-declarations-file</span> (see
<span class="RktSym"><a href="#%28form._%28%28lib._phc-adt%2Fadt-init..rkt%29._adt-init%29%29" class="RktStxLink" data-pltdoc="x">adt-init</a></span>), and is not intended to be used in other situations.</div></p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Tagged_structures.html" class="toptoclink" data-pltdoc="x">1<span class="hspace">&nbsp;</span>Tagged structures</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Untagged_structures.html" class="toptoclink" data-pltdoc="x">2<span class="hspace">&nbsp;</span>Untagged structures</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Constructors.html" class="toptoclink" data-pltdoc="x">3<span class="hspace">&nbsp;</span>Constructors</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Variants.html" class="toptoclink" data-pltdoc="x">4<span class="hspace">&nbsp;</span>Variants</a></p></td></tr></table><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<a href="Tagged_structures.html" title="forward to &quot;1 Tagged structures&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>