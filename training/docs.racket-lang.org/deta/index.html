<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>deta: Functional Database Mapping</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="stt">deta</span>:<span class="mywbr"> &nbsp;</span> Functional Database Mapping</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._principles%29" class="tocviewlink" data-pltdoc="x">Principles</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._tutorial%29" class="tocviewlink" data-pltdoc="x">Tutorial</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._versus%29" class="tocviewlink" data-pltdoc="x">Compared to *</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._todos%29" class="tocviewlink" data-pltdoc="x">TODOs</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._reference%29" class="tocviewlink" data-pltdoc="x">Reference</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">deta</span>:<span class="mywbr"> &nbsp;</span> Functional Database Mapping</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._principles%29" class="tocsubseclink" data-pltdoc="x">Principles</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.Non-goals%29" class="tocsubseclink" data-pltdoc="x">Non-<wbr></wbr>goals</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._tutorial%29" class="tocsubseclink" data-pltdoc="x">Tutorial</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._versus%29" class="tocsubseclink" data-pltdoc="x">Compared to *</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.Racquel%29" class="tocsubseclink" data-pltdoc="x">Racquel</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._sql%29" class="tocsubseclink" data-pltdoc="x">sql</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._todos%29" class="tocsubseclink" data-pltdoc="x">TODOs</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._reference%29" class="tocsubseclink" data-pltdoc="x">Reference</a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._.Query%29" class="tocsubseclink" data-pltdoc="x">Query</a></td></tr><tr><td><span class="tocsublinknumber">5.1.1<tt>&nbsp;</tt></span><a href="#%28part._.D.D.L%29" class="tocsubseclink" data-pltdoc="x">DDL</a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._create-table%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">create-<wbr></wbr>table!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._drop-table%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">drop-<wbr></wbr>table!</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Entity_.C.R.U.D%29" class="tocsubseclink" data-pltdoc="x">Entity CRUD</a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">insert!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert-one%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">insert-<wbr></wbr>one!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">in-<wbr></wbr>entities</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._lookup%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">lookup</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._update%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">update!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._update-one%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">update-<wbr></wbr>one!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">delete!</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete-one%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">delete-<wbr></wbr>one!</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.1.3<tt>&nbsp;</tt></span><a href="#%28part._.Query_.Combinators%29" class="tocsubseclink" data-pltdoc="x">Query Combinators</a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">query?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">delete</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">from</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._group-by%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">group-<wbr></wbr>by</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">join</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._limit%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">limit</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._offset%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">offset</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">order-<wbr></wbr>by</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._project-onto%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">project-<wbr></wbr>onto</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._returning%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">returning</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">select</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._update%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">update</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">where</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._or-where%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">or-<wbr></wbr>where</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._.Schema%29" class="tocsubseclink" data-pltdoc="x">Schema</a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">entity?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._schema~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">schema?</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>schema</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._schema-out%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">schema-<wbr></wbr>out</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="#%28part._.Type%29" class="tocsubseclink" data-pltdoc="x">Type</a></td></tr><tr><td><span class="tocsublinknumber">5.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Support_.Matrix%29" class="tocsubseclink" data-pltdoc="x">Support Matrix</a></td></tr><tr><td><span class="tocsublinknumber">5.3.2<tt>&nbsp;</tt></span><a href="#%28part._.Types%29" class="tocsubseclink" data-pltdoc="x">Types</a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">type?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">id/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._integer%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">integer/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._real%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">real/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._numeric%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">numeric/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">string/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._binary%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">binary/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._symbol%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">symbol/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._boolean%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">boolean/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._date%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">date/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._time%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">time/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._datetime%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">datetime/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._datetime-tz%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">datetime-<wbr></wbr>tz/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._array%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">array/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._json%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">json/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._jsonb%2Ff%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">jsonb/<span class="mywbr"> &nbsp;</span>f</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5.4<tt>&nbsp;</tt></span><a href="#%28part._changelog%29" class="tocsubseclink" data-pltdoc="x">Changelog</a></td></tr><tr><td><span class="tocsublinknumber">5.4.1<tt>&nbsp;</tt></span><a href="#%28part._v0_2_0_--_2019-07-20%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">v0.2.0</span> &ndash; 2019-<wbr></wbr>07-<wbr></wbr>20</a></td></tr><tr><td><span class="tocsublinknumber">5.4.2<tt>&nbsp;</tt></span><a href="#%28part._v0_1_0_--_2019-07-19%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">v0.1.0</span> &ndash; 2019-<wbr></wbr>07-<wbr></wbr>19</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._deta__.Functional_.Database_.Mapping)"></a><a name="(mod-path._deta)"></a><span class="stt">deta</span>: Functional Database Mapping</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Bogdan Popa &lt;<a href="mailto:bogdan@defn.io">bogdan@defn.io</a>&gt;</p></span></div><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">deta</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/deta-lib" title="Install this package using `raco pkg install deta-lib`"><span class="stt">deta-lib</span></a></span></td></tr></table></p><p>This library automatically maps database tables to Racket structs and
lets you perform CRUD operations on them as well as arbitrary queries.
Sort of like an ORM, but without associations and all the bad bits.</p><p>The API is currently fairly stable, but it may change before 1.0.
Watch the <a href="https://github.com/Bogdanp/deta">GitHub repository</a> if you want to stay on top of
potential changes.</p><h3 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;principles&quot;">1<tt>&nbsp;</tt><a name="(part._principles)"></a>Principles</h3><p>The main principle backing this library is "explicitness without
tedium."  By that I mean that it should be crystal clear to someone
who is reading code that uses this library how the code maps to
database operations, while making the common cases of mapping data
between database tables and Racket structs straightforward and simple.</p><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Non-goals&quot;">1.1<tt>&nbsp;</tt><a name="(part._.Non-goals)"></a>Non-goals</h4><ul><li><p><span style="font-weight: bold">Support for every SQL dialect.</span>  Despite the fact that
both SQLite and PostgreSQL are currently supported by this
library, the focus is on PostgreSQL and SQLite just serves as
a check to ensure that nothing is <span style="font-style: italic">too</span> PostgreSQL
specific.</p></li><li><p><span style="font-weight: bold">Being a general purpose SQL DSL</span>.  For some queries you
may have to resort to raw SQL or the <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=sql&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">sql</span></a>
library.  deta is very much an "80% solution."</p></li><li><p><span style="font-weight: bold">Being externally-extensible.</span>  The SQL AST as well as
all of the dialect code is considered private and any new
dialects (such as MySQL) will have to be added to the library
itself.</p></li></ul><p>If you&rsquo;re down with that, then, by all means, carry on and read the
tutorial!</p><h3 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;tutorial&quot;">2<tt>&nbsp;</tt><a name="(part._tutorial)"></a>Tutorial</h3><p>deta builds upon the <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db</span></a> library.  You will use deta to
generate your mappings and create queries, but the db library will be
doing the actual work of talking to the database and handling
transactions.</p><p>Let&rsquo;s start by creating a database connection in the usual way:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">db</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fmain..rkt%2529._postgresql-connect%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">postgresql-connect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:database</span><span class="hspace">&nbsp;</span><span class="RktVal">"deta"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:user</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"deta"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:password</span><span class="hspace">&nbsp;</span><span class="RktVal">"deta"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>Next, let&rsquo;s define a schema for books:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">deta</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">id</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="RktValLink" data-pltdoc="x">id/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:primary-key</span><span class="hspace">&nbsp;</span><span class="RktPn">#:auto-increment</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">title</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:contract</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:wrapper</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-titlecase%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string-titlecase</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">author</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:contract</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">published-on</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._date%2Ff%29%29" class="RktValLink" data-pltdoc="x">date/f</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>The above generates a struct named <span class="RktSym">book</span> with fields for the
table&rsquo;s <span class="RktSym">id</span>, <span class="RktSym">title</span>, <span class="RktSym">author</span> and <span class="RktSym">published-on</span>
columns, an associated "smart constructor" called <span class="RktSym">make-book</span>
and functional setter and updater functions for each field.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">gregor</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-book</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"To Kill a Mockingbird"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:author</span><span class="hspace">&nbsp;</span><span class="RktVal">"Harper Lee"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1960</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">book-id</span><span class="hspace">&nbsp;</span><span class="RktSym">a-book</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#&lt;sql-null&gt;</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">book-title</span><span class="hspace">&nbsp;</span><span class="RktSym">a-book</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"To Kill A Mockingbird"</span></p></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">book-title</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update-book-title</span><span class="hspace">&nbsp;</span><span class="RktSym">a-book</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._lambda%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-append%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktVal">"?"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">"To Kill A Mockingbird?"</span></p></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">schema entities are immutable so the above did not change a-book</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">book-title</span><span class="hspace">&nbsp;</span><span class="RktSym">a-book</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"To Kill A Mockingbird"</span></p></td></tr></table></blockquote><p>We can use the schema to issue DDL commands to the database and create
the table:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._create-table%21%29%29" class="RktValLink" data-pltdoc="x">create-table!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">book</span><span class="RktPn">)</span></td></tr></table></blockquote><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Note that while the DDL functionality is convenient for
the purposes of this tutorial, in real world projects you should
probably use something like <a href="https://docs.racket-lang.org/north/index.html">north</a> to manage
your database table schemas.</p></blockquote></blockquote></blockquote><p>Now that we have a table, we can insert the book that we created into
the database:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">saved-book</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert-one%21%29%29" class="RktValLink" data-pltdoc="x">insert-one!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktSym">a-book</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">book-id</span><span class="hspace">&nbsp;</span><span class="RktSym">saved-book</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">1</span></p></td></tr></table></blockquote><p>Let&rsquo;s insert a few more books:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert%21%29%29" class="RktValLink" data-pltdoc="x">insert!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"1984"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:author</span><span class="hspace">&nbsp;</span><span class="RktVal">"George Orwell"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1949</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"The Lord of the Rings"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:author</span><span class="hspace">&nbsp;</span><span class="RktVal">"J.R.R. Tolkien"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1954</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktVal">29</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"The Catcher in the Rye"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:author</span><span class="hspace">&nbsp;</span><span class="RktVal">"J.D. Salinger"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1949</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktVal">16</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p>And now let&rsquo;s query for all of the books published before 1955:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">threading</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%252Flist%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="RktValLink" data-pltdoc="x">in-entities</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3c%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"1955-01-01"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b.published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">#:desc</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-title</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">'("The Lord Of The Rings" "The Catcher In The Rye" "1984")</span></p></td></tr></table></blockquote><p>Sweet!  Here&rsquo;s the query we just ran:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3c%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"1955-01-01"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b.published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">#:desc</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktOut">#&lt;query: SELECT b.id, b.title, b.author, b.published_on FROM books AS b WHERE b.published_on &lt; (DATE '1955-01-01') ORDER BY b.published_on DESC&gt;</span></p></td></tr></table></blockquote><p>What about dynamic parameters, you may ask?  Let&rsquo;s wrap the above
query in a function:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">books-before</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3c%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.published-on</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=sql-types.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._sql-date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">sql-date</a></span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b.published-on</span><span class="hspace">&nbsp;</span><span class="RktPn">#:desc</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%252Flist%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="RktValLink" data-pltdoc="x">in-entities</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">books-before</span><span class="hspace">&nbsp;</span><span class="RktVal">1950</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-title</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">'("The Catcher In The Rye" "1984")</span></p></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%252Flist%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="RktValLink" data-pltdoc="x">in-entities</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">books-before</span><span class="hspace">&nbsp;</span><span class="RktVal">1955</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-title</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">'("The Lord Of The Rings" "The Catcher In The Rye" "1984")</span></p></td></tr></table></blockquote><p>Any time the query combinators encounter an <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=quasiquote.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._unquote%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">unquote</a></span>, that
value gets replaced with a placeholder node in the query AST and, when
the query is eventually executed, the value is bound to its prepared
statement.  This makes it safe and easy to parameterize your queries
without having to worry about SQL injection attacks.</p><p>Oftentimes, you&rsquo;ll want to query data from the DB that doesn&rsquo;t match
your schema.  For example, let&rsquo;s say we want to grab the number of
books published by year from our database.  To do that, we can declare
a "virtual" schema &ndash; one whose entities can&rsquo;t be persisted &ndash; and
project our queries onto that schema.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book-stats</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:virtual</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">year</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._date%2Ff%29%29" class="RktValLink" data-pltdoc="x">date/f</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">books</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._integer%2Ff%29%29" class="RktValLink" data-pltdoc="x">integer/f</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">books-published-by-year</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">as</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cast</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">date_trunc</span><span class="hspace">&nbsp;</span><span class="RktVal">"year"</span><span class="hspace">&nbsp;</span><span class="RktSym">b.published-on</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count</span><span class="hspace">&nbsp;</span><span class="RktSym">b.title</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._group-by%29%29" class="RktStxLink" data-pltdoc="x">group-by</a></span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._project-onto%29%29" class="RktValLink" data-pltdoc="x">project-onto</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book-stats-schema</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="RktValLink" data-pltdoc="x">in-entities</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktSym">books-published-by-year</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"year: ~a books: ~a"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-stats-year</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-stats-books</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">year: #&lt;date 1949-01-01&gt; books: 2</span></p></td></tr><tr><td><p><span class="RktOut">year: #&lt;date 1954-01-01&gt; books: 1</span></p></td></tr><tr><td><p><span class="RktOut">year: #&lt;date 1960-01-01&gt; books: 1</span></p></td></tr></table></td></tr></table></blockquote><p>If we hadn&rsquo;t wrapped our query with <span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._project-onto%29%29" class="RktValLink" data-pltdoc="x">project-onto</a></span>, then the
data would&rsquo;ve been returned as <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">values</a></span> which we could
destructure inside the <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span> loop, exactly like
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._in-query%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">in-query</a></span> from <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">db</span></a>.</p><p>It&rsquo;s time to wind things down so let&rsquo;s delete all the books published
before 1950:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._query-exec%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">query-exec</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">books-before</span><span class="hspace">&nbsp;</span><span class="RktVal">1950</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Re-run the last query to make sure it worked:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="RktValLink" data-pltdoc="x">in-entities</a></span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktSym">books-published-by-year</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._format%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"year: ~a books: ~a"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-stats-year</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">book-stats-books</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">year: #&lt;date 1954-01-01&gt; books: 1</span></p></td></tr><tr><td><p><span class="RktOut">year: #&lt;date 1960-01-01&gt; books: 1</span></p></td></tr></table></td></tr></table></blockquote><p>That&rsquo;s all there is to it.  You now know the basics of deta.  Thanks
for following along!  If you want to learn more be sure to check out
the reference documentation below.</p><h3 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;versus&quot;">3<tt>&nbsp;</tt><a name="(part._versus)"></a>Compared to *</h3><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Racquel&quot;">3.1<tt>&nbsp;</tt><a name="(part._.Racquel)"></a>Racquel</h4><p>Racquel takes a more classic approach to database mapping by being a
"real" ORM.  It is based on the class system, with entities (data
objects, as it calls them) being backed by mutable objects and having
support for associations via lazy loading.  deta&rsquo;s approach is nearly
the opposite of this by focusing on working with immutable structs,
avoiding associations altogether and any sort of lazy behaviour.</p><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;sql&quot;">3.2<tt>&nbsp;</tt><a name="(part._sql)"></a>sql</h4><p><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=sql&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">sql</span></a> is great at statically generating SQL queries.
The problem is that the generated queries are not composable at
runtime.  You have to write macros upon macros to handle composition
and I&rsquo;ve found that that gets tedious quickly.</p><p>On top of giving you composable queries &ndash; as you can hopefully see
from the tutorial &ndash;, deta also automatically maps CRUD operations to
structs, which is out of scope for <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=sql&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">sql</span></a>.</p><h3 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;todos&quot;">4<tt>&nbsp;</tt><a name="(part._todos)"></a>TODOs</h3><p>The following features are planned:</p><ul><li><p><span class="stt">VALUES</span> expressions</p></li><li><p>Column constraints for DDL</p></li></ul><p>The following query forms are not currently supported:</p><ul><li><p><span class="stt">WITH ... { </span><a href="https://www.postgresql.org/docs/11/sql-select.html">SELECT</a><span class="stt"> | </span><a href="https://www.postgresql.org/docs/11/sql-update.html">UPDATE</a><span class="stt"> | </span><a href="https://www.postgresql.org/docs/11/sql-delete.html">DELETE</a><span class="stt"> }  ...</span></p></li><li><p><a href="https://www.postgresql.org/docs/11/sql-update.html">UPDATE</a><span class="stt"> ... FROM ...</span></p></li><li><p><a href="https://www.postgresql.org/docs/11/sql-select.html">SELECT</a><span class="stt"> DISTINCT ...</span></p></li><li><p><a href="https://www.postgresql.org/docs/11/sql-select.html">SELECT</a><span class="stt"> ... HAVING ...</span></p></li><li><p><a href="https://www.postgresql.org/docs/11/sql-select.html">SELECT</a><span class="stt"> ... WINDOW ...</span></p></li><li><p><a href="https://www.postgresql.org/docs/11/sql-select.html">SELECT</a><span class="stt"> ... {UNION | INTERSECT | EXCEPT} ...</span></p></li><li><p><a href="https://www.postgresql.org/docs/11/sql-select.html">SELECT</a><span class="stt"> ... FOR UPDATE ...</span></p></li></ul><h3 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;reference&quot;">5<tt>&nbsp;</tt><a name="(part._reference)"></a>Reference</h3><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Query&quot;">5.1<tt>&nbsp;</tt><a name="(part._.Query)"></a><a name="(mod-path._deta/query)"></a>Query</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._deta%2Fquery%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">deta/query</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/deta-lib" title="Install this package using `raco pkg install deta-lib`"><span class="stt">deta-lib</span></a></span></td></tr></table></p><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;DDL&quot;">5.1.1<tt>&nbsp;</tt><a name="(part._.D.D.L)"></a>DDL</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._create-table!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._create-table%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">create-table!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">schema</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">schema</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._schema~3f%29%29" class="RktValLink" data-pltdoc="x">schema?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates the table represented by <span class="RktVar">schema</span> if it does not
exist.  If <span class="RktVar">schema</span> is a symbol, then it is looked up in the
global registry.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._drop-table!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._drop-table%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">drop-table!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">schema</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">schema</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._schema~3f%29%29" class="RktValLink" data-pltdoc="x">schema?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Drops the table represented by <span class="RktVar">schema</span> if it exists.</div></p><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Entity_CRUD&quot;">5.1.2<tt>&nbsp;</tt><a name="(part._.Entity_.C.R.U.D)"></a>Entity CRUD</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._insert!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">insert!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Attempts to insert any newly-created entities into the database,
returning the ones that were persisted.  Entities that have already
been persisted are ignored.</div></p><p>Raises a user error if any of the entities are based on virtual
schemas.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._insert-one!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert-one%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">insert-one!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._false%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">false/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Attempts to insert <span class="RktVar">e</span>.  If it doesn&rsquo;t need to be persisted,
then <span class="RktVal">#f</span> is returned.</div></p><p>Equivalent to:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert%21%29%29" class="RktValLink" data-pltdoc="x">insert!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._in-entities))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._in-entities%29%29" class="RktValDef RktValLink" data-pltdoc="x">in-entities</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:batch-size</span><span class="hspace">&nbsp;</span><span class="RktVar">batch-size</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=sequences.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._sequence%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">sequence?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">batch-size</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-positive-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-positive-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span></td></tr></table></blockquote></div><div class="SIntrapara">Queries the database and, based on <span class="RktVar">q</span>, either returns a
sequence of entities or a sequence of <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">values</a></span>.</div></p><p><span class="RktPn">#:batch-size</span> controls how many rows to fetch from the
databaase at a time.  It is analogous to <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=query-api.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._in-query%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">in-query</a></span>&rsquo;s
<span class="RktPn">#:fetch</span> argument.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._lookup))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._lookup%29%29" class="RktValDef RktValLink" data-pltdoc="x">lookup</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">q</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">any</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Retrieves the first result for <span class="RktVar">q</span>.</div></p><p>If there are no results then <span class="RktVal">#f</span> is returned.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._update!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._update%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">update!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Attempts to update any modified entities.  Only updates the fields
that have changed since the entities were retrieved from the
database.  Returns those entities that have been updated.</div></p><p>Raises a user error if any of the entities don&rsquo;t have a primary key
field.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._update-one!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._update-one%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">update-one!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._false%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">false/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Attempts to update <span class="RktVar">e</span>.  If it doesn&rsquo;t need to be updated,
then <span class="RktVal">#f</span> is returned.</div></p><p>Equivalent to:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._update%21%29%29" class="RktValLink" data-pltdoc="x">update!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._delete!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">delete!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Attempts to delete any previously-persisted entities.  Returns those
entities that have been deleted.</div></p><p>Raises a user error if any of the entities don&rsquo;t have a primary key
field.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._delete-one!))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete-one%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">delete-one!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._false%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">false/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=db&amp;rel=connect.html%23%2528def._%2528%2528lib._db%252Fbase..rkt%2529._connection%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">connection?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Attempts to delete <span class="RktVar">e</span>.  If it doesn&rsquo;t need to be deleted,
then <span class="RktVal">#f</span> is returned.</div></p><p>Equivalent to:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%21%29%29" class="RktValLink" data-pltdoc="x">delete!</a></span><span class="hspace">&nbsp;</span><span class="RktVar">conn</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></blockquote><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Query_Combinators&quot;">5.1.3<tt>&nbsp;</tt><a name="(part._.Query_.Combinators)"></a>Query Combinators</h5><blockquote class="SCentered"><table cellspacing="0" cellpadding="0"><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">q-expr</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym">array</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym">as</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">id</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktSym">...+</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=case.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._case%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">case</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">...+</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=case.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._case%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">case</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym">...+</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._or%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktSym">...+</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktRdr">,</span><span class="RktVar">expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">ident</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">boolean</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">string</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">number</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">app</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">app</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">ident</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">symbol</span></td></tr></table></blockquote><p>The grammar for SQL expressions.</p><p>Within an SQL expression, the following identifiers are treated
specially by the base (i.e. PostgreSQL) dialect.  These are inherited
by other dialects, but using them may result in invalid queries.</p><p><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td style="border-bottom: 1px solid black;"><p><span style="font-weight: bold">Identifier</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><p></p></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">array-concat</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">array-concat</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ARRAY[1] || ARRAY[2, 3]</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">array-contains?</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">array-contains?</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ARRAY[1, 2] @&gt; ARRAY[1]</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">array-overlap?</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">array-overlap?</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ARRAY[1, 2] &amp;&amp; ARRAY[1]</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">array-ref</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">array-ref</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ARRAY[1, 2][1]</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">array-slice</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">array-slice</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">array</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ARRAY[1, 2][1:3]</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">bitwise-not</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bitwise-not%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">bitwise-not</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">~ 1</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">bitwise-and</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bitwise-and%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">bitwise-and</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">1 &amp; 2</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">bitwise-or</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym">bitwise-or</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">1 | 2</span></p></td></tr></table></td></tr><tr><td style="border-bottom: 1px solid black;"><p><span class="stt">bitwise-xor</span></p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">usage:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bitwise-xor%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">bitwise-xor</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span></p></td></tr><tr><td><p><span style="font-weight: bold">output:</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">1 # 2</span></p></td></tr></table></td></tr></table></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._query~3f))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">query?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">q</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> when <span class="RktVar">q</span> is a query.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._delete))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%29%29" class="RktValDef RktValLink" data-pltdoc="x">delete</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">q</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Converts <span class="RktVar">q</span> into a <span class="stt">DELETE</span> query, preserving its
<span class="stt">FROM</span> and <span class="stt">WHERE</span> clauses.</div></p><p>An error is raised if <span class="RktVar">q</span> is anything other than a
<span class="stt">SELECT</span> query.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(query "DELETE FROM users AS u")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._from))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">from</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">table-name</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVar">alias</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVar">schema-id</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVar">alias</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">subquery</span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVar">alias</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><blockquote class="SubFlow"><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">table-name</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span></td></tr></table><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">query</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Creates a new <span class="stt">SELECT</span> <span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span> from a schema or a table name.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">user</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">id</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="RktValLink" data-pltdoc="x">id/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:primary-key</span><span class="hspace">&nbsp;</span><span class="RktPn">#:auto-increment</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">username</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(query "SELECT * FROM users AS u")</span></p></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">user</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(query "SELECT u.id, u.username FROM users AS u")</span></p></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">subquery</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktSym">user</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">out</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count</span><span class="hspace">&nbsp;</span><span class="RktSym">out.*</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(query</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">"SELECT COUNT(out.*) FROM (SELECT u.id, u.username FROM users AS u) AS out")</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._group-by))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._group-by%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">group-by</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Adds a <span class="stt">ORDER BY</span> clause to <span class="RktVar">query</span>.  If <span class="RktVar">query</span>
already has one, then the new columns are appended to the existing
clause.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"books"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.year-published</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252A%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._group-by%29%29" class="RktStxLink" data-pltdoc="x">group-by</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.year-published</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(query</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">"SELECT b.year_published, COUNT(*) FROM books AS b GROUP BY b.year_published")</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._join))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">join</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-type</span><span class="hspace">&nbsp;</span><span class="RktVar">table-name</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVar">alias</span><span class="hspace">&nbsp;</span><span class="RktPn">#:on</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-type</span><span class="hspace">&nbsp;</span><span class="RktVar">schema-id</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVar">alias</span><span class="hspace">&nbsp;</span><span class="RktPn">#:on</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-type</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">subquery</span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktVar">alias</span><span class="hspace">&nbsp;</span><span class="RktPn">#:on</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-type</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:inner</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:left</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:right</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:full</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:cross</span></td></tr></table></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><blockquote class="SubFlow"><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">table-name</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span></td></tr></table><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">query</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Adds a <span class="stt">JOIN</span> to <span class="RktVar">query</span>.  If a join type is not provided,
then the join defaults to an <span class="stt">INNER</span> join.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"posts"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"post_images"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">pi</span><span class="hspace">&nbsp;</span><span class="RktPn">#:on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p.id</span><span class="hspace">&nbsp;</span><span class="RktSym">pi.post-id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:left</span><span class="hspace">&nbsp;</span><span class="RktVal">"comments"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktPn">#:on</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p.id</span><span class="hspace">&nbsp;</span><span class="RktSym">c.post-id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p.*</span><span class="hspace">&nbsp;</span><span class="RktSym">c.*</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(query</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">"SELECT p.*, c.* FROM posts AS p JOIN post_images AS pi ON p.id = pi.post_id LEFT JOIN comments AS c ON p.id = c.post_id")</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._limit))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._limit%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">limit</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">n</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._limit%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">limit</a></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">e</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Adds or replaces a <span class="stt">LIMIT </span><span class="RktVar">n</span> clause to <span class="RktVar">query</span>.</div></p><p>The first form raises a syntax error if <span class="RktVar">n</span> is not an exact
positive integer or 0.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._offset%29%29" class="RktStxLink" data-pltdoc="x">offset</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._limit%29%29" class="RktStxLink" data-pltdoc="x">limit</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(query "SELECT * FROM users AS u LIMIT 10 OFFSET 20")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._offset))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._offset%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">offset</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">n</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._offset%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">offset</a></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktVar">e</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Adds or replaces an <span class="stt">OFFSET </span><span class="RktVar">n</span> clause to <span class="RktVar">query</span>.</div></p><p>The first form raises a syntax error if <span class="RktVar">n</span> is not an exact
positive integer or 0.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._offset%29%29" class="RktStxLink" data-pltdoc="x">offset</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(query "SELECT * FROM users AS u OFFSET 10")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._order-by))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">order-by</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVar">column</span><span class="hspace">&nbsp;</span><span class="RktVar">maybe-direction</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-direction</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:asc</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:desc</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Adds an <span class="stt">ORDER BY</span> clause to <span class="RktVar">query</span>.  If <span class="RktVar">query</span>
already has one, then the new columns are appended to the existing
clause.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">u.last-login</span><span class="hspace">&nbsp;</span><span class="RktPn">#:desc</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">u.username</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(query "SELECT * FROM users AS u ORDER BY u.last_login DESC, u.username")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/query..rkt)._project-onto))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._project-onto%29%29" class="RktValDef RktValLink" data-pltdoc="x">project-onto</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span><span class="RktVar">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">q</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._schema~3f%29%29" class="RktValLink" data-pltdoc="x">schema?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Changes the target schema for <span class="RktVar">q</span> to <span class="RktVar">s</span>.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book-stats</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">#:virtual</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">year-published</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._integer%2Ff%29%29" class="RktValLink" data-pltdoc="x">integer/f</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">books</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._integer%2Ff%29%29" class="RktValLink" data-pltdoc="x">integer/f</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"books"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.year-published</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%252A%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">*</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._group-by%29%29" class="RktStxLink" data-pltdoc="x">group-by</a></span><span class="hspace">&nbsp;</span><span class="RktSym">b.year-published</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">b.year-published</span><span class="hspace">&nbsp;</span><span class="RktPn">#:desc</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._project-onto%29%29" class="RktValLink" data-pltdoc="x">project-onto</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book-stats-schema</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(query</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">"SELECT b.year_published, COUNT(*) FROM books AS b GROUP BY b.year_published ORDER BY b.year_published DESC")</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._returning))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._returning%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">returning</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Adds a <span class="stt">RETURNING</span> clause to <span class="RktVar">query</span>.  If <span class="RktVar">query</span>
already has one, then the new columns are appended to the existing
clause.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u.active?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._returning%29%29" class="RktStxLink" data-pltdoc="x">returning</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u.id</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(query "DELETE FROM users AS u WHERE NOT u.is_active RETURNING u.id")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._select))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">select</a></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">query</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._query~3f%29%29" class="RktValLink" data-pltdoc="x">query?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Refines the set of selected values in <span class="RktVar">query</span>.  This operation
removes the schema, if any, from the input query so you&rsquo;ll have to
use <span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._project-onto%29%29" class="RktValLink" data-pltdoc="x">project-onto</a></span> to project the results onto an entity,
otherwise the resulting query will return a sequence of
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=values.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._values%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">values</a></span>.</div></p><p>The first form (with the <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">_</a></span>) generates a fresh query.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529.__%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(query "SELECT 1, 2")</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._select%29%29" class="RktStxLink" data-pltdoc="x">select</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">u.username</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(query "SELECT u.username FROM users AS u")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._update))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._update%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">update</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">assignment</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">assignment</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">column</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">]</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Converts <span class="RktVar">query</span> into an <span class="stt">UPDATE</span> query, preserving its
<span class="stt">FROM</span> clause, making it the target table for the update, and its
<span class="stt">WHERE</span> clause.</div></p><p>An error is raised if <span class="RktSym">q</span> is anything other than a
<span class="stt">SELECT</span> query.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._update%29%29" class="RktStxLink" data-pltdoc="x">update</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">active?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(query "UPDATE users AS u SET is_active = TRUE")</span></p></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._where))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">where</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Wraps the <span class="stt">WHERE</span> clause in <span class="RktVar">query</span> to the result of
<span class="stt">AND</span>-ing it with <span class="RktVar">q-expr</span>.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u.active?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3e%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u.last-login</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._-%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=clock.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._now%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">now</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interval</span><span class="hspace">&nbsp;</span><span class="RktVal">"2 weeks"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(query</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">"SELECT * FROM users AS u WHERE u.is_active AND (u.last_login &gt; ((NOW()) - (INTERVAL '2 weeks')))")</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/query..rkt)._or-where))"></a><span title="Provided from: deta/query | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._or-where%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">or-where</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">query</span><span class="hspace">&nbsp;</span><span class="RktVar">q-expr</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Wraps the <span class="stt">WHERE</span> clause in <span class="RktVar">query</span> to the result of
<span class="stt">OR</span>-ing it with <span class="RktVar">q-expr</span>.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=threading&amp;rel=index.html%23%2528form._%2528%2528lib._threading%252Fmain..rkt%2529._%7E7e%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%29%29" class="RktValLink" data-pltdoc="x">delete</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._from%29%29" class="RktStxLink" data-pltdoc="x">from</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"users"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:as</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._not%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u.active?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._or-where%29%29" class="RktStxLink" data-pltdoc="x">or-where</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3c%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u.last-login</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._-%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=clock.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._now%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">now</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interval</span><span class="hspace">&nbsp;</span><span class="RktVal">"1 year"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">(query</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes">"DELETE FROM users AS u WHERE (NOT u.is_active) OR (u.last_login &lt; ((NOW()) - (INTERVAL '1 year')))")</span></p></td></tr></table></td></tr></table></blockquote><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Schema&quot;">5.2<tt>&nbsp;</tt><a name="(part._.Schema)"></a><a name="(mod-path._deta/schema)"></a>Schema</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._deta%2Fschema%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">deta/schema</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/deta-lib" title="Install this package using `raco pkg install deta-lib`"><span class="stt">deta-lib</span></a></span></td></tr></table></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/schema..rkt)._entity~3f))"></a><span title="Provided from: deta/schema | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">entity?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">e</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">e</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> when <span class="RktVar">e</span> is an instance of a schema
struct (i.e. an "entity").</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/schema..rkt)._schema~3f))"></a><span title="Provided from: deta/schema | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._schema~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">schema?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> when <span class="RktVar">s</span> is a schema.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._deta/schema..rkt)._define-schema))"></a><span title="Provided from: deta/schema | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">define-schema</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">id</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">maybe-table</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">maybe-virtual</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktVar">field-definition</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">maybe-pre-persist-hook</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">maybe-pre-delete-hook</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">maybe-table</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:table</span><span class="hspace">&nbsp;</span><span class="RktVar">table-name</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-virtual</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:virtual</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-pre-persist-hook</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:pre-persist-hook</span><span class="hspace">&nbsp;</span><span class="RktVar">pre-persist-hook</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-pre-delete-hook</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:pre-delete-hook</span><span class="hspace">&nbsp;</span><span class="RktVar">pre-delete-hook</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">field-definition</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">field-type</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-name</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-primary-key</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-auto-increment</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-unique</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-nullable</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-contract</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-wrapper</span><span class="RktPn">]</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktVar">default</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">field-type</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-name</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-primary-key</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-auto-increment</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-unique</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-nullable</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-contract</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktVar">maybe-wrapper</span><span class="RktPn">]</span></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-name</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:name</span><span class="hspace">&nbsp;</span><span class="RktVar">field-name</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-primary-key</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:primary-key</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-auto-increment</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:auto-increment</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-unique</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:unique</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-nullable</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:nullable</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-contract</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:contract</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">maybe-wrapper</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td></td></tr></table></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:wrapper</span><span class="hspace">&nbsp;</span><span class="RktVar">e</span></td></tr></table></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><blockquote class="SubFlow"><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">table-name</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span></td></tr></table><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">field-name</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span></td></tr></table><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">field-type</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></td></tr></table><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">pre-persist-hook</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></td></tr></table><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">pre-delete-hook</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fschema..rkt%29._entity~3f%29%29" class="RktValLink" data-pltdoc="x">entity?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Defines a schema named <span class="RktVar">id</span>.  The schema will have an
associated struct with the same name and a smart constructor called
<span class="stt">make-</span><span style="font-style: italic">id</span>.  The struct&rsquo;s "dumb" constructor is hidden so
that invalid entities cannot be created.</div></p><p>For every defined field there will be an associated functional
setter and updater named <span class="stt">set-</span><span style="font-style: italic">id</span><span class="stt">-</span><span style="font-style: italic">field</span> and
<span class="stt">update-</span><span style="font-style: italic">id</span><span class="stt">-</span><span style="font-style: italic">field</span>, respectively.</p><p>If a <span class="RktVar">table-name</span> is provided, then that is used as the name
for the table.  Otherwise, an "s" is appended to the schema id to
pluralize it.  Currently, there are no other pluralization rules.</p><p>If <span class="RktPn">#:virtual</span> is provided, then the resulting schema&rsquo;s
entities will not be able to be persisted, nor will the schema be
registered in the global registry.</p><p>The <span class="RktVar">pre-persist-hook</span> is run before an entity is either
<span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._insert%21%29%29" class="RktValLink" data-pltdoc="x">insert!</a></span>ed or <span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._update%21%29%29" class="RktValLink" data-pltdoc="x">update!</a></span>d.</p><p>The <span class="RktVar">pre-delete-hook</span> is run before an entity is
<span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._delete%21%29%29" class="RktValLink" data-pltdoc="x">delete!</a></span>d.</p><p>Hooks <span style="font-style: italic">do not</span> run for arbitrary queries.</p><p>A syntax error is raised if you declare a field as both a primary
key and nullable.  Additionally, a syntax error is raised if a
schema has multiple primary keys.</p><p>Every type has an associated contract so the <span class="RktPn">#:contract</span>
option for fields is only necessary if you want to further restrict
the values that a field can contain.</p><p>When converting field names to SQL, dashes are replaced with
underscores and field names that end in question marks drop their
question mark and are prefixed with "is_".  <span class="RktSym">admin?</span> becomes
<span class="RktSym">is_admin</span>.</p><p>Custom field names can be specified by providing a <span class="RktPn">#:name</span>
in the field definition.  Note, however, that the library does not
currently translate between field names and custom column names
within arbitrary queries.</p><p>Example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">book</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktVar">id</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="RktValLink" data-pltdoc="x">id/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:primary-key</span><span class="hspace">&nbsp;</span><span class="RktPn">#:auto-increment</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">title</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:unique</span><span class="hspace">&nbsp;</span><span class="RktPn">#:contract</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:wrapper</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-titlecase%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string-titlecase</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">author</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:contract</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528lib._racket%252Fstring..rkt%2529._non-empty-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">non-empty-string?</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._deta/schema..rkt)._schema-out))"></a><span title="Provided from: deta/schema | Package: deta-lib"><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._schema-out%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">schema-out</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">schema</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Exports all bindings related to <span class="RktVar">schema</span>.</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._module%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">module</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sub</span><span class="hspace">&nbsp;</span><span class="RktSym">racket/base</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">deta</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._schema-out%29%29" class="RktStxLink" data-pltdoc="x">schema-out</a></span><span class="hspace">&nbsp;</span><span class="RktSym">album</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fschema..rkt%29._define-schema%29%29" class="RktStxLink" data-pltdoc="x">define-schema</a></span><span class="hspace">&nbsp;</span><span class="RktSym">album</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:virtual</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">id</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="RktValLink" data-pltdoc="x">id/f</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:primary-key</span><span class="hspace">&nbsp;</span><span class="RktPn">#:auto-increment</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">title</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">band</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">sub</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">an-album</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-album</span><span class="hspace">&nbsp;</span><span class="RktPn">#:title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Led Zeppelin"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:band</span><span class="hspace">&nbsp;</span><span class="RktVal">"Led Zeppelin"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">album?</span><span class="hspace">&nbsp;</span><span class="RktSym">an-album</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#t</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">album-title</span><span class="hspace">&nbsp;</span><span class="RktSym">an-album</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"Led Zeppelin"</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">album-title</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">update-album-title</span><span class="hspace">&nbsp;</span><span class="RktSym">an-album</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-upcase%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string-upcase</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">"LED ZEPPELIN"</span></p></td></tr></table></blockquote><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Type&quot;">5.3<tt>&nbsp;</tt><a name="(part._.Type)"></a><a name="(mod-path._deta/type)"></a>Type</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._deta%2Ftype%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">deta/type</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/deta-lib" title="Install this package using `raco pkg install deta-lib`"><span class="stt">deta-lib</span></a></span></td></tr></table></p><p>These are all the field types currently supported by deta.  Note that
not all database backends support all of these types.</p><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Support_Matrix&quot;">5.3.1<tt>&nbsp;</tt><a name="(part._.Support_.Matrix)"></a>Support Matrix</h5><p>Here are all the types and how they map to the different backends.</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span style="font-weight: bold">Field Type</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">Racket Type</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">PostgreSQL Type</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span style="font-weight: bold">SQLite Type</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="RktValLink" data-pltdoc="x">id/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">INTEGER / SERIAL</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">INTEGER</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._integer%2Ff%29%29" class="RktValLink" data-pltdoc="x">integer/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-integer?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">INTEGER</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">INTEGER</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._real%2Ff%29%29" class="RktValLink" data-pltdoc="x">real/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._real%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">real?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">REAL</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">REAL</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._numeric%2Ff%29%29" class="RktValLink" data-pltdoc="x">numeric/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._rational%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">rational?</a></span><span class="stt"> </span><span class="RktVal">+nan.0</span><span class="RktPn">)</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">NUMERIC</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">UNSUPPORTED</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValLink" data-pltdoc="x">string/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._binary%2Ff%29%29" class="RktValLink" data-pltdoc="x">binary/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=bytestrings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._bytes%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">bytes?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">BLOB</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">BLOB</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._symbol%2Ff%29%29" class="RktValLink" data-pltdoc="x">symbol/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._boolean%2Ff%29%29" class="RktValLink" data-pltdoc="x">boolean/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">BOOLEAN</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">INTEGER</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._date%2Ff%29%29" class="RktValLink" data-pltdoc="x">date/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=date-provider.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._date-provider%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">date-provider?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">DATE</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._time%2Ff%29%29" class="RktValLink" data-pltdoc="x">time/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=time-provider.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._time-provider%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">time-provider?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TIME</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._datetime%2Ff%29%29" class="RktValLink" data-pltdoc="x">datetime/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=datetime-provider.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._datetime-provider%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">datetime-provider?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TIMESTAMP</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._datetime-tz%2Ff%29%29" class="RktValLink" data-pltdoc="x">datetime-tz/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=gregor&amp;rel=moment-provider.html%23%2528def._%2528%2528lib._gregor%252Fmain..rkt%2529._moment-provider%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">moment-provider?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TIMESTMAPTZ</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">TEXT</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._array%2Ff%29%29" class="RktValLink" data-pltdoc="x">array/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=vectors.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._vector%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">vector?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">ARRAY</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">UNSUPPORTED</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._json%2Ff%29%29" class="RktValLink" data-pltdoc="x">json/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=json&amp;rel=index.html%23%2528def._%2528%2528lib._json%252Fmain..rkt%2529._jsexpr%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">jsexpr?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">JSON</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">UNSUPPORTED</span></p></td></tr><tr><td><p><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._jsonb%2Ff%29%29" class="RktValLink" data-pltdoc="x">jsonb/f</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=json&amp;rel=index.html%23%2528def._%2528%2528lib._json%252Fmain..rkt%2529._jsexpr%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">jsexpr?</a></span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">JSONB</span></p></td><td><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td><p><span class="stt">UNSUPPORTED</span></p></td></tr></table></p><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;Types&quot;">5.3.2<tt>&nbsp;</tt><a name="(part._.Types)"></a>Types</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/type..rkt)._type~3f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">type?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._id/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._id%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">id/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._integer/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._integer%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">integer/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._real/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._real%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">real/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/type..rkt)._numeric/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._numeric%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">numeric/f</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">precision</span><span class="hspace">&nbsp;</span><span class="RktVar">scale</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">precision</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">scale</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-integer?</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._string/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._string%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">string/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._binary/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._binary%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">binary/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._symbol/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._symbol%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">symbol/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._boolean/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._boolean%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">boolean/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._date/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._date%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">date/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._time/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._time%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">time/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._datetime/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._datetime%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">datetime/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._datetime-tz/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._datetime-tz%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">datetime-tz/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._deta/type..rkt)._array/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._array%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">array/f</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._json/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._json%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">json/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._deta/type..rkt)._jsonb/f))"></a><span title="Provided from: deta/type | Package: deta-lib"><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._jsonb%2Ff%29%29" class="RktValDef RktValLink" data-pltdoc="x">jsonb/f</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._deta%2Ftype..rkt%29._type~3f%29%29" class="RktValLink" data-pltdoc="x">type?</a></span></p></blockquote></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The various types that deta supports.</div></p><h4 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;changelog&quot;">5.4<tt>&nbsp;</tt><a name="(part._changelog)"></a>Changelog</h4><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;v0_2_0_--_2019-07-20&quot;">5.4.1<tt>&nbsp;</tt><a name="(part._v0_2_0_--_2019-07-20)"></a><span class="stt">v0.2.0</span> &ndash; 2019-07-20</h5><p><div class="SIntrapara"><span style="font-weight: bold">Added:</span>
</div><div class="SIntrapara"><ul><li><p>Support for <span class="RktSym">subquery</span></p></li></ul></div></p><p><div class="SIntrapara"><span style="font-weight: bold">Changed:</span>
</div><div class="SIntrapara"><ul><li><p>Dropped <span class="RktPn">#:with</span> keyword from <span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span></p></li></ul></div></p><h5 x-source-module="(lib &quot;deta/deta.scrbl&quot;)" x-source-pkg="deta-doc" x-part-tag="&quot;v0_1_0_--_2019-07-19&quot;">5.4.2<tt>&nbsp;</tt><a name="(part._v0_1_0_--_2019-07-19)"></a><span class="stt">v0.1.0</span> &ndash; 2019-07-19</h5><p><div class="SIntrapara"><span style="font-weight: bold">Added:</span>
</div><div class="SIntrapara"><ul><li><p>Support for <span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._join%29%29" class="RktStxLink" data-pltdoc="x">join</a></span>s</p></li></ul></div></p><p><div class="SIntrapara"><span style="font-weight: bold">Changed:</span>
</div><div class="SIntrapara"><ul><li><p><span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._order-by%29%29" class="RktStxLink" data-pltdoc="x">order-by</a></span>, <span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._group-by%29%29" class="RktStxLink" data-pltdoc="x">group-by</a></span> and <span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._returning%29%29" class="RktStxLink" data-pltdoc="x">returning</a></span> were
changed to always append themselves to existing clauses, if any</p></li><li><p><span class="RktSym">and-where</span> was renamed to <span class="RktSym"><a href="#%28form._%28%28lib._deta%2Fquery..rkt%29._where%29%29" class="RktStxLink" data-pltdoc="x">where</a></span></p></li></ul></div></p><p><div class="SIntrapara"><span style="font-weight: bold">Fixed:</span>
</div><div class="SIntrapara"><ul><li><p>Loosened the return contract on <span class="RktSym"><a href="#%28def._%28%28lib._deta%2Fquery..rkt%29._lookup%29%29" class="RktValLink" data-pltdoc="x">lookup</a></span> to <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">any</a></span></p></li></ul></div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>