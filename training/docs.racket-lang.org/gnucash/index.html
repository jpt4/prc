<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Gnucash</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Gnucash</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.How_to_.Use_.It_%29" class="tocviewlink" data-pltdoc="x">How to Use It:</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.How_to_.Use_.It__part_.I.I__%29" class="tocviewlink" data-pltdoc="x">How to Use It (part II):</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Example_rkt%29" class="tocviewlink" data-pltdoc="x">Example.rkt</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">Gnucash</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.How_to_.Use_.It_%29" class="tocsubseclink" data-pltdoc="x">How to Use It:</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.How_to_.Use_.It__part_.I.I__%29" class="tocsubseclink" data-pltdoc="x">How to Use It (part II):</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Parsing%29" class="tocsubseclink" data-pltdoc="x">Parsing</a></td></tr><tr><td><a href="#%28def._%28%28lib._gnucash%2Fmain..rkt%29._gnucash-read%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gnucash-<wbr></wbr>read</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.A_.Note_.On_.Representations%29" class="tocsubseclink" data-pltdoc="x">A Note On Representations</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Libs_rkt%29" class="tocsubseclink" data-pltdoc="x">Libs.rkt</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Example_rkt%29" class="tocsubseclink" data-pltdoc="x">Example.rkt</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.Gnucash)"></a><a name="(mod-path._gnucash)"></a>Gnucash</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">John Clements &lt;<a href="mailto:clements@racket-lang.org">clements@racket-lang.org</a>&gt;</p></span></div><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">gnucash</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/gnucash" title="Install this package using `raco pkg install gnucash`"><span class="stt">gnucash</span></a></span></td></tr></table></div><div class="SIntrapara">This collection is intended to allow you to use Racket/DrRacket to operate on
gnucash files.  It&rsquo;s flimsy but effective for me. It&rsquo;s intended for Racket
hackers, and is underdocumented, under-test-cased, and under-error-checking-ed.
For heaven&rsquo;s sake don&rsquo;t try using this stuff unless you&rsquo;ve already written a
bunch of Racket code.</div><div class="SIntrapara">Olin Shivers talks about 80% solutions; I would call this a 60% solution.  Here&rsquo;s why
you&rsquo;d use it: it has example code, and it runs. Let me know if you improve it.</div></p><h3 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;How_to_Use_It_&quot;">1<tt>&nbsp;</tt><a name="(part._.How_to_.Use_.It_)"></a>How to Use It:</h3><p>The very simplest way to see how it works is to take a look at the examples
directory: it contains a simple example gnucash file, and a simple Racket file
with plenty of comments that opens the gnucash file and pulls out a few of the
transactions in the file.  If you still have questions, come back and read this
file.</p><h3 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;How_to_Use_It__part_II__&quot;">2<tt>&nbsp;</tt><a name="(part._.How_to_.Use_.It__part_.I.I__)"></a>How to Use It (part II):</h3><p>The library consists of two files.  One reads in the data (parse.rkt), and one
has some utility functions for handling it. Both of them are loaded automatically.</p><h4 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;Parsing&quot;">2.1<tt>&nbsp;</tt><a name="(part._.Parsing)"></a>Parsing</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._gnucash/main..rkt)._gnucash-read))"></a><span title="Provided from: gnucash | Package: gnucash"><span class="RktSym"><a href="#%28def._%28%28lib._gnucash%2Fmain..rkt%29._gnucash-read%29%29" class="RktValDef RktValLink" data-pltdoc="x">gnucash-read</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">gnucash-file</span><span class="hspace">&nbsp;</span><span class="RktVar">gnucash-zo-file</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sxml-thing</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">gnucash-file</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">gnucash-zo-file</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">The reader does a funny thing: since XML reading is so appallingly slow, it
makes a .zo file that contains the compiled representation of the input file.
Building this thing is horrifically slow, taking about 3 minutes to process my
3-megabyte gnucash file (actually, it&rsquo;s 19M after unzipping it).  This is all
hidden from you, except that when you call the reader you must supply the name
of a cache file.</div></p><p>If the source file is newer than the zo file, it goes and recompiles the darn
thing.</p><p>You probably won&rsquo;t need to call any other functions in parse.rkt.</p><h4 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;A_Note_On_Representations&quot;">2.2<tt>&nbsp;</tt><a name="(part._.A_.Note_.On_.Representations)"></a>A Note On Representations</h4><p>Darn near everything in this library is represented using plain-old Racket
lists, and more specifically SXML representations.  The up side of this is that
you can "display" nearly everything transparently.  The down side of this is
that you will curse and scream at a bunch of errors that would be caught by any
kind of type system or use of structures, e.g. using an account instead of an
account id, etc.</p><p>Note from 2015: Let&rsquo;s use TR! That&rsquo;s definitely a better use of my time than
grading all these exams....</p><h4 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;Libs_rkt&quot;">2.3<tt>&nbsp;</tt><a name="(part._.Libs_rkt)"></a>Libs.rkt</h4><p>Here&rsquo;s how to require it:</p><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">gnucash/libs</span><span class="RktPn">)</span></p><p>I&rsquo;m not even going to try to document a significant subset of the functions in
lib.rkt; they&rsquo;re mostly like this one:</p><p>&gt; (transaction-splits t)</p><p>Returns the splits associated with the transaction</p><p>&gt; (transaction-date t)</p><p>Returns the date associated with the transaction</p><p>Here&rsquo;s one worth mentioning:</p><p>&gt; (crossers transactions account-ids accounts)</p><p>For most kinds of graphing/reporting/munging/etc., you will want to choose a
set of accounts and look for all transactions that "cross the line", in the
sense that they transfer money from that set of accounts to something else.
More accurately, you want transactions where at least one split is inside the
set of accounts, and where at least one split is outside the set of accounts.</p><p>Why is this?  Well, imagine you have a checking account and a credit card.  You
want to take a look at what you&rsquo;re spending your money on.  You&rsquo;d like to lump
together the checking account and the credit card account and take a look at
the money coming into or out of these two accounts, while ignoring transfers
between these two.  This is what "crossers" is for.</p><p>Please do note that the "account-ids" is a list of ids (that is, strings), and
not accounts.  The example file shows this happening.</p><h3 x-source-module="(lib &quot;gnucash/scribblings/gnucash.scrbl&quot;)" x-source-pkg="gnucash" x-part-tag="&quot;Example_rkt&quot;">3<tt>&nbsp;</tt><a name="(part._.Example_rkt)"></a>Example.rkt</h3><p>For an example of how to use this, take a look at <span class="stt">"examples/examples.rkt"</span>.</p><p>Well, that&rsquo;s about all I have to say for now.  Let me know if you find it
useful or if it makes you grind your teeth.</p><p>John Clements, 2007-08 (updated repeatedly, most recently 2018-07-01)</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>