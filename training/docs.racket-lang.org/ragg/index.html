<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>ragg: a Racket AST Generator Generator</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">ragg:<span class="mywbr"> &nbsp;</span> a Racket AST Generator Generator</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Informal_quickstart%29" class="tocviewlink" data-pltdoc="x">Informal quickstart</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.The_language%29" class="tocviewlink" data-pltdoc="x">The language</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.Support_.A.P.I%29" class="tocviewlink" data-pltdoc="x">Support API</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.Caveats_and_things_to_do%29" class="tocviewlink" data-pltdoc="x">Caveats and things to do</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._.Miscellaneous_and_thanks%29" class="tocviewlink" data-pltdoc="x">Miscellaneous and thanks</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">ragg:<span class="mywbr"> &nbsp;</span> a Racket AST Generator Generator</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Informal_quickstart%29" class="tocsubseclink" data-pltdoc="x">Informal quickstart</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._install-ragg%29" class="tocsubseclink" data-pltdoc="x">Installation</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Example__a_small_.D.S.L_for_.A.S.C.I.I_diagrams%29" class="tocsubseclink" data-pltdoc="x">Example:<span class="mywbr"> &nbsp;</span> a small DSL for ASCII diagrams</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Syntax_and_semantics%29" class="tocsubseclink" data-pltdoc="x">Syntax and semantics</a></td></tr><tr><td><span class="tocsublinknumber">2.4<tt>&nbsp;</tt></span><a href="#%28part._.Parsing_the_concrete_syntax%29" class="tocsubseclink" data-pltdoc="x">Parsing the concrete syntax</a></td></tr><tr><td><span class="tocsublinknumber">2.5<tt>&nbsp;</tt></span><a href="#%28part._.From_parsing_to_interpretation%29" class="tocsubseclink" data-pltdoc="x">From parsing to interpretation</a></td></tr><tr><td><span class="tocsublinknumber">2.6<tt>&nbsp;</tt></span><a href="#%28part._.From_interpretation_to_compilation%29" class="tocsubseclink" data-pltdoc="x">From interpretation to compilation</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.The_language%29" class="tocsubseclink" data-pltdoc="x">The language</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._ragg-syntax%29" class="tocsubseclink" data-pltdoc="x">Syntax and terminology</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.Syntax_errors%29" class="tocsubseclink" data-pltdoc="x">Syntax errors</a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._.Semantics%29" class="tocsubseclink" data-pltdoc="x">Semantics</a></td></tr><tr><td><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">parse</span></span></a></td></tr><tr><td><a href="#%28form._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._make-rule-parser%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">make-<wbr></wbr>rule-<wbr></wbr>parser</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._all-token-types%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">all-<wbr></wbr>token-<wbr></wbr>types</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Support_.A.P.I%29" class="tocsubseclink" data-pltdoc="x">Support API</a></td></tr><tr><td><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">token</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token-struct%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">token-<wbr></wbr>struct</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._exn~3afail~3aparsing%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>parsing</span></span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Caveats_and_things_to_do%29" class="tocsubseclink" data-pltdoc="x">Caveats and things to do</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Miscellaneous_and_thanks%29" class="tocsubseclink" data-pltdoc="x">Miscellaneous and thanks</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._ragg__a_.Racket_.A.S.T_.Generator_.Generator)"></a>ragg: a Racket AST Generator Generator</h2><p>Danny Yoo &lt;<a href="mailto:dyoo@hashcollision.org">dyoo@hashcollision.org</a>&gt;</p><h3 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Informal_quickstart&quot;">1<tt>&nbsp;</tt><a name="(part._.Informal_quickstart)"></a>Informal quickstart</h3><p><div class="SIntrapara">Salutations!  Let&rsquo;s consider the following scenario: say that we&rsquo;re given the
following string:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktVal">"(radiant (humble))"</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>(... and pretend that we don&rsquo;t already know about the built-in
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">read</a></span> function.)</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">  How do we go about turning this kind of string into a
structured value?  That is, how would we <span style="font-style: italic">parse</span> it?</div></p><p>We need to first consider the shape of the things we&rsquo;d like to parse.  The
string above looks like a deeply nested list of words.  How might we describe
this formally?  A convenient notation to describe the shape of these things is
<a href="https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_Form">Backus-Naur
Form</a> (BNF).  So let&rsquo;s try to notate the structure of nested word lists in BNF.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">nested-word-list: WORD</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| LEFT-PAREN nested-word-list* RIGHT-PAREN</span></p></td></tr></table></blockquote><p>What we intend by this notation is this: <span class="RktSym">nested-word-list</span> is either an
atomic <span class="RktSym">WORD</span>, or a parenthesized list of any number of
<span class="RktSym">nested-word-list</span>s.  We use the character <span class="RktInBG"><span class="hspace"></span><span class="RktIn">*</span><span class="hspace"></span></span> to represent zero
or more repetitions of the previous thing, and we treat the uppercased
<span class="RktSym">LEFT-PAREN</span>, <span class="RktSym">RIGHT-PAREN</span>, and <span class="RktSym">WORD</span> as placeholders
for atomic <span style="font-style: italic">tokens</span>.</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>See <a href="#%28part._install-ragg%29" data-pltdoc="x">Installation</a> for instructions on installing
<span class="stt">ragg.</span></p></blockquote></blockquote></blockquote></div><div class="SIntrapara">Here are a few examples of tokens:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ragg/support</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(token-struct 'LEFT-PAREN #f #f #f #f #f #f)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktVal">"crunchy"</span><span class="hspace">&nbsp;</span><span class="RktPn">#:span</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(token-struct 'WORD "crunchy" #f #f #f 7 #f)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(token-struct 'RIGHT-PAREN #f #f #f #f #f #f)</span></p></td></tr></table></blockquote></div></p><p>Have we made progress?  At this point, we only have a BNF description in hand,
but we&rsquo;re still missing a <span style="font-style: italic">parser</span>, something to take that description and
use it to make structures out of a sequence of tokens.</p><p>It&rsquo;s clear that we don&rsquo;t yet have a program because there&rsquo;s no <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span>
line.  We should add one.  Put <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> at the top of the BNF
description, and save it as a file called <span class="stt">"nested-word-list.rkt"</span>.</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"nested-word-list.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">nested-word-list: WORD</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| LEFT-PAREN nested-word-list* RIGHT-PAREN</span></p></td></tr></table></blockquote></blockquote><p>Now it is a proper program.  But what does it do?</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"nested-word-list.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span></td></tr><tr><td><p><span class="RktRes">#&lt;procedure:parse&gt;</span></p></td></tr></table></blockquote><p>It gives us a <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> function.  Let&rsquo;s investigate what <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span>
does for us.  What happens if we pass it a sequence of tokens?</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-parsed-value</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">"("</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktVal">"some"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">"["</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktVal">"pig"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">"]"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktVal">")"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">a-parsed-value</span></td></tr><tr><td><p><span class="RktRes">#&lt;syntax (nested-word-list "(" (nested-word-list "some") (nested-word-list "[" (nested-word-list "pig") "]") ")")&gt;</span></p></td></tr></table></blockquote><p><div class="SIntrapara">Wait... that looks suspiciously like a syntax object!
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-parsed-value</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">'(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "some")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "[" (nested-word-list "pig") "]")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>That&rsquo;s <span class="RktPn">(</span><span class="RktSym">some</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">pig</span><span class="RktPn">]</span><span class="RktPn">)</span>, essentially.</p><p><div class="SIntrapara">What happens if we pass it a more substantial source of tokens?
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">tokenize: string -&gt; (sequenceof token-struct?)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Generate tokens from a string:</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%252Flist%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for/list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=regexp.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._regexp-match%252A%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">regexp-match*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#px"\\(|\\)|\\w+"</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=match.html%23%2528form._%2528%2528lib._racket%252Fmatch..rkt%2529._match%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"("</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">LEFT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">")"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">RIGHT-PAREN</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WORD</span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">For example:</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">token-source</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktVal">"(welcome (to (((ragg)) ())))"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">token-source</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">'(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "welcome")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "to")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">"("</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "(" (nested-word-list "ragg") ")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(nested-word-list "(" ")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">")")</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>Welcome to <span class="stt">ragg</span>.</p><h3 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Introduction&quot;">2<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p><div class="SIntrapara"><span class="stt">ragg</span> is a parsing framework for Racket with the design goal to be easy
to use.  It includes the following features:
</div><div class="SIntrapara"><ul><li><p>It provides a <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span> for writing extended BNF grammars.
A module written in <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> automatically generates a
parser.  The output of this parser tries to follow
<a href="https://en.wikipedia.org/wiki/How_to_Design_Programs">HTDP</a>
doctrine; the structure of the grammar informs the structure of the
Racket syntax objects it generates.</p></li><li><p>The language uses a few conventions to simplify the expression of
grammars.  The first rule in the grammar is automatically assumed to be the
starting production.  Identifiers in uppercase are assumed to represent
terminal tokens, and are otherwise the names of nonterminals.</p></li><li><p>Tokenizers can be developed completely independently of parsers.
<span class="stt">ragg</span> takes a liberal view on tokens: they can be strings,
symbols, or instances constructed with <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span>.  Furthermore,
tokens can optionally provide location: if tokens provide location, the
generated syntax objects will as well.</p></li><li><p>The underlying parser should be able to handle ambiguous grammars.</p></li><li><p>It should integrate with the rest of the Racket
<a href="https://docs.racket-lang.org/guide/languages.html">language toolchain</a>.</p></li></ul></div></p><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;install-ragg&quot;">2.1<tt>&nbsp;</tt><a name="(part._install-ragg)"></a>Installation</h4><ul><li><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>At the time of this writing, Racket 5.3.2 is in
<a href="https://pre.racket-lang.org/">pre-release</a>.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara"> If you are using a version
of Racket &gt; 5.3.1, then follow the instructions on the
<a href="https://plt-etc.byu.edu:9004/info/ragg">PLaneT2 page</a>.</div></p></li><li><p>For those who are using Racket &lt;= 5.3.1, you can download the following PLT package:</p><blockquote><p><a href="ragg.plt">ragg.plt</a> [md5sum: ab79038b40e510a5cf13363825c4aef4]</p><p>Last updated: Wednesday, January 16th, 2013</p></blockquote><p><div class="SIntrapara">Once downloaded, either use DrRacket&rsquo;s package installation features
(<a href="https://docs.racket-lang.org/drracket/Menus.html#(idx._(gentag._57._(lib._scribblings/drracket/drracket..scrbl)))">Install
PLT File...</a> under DrRacket&rsquo;s File menu), or use the command line:
</div><div class="SIntrapara"><blockquote><p><span class="stt">raco setup -A ragg.plt</span></p></blockquote></div></p></li></ul><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Example__a_small_DSL_for_ASCII_diagrams&quot;">2.2<tt>&nbsp;</tt><a name="(part._.Example__a_small_.D.S.L_for_.A.S.C.I.I_diagrams)"></a>Example: a small DSL for ASCII diagrams</h4><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>This is a
<a href="https://stackoverflow.com/questions/12345647/rewrite-this-script-by-designing-an-interpreter-in-racket">restatement
of a question on Stack Overflow</a>.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">  To motivate <span class="stt">ragg</span>&rsquo;s design, let&rsquo;s look
at the following toy problem: we&rsquo;d like to define a language for
drawing simple ASCII diagrams.  We&rsquo;d like to be able write something like this:</div></p><blockquote><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">3 9 X;</span></p></td></tr><tr><td><p><span class="stt">6 3 b 3 X 3 b;</span></p></td></tr><tr><td><p><span class="stt">3 9 X;</span></p></td></tr></table></blockquote><p>whose interpretation should generate the following picture:</p><blockquote><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="stt">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="stt">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">XXX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">XXX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">XXX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">XXX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">XXX</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">XXX</span></p></td></tr><tr><td><p><span class="stt">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="stt">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="stt">XXXXXXXXX</span></p></td></tr></table></blockquote><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Syntax_and_semantics&quot;">2.3<tt>&nbsp;</tt><a name="(part._.Syntax_and_semantics)"></a>Syntax and semantics</h4><p>We&rsquo;re being very fast-and-loose with what we mean by the program above, so
let&rsquo;s try to nail down some meanings.  Each line of the program has a semicolon
at the end, and describes the output of several <span style="font-style: italic">rows</span> of the line
drawing.  Let&rsquo;s look at two of the lines in the example:</p><ul><li><p><span class="RktInBG"><span class="hspace"></span><span class="RktIn">3 9 X;</span><span class="hspace"></span></span>: &ldquo;Repeat the following 3 times: print <span class="RktVal">"X"</span> nine times, followed by
a newline.&rdquo;</p></li><li><p><span class="RktInBG"><span class="hspace"></span><span class="RktIn">6 3 b 3 X 3 b;</span><span class="hspace"></span></span>: &ldquo;Repeat the following 6 times: print <span class="RktVal">" "</span> three times,
followed by <span class="RktVal">"X"</span> three times, followed by <span class="RktVal">" "</span> three times, followed by a newline.&rdquo;</p></li></ul><p>Then each line consists of a <span style="font-style: italic">repeat</span> number, followed by pairs of
(number, character) <span style="font-style: italic">chunks</span>.  We will
assume here that the intent of the lowercased character <span class="RktInBG"><span class="hspace"></span><span class="RktIn">b</span><span class="hspace"></span></span> is to
represent the printing of a 1-character whitespace <span class="RktVal">" "</span>, and for other
uppercase letters to represent the printing of themselves.</p><p>Once we have a better idea of the pieces of each line, we have a better chance
to capture that meaning in a formal notation.  Once we have each instruction in
a structured format, we should be able to interpret it with a straighforward
case analysis.</p><p>Here is a first pass at expressing the structure of these line-drawing
programs.</p><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Parsing_the_concrete_syntax&quot;">2.4<tt>&nbsp;</tt><a name="(part._.Parsing_the_concrete_syntax)"></a>Parsing the concrete syntax</h4><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"simple-line-drawing.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">drawing: rows*</span></p></td></tr><tr><td><p><span class="stt">rows: repeat chunk+ ";"</span></p></td></tr><tr><td><p><span class="stt">repeat: INTEGER</span></p></td></tr><tr><td><p><span class="stt">chunk: INTEGER STRING</span></p></td></tr></table></blockquote></blockquote><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p><a href="#%28part._ragg-syntax%29" data-pltdoc="x">Syntax and terminology</a> describes <span class="stt">ragg</span>&rsquo;s syntax in more detail.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">We write a <span class="stt">ragg</span> program as an extended BNF grammar, where patterns can be:
</div><div class="SIntrapara"><ul><li><p>the names of other rules (e.g. <span class="RktSym">chunk</span>)</p></li><li><p>literal and symbolic token names (e.g. <span class="RktVal">";"</span>, <span class="RktSym">INTEGER</span>)</p></li><li><p>quantified patterns (e.g. <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+</span><span class="hspace"></span></span> to represent one-or-more repetitions)</p></li></ul></div><div class="SIntrapara">The result of a <span class="stt">ragg</span> program is a module with a <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> function
that can parse tokens and produce a syntax object as a result.</div></p><p><div class="SIntrapara">Let&rsquo;s exercise this function:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ragg/support</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"simple-line-drawing.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INTEGER</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INTEGER</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">STRING</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INTEGER</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">STRING</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">";"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(drawing (rows (repeat 6) (chunk 2 " ") (chunk 3 "X") ";"))</span></p></td></tr></table></blockquote></div></p><p>Tokens can either be: plain strings, symbols, or instances produced by the
<span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span> function.  (Plus a few more special cases, one in which we&rsquo;ll describe in a
moment.)</p><p>Preferably, we want to attach each token with auxiliary source location
information.  The more source location we can provide, the better, as the
syntax objects produced by <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> will incorporate them.</p><p>Let&rsquo;s write a helper function, a <span style="font-style: italic">lexer</span>, to help us construct tokens more
easily.  The Racket standard library comes with a module called
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=parser-tools&amp;rel=Lexers.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">parser-tools/lex</span></a> which can help us write a position-sensitive
tokenizer:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">parser-tools/lex</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktSym">ip</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=linecol.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._port-count-lines%2521%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">port-count-lines!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ip</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-lexer</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=parser-tools&amp;rel=Lexers.html%23%2528form._%2528%2528lib._parser-tools%252Flex..rkt%2529._lexer-src-pos%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">lexer-src-pos</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">repetition</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">+inf.0</span><span class="hspace">&nbsp;</span><span class="RktSym">numeric</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INTEGER</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string-%7E3enumber%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">lexeme</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">upper-case</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">STRING</span><span class="hspace">&nbsp;</span><span class="RktSym">lexeme</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">"b"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">STRING</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">";"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">";"</span><span class="hspace">&nbsp;</span><span class="RktSym">lexeme</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">whitespace</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">WHITESPACE</span><span class="hspace">&nbsp;</span><span class="RktSym">lexeme</span><span class="hspace">&nbsp;</span><span class="RktPn">#:skip?</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">eof</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next-token</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">my-lexer</span><span class="hspace">&nbsp;</span><span class="RktSym">ip</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">next-token</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-sample-input-port</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stringport.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._open-input-string%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">open-input-string</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"6 2 b 3 X;"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">token-thunk</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktSym">a-sample-input-port</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Now we can pass token-thunk to the parser:</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">token-thunk</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-stx</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(drawing (rows (repeat 6) (chunk 2 " ") (chunk 3 "X") ";"))</span></p></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">The syntax object has location information:</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-line%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-line</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-stx</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">1</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-column%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-column</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-stx</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">0</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-span%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-span</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-stx</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">10</span></p></td></tr></table></blockquote><p><div class="SIntrapara">There are a few things to note from this lexer example:
</div><div class="SIntrapara"><ul><li><p>The <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> function can consume either sequences of tokens, or a
function that produces tokens.  Both of these are considered sources of
tokens.</p></li><li><p>As a special case for acceptable tokens, a token can also be an instance
of the <span class="RktSym">position-token</span> structure of <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=parser-tools&amp;rel=Lexers.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">parser-tools/lex</span></a>,
in which case the token will try to derive its position from that of the
position-token.</p></li><li><p>The <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> function will stop reading from a token source if any
token is <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span>.</p></li><li><p>The <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> function will skip over any token with the
<span class="RktPn">#:skip?</span>  attribute. Elements such as whitespace and comments will
often have <span class="RktPn">#:skip?</span> set to <span class="RktVal">#t</span>.</p></li></ul></div></p><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;From_parsing_to_interpretation&quot;">2.5<tt>&nbsp;</tt><a name="(part._.From_parsing_to_interpretation)"></a>From parsing to interpretation</h4><p><div class="SIntrapara">We now have a parser for programs written in this simple-line-drawing language.
Our parser will give us back syntax objects:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">parsed-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stringport.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._open-input-string%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">open-input-string</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"3 9 X; 6 3 b 3 X 3 b; 3 9 X;"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktSym">parsed-program</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktRes">'(drawing</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(rows (repeat 3) (chunk 9 "X") ";")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(rows (repeat 6) (chunk 3 " ") (chunk 3 "X") (chunk 3 " ") ";")</span></p></td></tr><tr><td><p><span class="RktRes"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">(rows (repeat 3) (chunk 9 "X") ";"))</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>Moreover, we know that these syntax objects have a regular, predictable
structure.  Their structure follows the grammar, so we know we&rsquo;ll be looking at
values of the form:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">drawing</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rows</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">repeat</span><span class="hspace">&nbsp;</span><span class="RktSym">&lt;number&gt;</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">chunk</span><span class="hspace">&nbsp;</span><span class="RktSym">&lt;number&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">&lt;string&gt;</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">";"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>where <span class="RktSym">drawing</span>, <span class="RktSym">rows</span>, <span class="RktSym">repeat</span>, and <span class="RktSym">chunk</span>
should be treated literally, and everything else will be numbers or strings.</p><p>Still, these syntax object values are just inert structures.  How do we
interpret them, and make them <span style="font-style: italic">print</span>?  We did claim at the beginning of
this section that these syntax objects should be fairly easy to case-analyze
and interpret, so let&rsquo;s do it.</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>This is a very quick-and-dirty treatment of <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span>.
See the <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">syntax/parse</span></a> documentation for a gentler guide to its
features.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">  Racket provides a special form called <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span> in the
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">syntax/parse</span></a> library.  <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span> lets us do a
structural case-analysis on syntax objects: we provide it a set of patterns to
parse and actions to perform when those patterns match.</div></p><p>As a simple example, we can write a function that looks at a syntax object and
says <span class="RktVal">#t</span> if it&rsquo;s the literal <span class="RktSym">yes</span>, and <span class="RktVal">#f</span> otherwise:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">syntax/parse</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">yes-syntax-object?: syntax-object -&gt; boolean</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Returns true if the syntax-object is yes.</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">yes-syntax-object?</span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">yes</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">yes-syntax-object?</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">yes</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#t</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">yes-syntax-object?</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">nooooooooooo</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">#f</span></p></td></tr></table></blockquote><p><div class="SIntrapara">Here, we use <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span> to let <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span> know that
<span class="RktSym">yes</span> should show up literally in the syntax object.  The patterns can
also have some structure to them, such as:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">drawing</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">rows-stxs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">which matches on syntax objects that begin, literally, with <span class="RktSym">drawing</span>,
followed by any number of rows (which are syntax objects too).</div></p><p><div class="SIntrapara">Now that we know a little bit more about <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span>,
we can use it to do a case analysis on the syntax
objects that our <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> function gives us.
We start by defining a function on syntax objects of the form <span class="RktPn">(</span><span class="RktSym">drawing</span><span class="stt"> </span><span class="RktSym">rows-stx</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span>.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interpret-drawing</span><span class="hspace">&nbsp;</span><span class="RktSym">drawing-stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">drawing-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">drawing</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">rows-stxs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">rows-stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">rows-stxs</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interpret-rows</span><span class="hspace">&nbsp;</span><span class="RktSym">rows-stx</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p>When we encounter a syntax object with <span class="RktPn">(</span><span class="RktSym">drawing</span><span class="stt"> </span><span class="RktSym">rows-stx</span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span>, then <span class="RktSym">interpret-rows</span> each <span class="RktSym">rows-stx</span>.</p><p><div class="SIntrapara">Let&rsquo;s define <span class="RktSym">interpret-rows</span> now:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interpret-rows</span><span class="hspace">&nbsp;</span><span class="RktSym">rows-stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rows-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rows</span><span class="RktPn">}</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">repeat</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">repeat-number</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">chunks</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">";"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-e%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-e</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">repeat-number</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">chunk-stx</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3elist%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;list</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">chunks</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interpret-chunk</span><span class="hspace">&nbsp;</span><span class="RktSym">chunk-stx</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._newline%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div></p><p>For a <span class="RktSym">rows</span>, we extract out the <span class="RktSym">repeat-number</span> out of the
syntax object and use it as the range of the <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span> loop.  The inner loop
walks across each <span class="RktSym">chunk-stx</span> and calls <span class="RktSym">interpret-chunk</span> on it.</p><p>Finally, we need to write a definition for <span class="RktSym">interpret-chunk</span>.  We want
it to extract out the <span class="RktSym">chunk-size</span> and <span class="RktSym">chunk-string</span> portions,
and print to standard output:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">interpret-chunk</span><span class="hspace">&nbsp;</span><span class="RktSym">chunk-stx</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">chunk-stx</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="hspace">&nbsp;</span><span class="RktSym">chunk</span><span class="RktPn">}</span><span class="hspace">&nbsp;</span><span class="RktSym">chunk-size</span><span class="hspace">&nbsp;</span><span class="RktSym">chunk-string</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-e%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-e</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">chunk-size</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._display%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">display</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-e%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-e</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">chunk-string</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Here are the definitions in a single file:
<a href="examples/simple-line-drawing/interpret.rkt">interpret.rkt</a>.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">With these definitions in hand, now we can pass it syntax objects
that we construct directly by hand:</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">interpret-chunk</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">chunk</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktOut">XXX</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">interpret-drawing</span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">drawing</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">rows</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">repeat</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">chunk</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">";"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">XXX</span></p></td></tr><tr><td><p><span class="RktOut">XXX</span></p></td></tr><tr><td><p><span class="RktOut">XXX</span></p></td></tr><tr><td><p><span class="RktOut">XXX</span></p></td></tr><tr><td><p><span class="RktOut">XXX</span></p></td></tr></table></td></tr></table></blockquote><p><div class="SIntrapara">or we can pass it the result generated by our parser:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">parsed-program</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stringport.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._open-input-string%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">open-input-string</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"3 9 X; 6 3 b 3 X 3 b; 3 9 X;"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">interpret-drawing</span><span class="hspace">&nbsp;</span><span class="RktSym">parsed-program</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="RktOut">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="RktOut">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">XXX </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">XXX </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">XXX </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">XXX </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">XXX </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span></p></td></tr><tr><td><p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut">XXX </span><span class="hspace">&nbsp;&nbsp;</span><span class="RktOut"></span></p></td></tr><tr><td><p><span class="RktOut">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="RktOut">XXXXXXXXX</span></p></td></tr><tr><td><p><span class="RktOut">XXXXXXXXX</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>And now we&rsquo;ve got an interpreter!</p><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;From_interpretation_to_compilation&quot;">2.6<tt>&nbsp;</tt><a name="(part._.From_interpretation_to_compilation)"></a>From interpretation to compilation</h4><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>For a gentler tutorial on writing <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span> extensions, see:
<a href="http://hashcollision.org/brainfudge">F*dging up a Racket</a>.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">  (Just as a
warning: the following material is slightly more advanced, but shows how
writing a compiler for the line-drawing language reuses the ideas for the
interpreter.)</div></p><p>Wouldn&rsquo;t it be nice to be able to write something like:</p><blockquote><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">3 9 X;</span></p></td></tr><tr><td><p><span class="stt">6 3 b 3 X 3 b;</span></p></td></tr><tr><td><p><span class="stt">3 9 X;</span></p></td></tr></table></blockquote><p><div class="SIntrapara">and have Racket automatically compile this down to something like this?
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._newline%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._newline%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"X"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._newline%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Well, of course it won&rsquo;t work: we don&rsquo;t have a <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span> line.</p><p>Let&rsquo;s add one.</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"letter-i.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg/examples/simple-line-drawing</span></p></td></tr><tr><td><p><span class="stt">3 9 X;</span></p></td></tr><tr><td><p><span class="stt">6 3 b 3 X 3 b;</span></p></td></tr><tr><td><p><span class="stt">3 9 X;</span></p></td></tr></table></blockquote></blockquote><p>Now <span class="stt">"letter-i.rkt"</span> is a program.</p><p>How does this work?  From the previous sections, we&rsquo;ve seen how to take the
contents of a file and interpret it.  What we want to do now is teach Racket
how to compile programs labeled with this <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang</span><span class="hspace"></span></span> line.  We&rsquo;ll do two
things:</p><ul><li><p>Tell Racket to use the <span class="stt">ragg</span>-generated parser and lexer we defined
earlier whenever it sees a program written with
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg/examples/simple-line-drawing</span><span class="hspace"></span></span>.</p></li><li><p>Define transformation rules for <span class="RktSym">drawing</span>, <span class="RktSym">rows</span>, and
<span class="RktSym">chunk</span> to rewrite these into standard Racket forms.</p></li></ul><p>The second part, the writing of the transformation rules, will look very
similar to the definitions we wrote for the interpreter, but the transformation
will happen at compile-time.  (We <span style="font-style: italic">could</span> just resort to simply calling
into the interpreter we just wrote up, but this section is meant to show that
compilation is also viable.)</p><p>We do the first part by defining a <span style="font-style: italic">module reader</span>: a
<a href="https://docs.racket-lang.org/guide/syntax_module-reader.html">module
reader</a> tells Racket how to parse and compile a file.  Whenever Racket sees a
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang &lt;name&gt;</span><span class="hspace"></span></span>, it looks for a corresponding module reader in
<span class="stt">"&lt;name&gt;/lang/reader"</span>.</p><p>Here&rsquo;s the definition for
<span class="stt">"ragg/examples/simple-line-drawing/lang/reader.rkt"</span>:</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"ragg/examples/simple-line-drawing/lang/reader.rkt"</span></span></p><blockquote class="Rfilecontent"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=reader.html%23%2528mod-path._s-exp%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">s-exp</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta">syntax/module-reader</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktSym">ragg/examples/simple-line-drawing/semantics</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">#:read</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">my-read</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">#:read-syntax</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">my-read-syntax</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">#:whole-body-readers?</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">#t</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ragg/examples/simple-line-drawing/lexer</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ragg/examples/simple-line-drawing/grammar</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">my-read</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">in</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">my-read-syntax</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">#f</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">in</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">my-read-syntax</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">src</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ip</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">src</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">tokenize</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">ip</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote><p>We use a helper module <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=reader-helpers.html%23%2528mod-path._syntax%252Fmodule-reader%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">syntax/module-reader</span></a>, which provides
utilities for creating a module reader.  It uses the lexer and
<span class="stt">ragg</span>-generated parser we defined earlier (saved into
<a href="http://hashcollision.org/ragg/examples/simple-line-drawing/lexer.rkt">lexer.rkt</a>
and
<a href="http://hashcollision.org/ragg/examples/simple-line-drawing/grammar.rkt">grammar.rkt</a>
modules), and also tells Racket that it should compile the forms in the syntax
object using a module called <span class="stt">"semantics.rkt"</span>.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>For a systematic treatment on capturing the semantics of
a language, see <a href="http://cs.brown.edu/~sk/Publications/Books/ProgLangs/">Programming Languages: Application and
Interpretation</a>.</p></blockquote></blockquote></blockquote><p><div class="SIntrapara">Let&rsquo;s look into <span class="stt">"semantics.rkt"</span> and see what&rsquo;s involved in
compilation:
</div><div class="SIntrapara"><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"ragg/examples/simple-line-drawing/semantics.rkt"</span></span></p><blockquote class="Rfilecontent"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">racket/base</span></a><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for-syntax</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">racket/base</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">syntax/parse</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._provide%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">provide</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=module.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7E23%7E25module-begin%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">#%module-begin</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">We</span><span class="hspace">&nbsp;</span><span class="RktCmt">reuse</span><span class="hspace">&nbsp;</span><span class="RktCmt">Racket's</span><span class="hspace">&nbsp;</span><span class="RktCmt">treatment</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">raw</span><span class="hspace">&nbsp;</span><span class="RktCmt">datums,</span><span class="hspace">&nbsp;</span><span class="RktCmt">specifically</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">for</span><span class="hspace">&nbsp;</span><span class="RktCmt">strings</span><span class="hspace">&nbsp;</span><span class="RktCmt">and</span><span class="hspace">&nbsp;</span><span class="RktCmt">numbers:</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=quote.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._%7E23%7E25datum%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">#%datum</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">And</span><span class="hspace">&nbsp;</span><span class="RktCmt">otherwise,</span><span class="hspace">&nbsp;</span><span class="RktCmt">we</span><span class="hspace">&nbsp;</span><span class="RktCmt">provide</span><span class="hspace">&nbsp;</span><span class="RktCmt">definitions</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">these</span><span class="hspace">&nbsp;</span><span class="RktCmt">three</span><span class="hspace">&nbsp;</span><span class="RktCmt">forms.</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">During</span><span class="hspace">&nbsp;</span><span class="RktCmt">compiliation,</span><span class="hspace">&nbsp;</span><span class="RktCmt">Racket</span><span class="hspace">&nbsp;</span><span class="RktCmt">uses</span><span class="hspace">&nbsp;</span><span class="RktCmt">these</span><span class="hspace">&nbsp;</span><span class="RktCmt">definitions</span><span class="hspace">&nbsp;</span><span class="RktCmt">to</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">rewrite</span><span class="hspace">&nbsp;</span><span class="RktCmt">into</span><span class="hspace">&nbsp;</span><span class="RktCmt">for</span><span class="hspace">&nbsp;</span><span class="RktCmt">loops,</span><span class="hspace">&nbsp;</span><span class="RktCmt">displays,</span><span class="hspace">&nbsp;</span><span class="RktCmt">and</span><span class="hspace">&nbsp;</span><span class="RktCmt">newlines.</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">drawing</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Define</span><span class="hspace">&nbsp;</span><span class="RktCmt">a</span><span class="hspace">&nbsp;</span><span class="RktCmt">few</span><span class="hspace">&nbsp;</span><span class="RktCmt">compile-time</span><span class="hspace">&nbsp;</span><span class="RktCmt">functions</span><span class="hspace">&nbsp;</span><span class="RktCmt">to</span><span class="hspace">&nbsp;</span><span class="RktCmt">do</span><span class="hspace">&nbsp;</span><span class="RktCmt">the</span><span class="hspace">&nbsp;</span><span class="RktCmt">syntax</span><span class="hspace">&nbsp;</span><span class="RktCmt">rewriting:</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin-for-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">begin-for-syntax</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">compile-drawing</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">drawing-stx</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">drawing-stx</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">drawing</span><span class="RktPn">}</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows-stxs</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%252Floc%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax/loc</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">drawing-stx</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=begin.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._begin%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">begin</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows-stxs</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">compile-rows</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows-stx</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows-stx</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows</span><span class="RktPn">}</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">repeat</span><span class="RktPn">}</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">repeat-number</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunks</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktVal">";"</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%252Floc%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax/loc</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows-stx</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">repeat-number</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunks</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Byte_and_String_Output.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._newline%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">newline</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">compile-chunk</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-stx</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=Parsing_Syntax.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._syntax-parse%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax-parse</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-stx</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktPn">{</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=syntax&amp;rel=stxparse-patterns.html%23%2528form._%2528%2528lib._syntax%252Fparse..rkt%2529._%7E7eliteral%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">~literal</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk</span><span class="RktPn">}</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-size</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-string</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._syntax%252Floc%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">syntax/loc</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-stx</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-size</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._display%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">display</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk-string</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">Wire</span><span class="hspace">&nbsp;</span><span class="RktCmt">up</span><span class="hspace">&nbsp;</span><span class="RktCmt">the</span><span class="hspace">&nbsp;</span><span class="RktCmt">use</span><span class="hspace">&nbsp;</span><span class="RktCmt">of</span><span class="hspace">&nbsp;</span><span class="RktCmt">"drawing",</span><span class="hspace">&nbsp;</span><span class="RktCmt">"rows",</span><span class="hspace">&nbsp;</span><span class="RktCmt">and</span><span class="hspace">&nbsp;</span><span class="RktCmt">"chunk"</span><span class="hspace">&nbsp;</span><span class="RktCmt">to</span><span class="hspace">&nbsp;</span><span class="RktCmt">these</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">transformers:</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">drawing</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">compile-drawing</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">rows</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">compile-rows</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">chunk</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">compile-chunk</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote></div></p><p>The semantics hold definitions for <span class="RktSym">compile-drawing</span>,
<span class="RktSym">compile-rows</span>, and <span class="RktSym">compile-chunk</span>, similar to what we had for
interpretation with <span class="RktSym">interpret-drawing</span>, <span class="RktSym">interpret-rows</span>, and
<span class="RktSym">interpret-chunk</span>.  However, compilation is not the same as
interpretation: each definition does not immediately execute the act of
drawing, but rather returns a syntax object whose evaluation will do the actual
work.</p><p>There are a few things to note:</p><ul><li><p><span class="stt">ragg</span>&rsquo;s native data structure is the syntax object because the
majority of Racket&rsquo;s language-processing infrastructure knows how to read and
write this structured value.</p></li><li><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>By the way, we can just as easily rewrite the semantics so that
<span class="RktSym">compile-rows</span> does explicitly call <span class="RktSym">compile-chunk</span>.  Often,
though, it&rsquo;s easier to write the transformation functions in this piecemeal way
and depend on the Racket macro expansion system to do the rewriting as it
encounters each of the forms.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">Unlike in interpretation, <span class="RktSym">compile-rows</span> doesn&rsquo;t
compile each chunk by directly calling <span class="RktSym">compile-chunk</span>.  Rather, it
depends on the Racket macro expander to call each <span class="RktSym">compile-XXX</span> function
as it encounters a <span class="RktSym">drawing</span>, <span class="RktSym">rows</span>, or <span class="RktSym">chunk</span> in the
parsed value.  The three statements at the bottom of <span class="stt">"semantics.rkt"</span> inform
the macro expansion system to do this:</div></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">drawing</span><span class="hspace">&nbsp;</span><span class="RktSym">compile-drawing</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rows</span><span class="hspace">&nbsp;</span><span class="RktSym">compile-rows</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define-syntax%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define-syntax</a></span><span class="hspace">&nbsp;</span><span class="RktSym">chunk</span><span class="hspace">&nbsp;</span><span class="RktSym">compile-chunk</span><span class="RktPn">)</span></td></tr></table></blockquote></li></ul><p>Altogether, <span class="stt">ragg</span>&rsquo;s intent is to be a parser generator generator for Racket
that&rsquo;s easy and fun to use.  It&rsquo;s meant to fit naturally with the other tools
in the Racket language toolchain.  Hopefully, it will reduce the friction in
making new languages with alternative concrete syntaxes.</p><p>The rest of this document describes the <span class="stt">ragg</span> language and the parsers it
generates.</p><h3 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;The_language&quot;">3<tt>&nbsp;</tt><a name="(part._.The_language)"></a>The language</h3><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;ragg-syntax&quot;">3.1<tt>&nbsp;</tt><a name="(part._ragg-syntax)"></a>Syntax and terminology</h4><p>A program in the <span class="stt">ragg</span> language consists of the language line
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span>, followed by a collection of <a href="#%28tech._rule%29" class="techoutside" data-pltdoc="x"><span class="techinside">rule</span></a>s and
<a href="#%28tech._line._comment%29" class="techoutside" data-pltdoc="x"><span class="techinside">line comment</span></a>s.</p><p>A <a name="(tech._rule)"></a><span style="font-style: italic">rule</span> is a sequence consisting of: a <a href="#%28tech._rule._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">rule identifier</span></a>, a colon
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">":"</span><span class="hspace"></span></span>, and a <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a>.</p><p>A <a name="(tech._rule._identifier)"></a><span style="font-style: italic">rule identifier</span> is an <a href="#%28tech._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">identifier</span></a> that is not in upper case.</p><p>A <a name="(tech._token._identifier)"></a><span style="font-style: italic">token identifier</span> is an <a href="#%28tech._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">identifier</span></a> that is in upper case.</p><p>An <a name="(tech._identifier)"></a><span style="font-style: italic">identifier</span> is a character sequence of letters, numbers, and
characters in <span class="RktVal">"-.!$%&amp;/&lt;=&gt;?^_~@"</span>.  It must not contain
<span class="RktInBG"><span class="hspace"></span><span class="RktIn">*</span><span class="hspace"></span></span> or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+</span><span class="hspace"></span></span>, as those characters are used to denote
quantification.</p><p><div class="SIntrapara">A <a name="(tech._pattern)"></a><span style="font-style: italic">pattern</span> is one of the following:
</div><div class="SIntrapara"><ul><li><p>an implicit sequence of <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a>s separated by whitespace</p></li><li><p>a terminal: either a literal string or a <a href="#%28tech._token._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">token identifier</span></a></p></li><li><p>a <a href="#%28tech._rule._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">rule identifier</span></a></p></li><li><p>a <a name="(tech._choice._pattern)"></a><span style="font-style: italic">choice pattern</span>: a sequence of <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a>s delimited with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">|</span><span class="hspace"></span></span> characters.</p></li><li><p>a <a name="(tech._quantifed._pattern)"></a><span style="font-style: italic">quantifed pattern</span>: a <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a> followed by either <span class="RktInBG"><span class="hspace"></span><span class="RktIn">*</span><span class="hspace"></span></span> (&ldquo;zero or more&rdquo;) or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">+</span><span class="hspace"></span></span> (&ldquo;one or more&rdquo;)</p></li><li><p>an <a name="(tech._optional._pattern)"></a><span style="font-style: italic">optional pattern</span>: a <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a> surrounded by <span class="RktInBG"><span class="hspace"></span><span class="RktIn">[</span><span class="hspace"></span></span> and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">]</span><span class="hspace"></span></span></p></li><li><p>an explicit sequence: a <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a> surrounded by <span class="RktInBG"><span class="hspace"></span><span class="RktIn">(</span><span class="hspace"></span></span> and <span class="RktInBG"><span class="hspace"></span><span class="RktIn">)</span><span class="hspace"></span></span></p></li></ul></div></p><p>A <a name="(tech._line._comment)"></a><span style="font-style: italic">line comment</span> begins with either <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#</span><span class="hspace"></span></span> or <span class="RktInBG"><span class="hspace"></span><span class="RktIn">;</span><span class="hspace"></span></span> and
continues till the end of the line.</p><p><div class="SIntrapara">For example, in the following program:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">;; A parser for a silly language</span></p></td></tr><tr><td><p><span class="stt">sentence: verb optional-adjective object</span></p></td></tr><tr><td><p><span class="stt">verb: greeting</span></p></td></tr><tr><td><p><span class="stt">optional-adjective: ["happy" | "frumpy"]</span></p></td></tr><tr><td><p><span class="stt">greeting: "hello" | "hola" | "aloha"</span></p></td></tr><tr><td><p><span class="stt">object: "world" | WORLD</span></p></td></tr></table></blockquote></div></p><p>the elements <span class="stt">sentence</span>, <span class="stt">verb</span>, <span class="stt">greeting</span>, and <span class="stt">object</span> are rule
identifiers.  The first rule, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">sentence: verb optional-adjective object</span><span class="hspace"></span></span>, is a rule whose right side is an implicit pattern sequence of three
sub-patterns.  The uppercased <span class="stt">WORLD</span> is a token identifier.  The fourth rule in the program associates <span class="stt">greeting</span> with a <a href="#%28tech._choice._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">choice pattern</span></a>.</p><p><div class="SIntrapara">More examples:
</div><div class="SIntrapara"><ul><li><p><div class="SIntrapara">A
<a href="http://hashcollision.org/ragg/examples/01-equal.rkt">BNF</a> for binary
strings that contain an equal number of zeros and ones.
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">equal: [zero one | one zero]</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">;; equal number of "0"s and "1"s.</span></p></td></tr><tr><td><p><span class="stt">zero: "0" equal | equal "0"</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">;; has an extra "0" in it.</span></p></td></tr><tr><td><p><span class="stt">one: "1" equal | equal "1"</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">;; has an extra "1" in it.</span></p></td></tr></table></div></p></li><li><p><div class="SIntrapara">A <a href="http://hashcollision.org/ragg/examples/baby-json.rkt">BNF</a> for
<a href="https://www.json.org/">JSON</a>-like structures.
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">json: number | string</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">| array</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">| object</span></p></td></tr><tr><td><p><span class="stt">number: NUMBER</span></p></td></tr><tr><td><p><span class="stt">string: STRING</span></p></td></tr><tr><td><p><span class="stt">array: "[" [json ("," json)*] "]"</span></p></td></tr><tr><td><p><span class="stt">object: "{" [kvpair ("," kvpair)*] "}"</span></p></td></tr><tr><td><p><span class="stt">kvpair: ID ":" json</span></p></td></tr></table></div></p></li></ul></div></p><p>The <a href="https://github.com/jbclements/ragg">ragg github source repository</a>
includes
<a href="https://github.com/jbclements/ragg/tree/master/ragg/examples">several more
examples</a>.</p><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Syntax_errors&quot;">3.2<tt>&nbsp;</tt><a name="(part._.Syntax_errors)"></a>Syntax errors</h4><p>Besides the basic syntax errors that can occur with a malformed grammar, there
are a few other classes of situations that <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> will consider
as syntax errors.</p><p><div class="SIntrapara"><span class="stt">ragg</span> will raise a syntax error if the grammar:
</div><div class="SIntrapara"><ul><li><p>doesn&rsquo;t have any rules.</p></li><li><p>has a rule with the same left hand side as any other rule.</p></li><li><p><div class="SIntrapara">refers to rules that have not been defined.  e.g. the
following program:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">foo: [bar]</span></p></td></tr></table></blockquote></div><div class="SIntrapara">should raise an error because <span class="stt">bar</span> has not been defined, even though
<span class="stt">foo</span> refers to it in an <a href="#%28tech._optional._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">optional pattern</span></a>.</div></p></li><li><p>uses the token name <span class="RktSym">EOF</span>; the end-of-file token type is reserved
for internal use by <span class="stt">ragg</span>.</p></li><li><p><div class="SIntrapara">contains a rule that has no finite derivation.  e.g. the following
program:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">infinite-a: "a" infinite-a</span></p></td></tr></table></blockquote></div><div class="SIntrapara">should raise an error because no finite sequence of tokens will satisfy
<span class="stt">infinite-a</span>.</div></p></li></ul></div></p><p>Otherwise, <span class="stt">ragg</span> should be fairly tolerant and permit even ambiguous
grammars.</p><h4 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Semantics&quot;">3.3<tt>&nbsp;</tt><a name="(part._.Semantics)"></a>Semantics</h4><p>A program written in <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> produces a module that provides a few
bindings.  The most important of these is <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span>:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._ragg/examples/nested-word-list..rkt)._parse))"></a><span title="Provided from: ragg/examples/nested-word-list | Package: ragg"><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValDef RktValLink" data-pltdoc="x">parse</a></span></span><span class="hspace">&nbsp;</span>[<span class="RktVar">source</span>]<span class="hspace">&nbsp;</span><span class="RktVar">token-source</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">source</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">token-source</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sequenceof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Parses the sequence of <a href="#%28tech._token%29" class="techoutside" data-pltdoc="x"><span class="techinside">tokens</span></a> according to the rules in the grammar, using the
first rule as the start production.  The parse must completely consume
<span class="RktVar">token-source</span>.</div></p><p>The <a name="(tech._token._source)"></a><span style="font-style: italic">token source</span> can either be a sequence, or a 0-arity function that
produces <a href="#%28tech._token%29" class="techoutside" data-pltdoc="x"><span class="techinside">tokens</span></a>.</p><p><div class="SIntrapara">A <a name="(tech._token)"></a><span style="font-style: italic">token</span> in <span class="stt">ragg</span> can be any of the following values:
</div><div class="SIntrapara"><ul><li><p>a string</p></li><li><p>a symbol</p></li><li><p>an instance produced by <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span></p></li><li><p>an instance produced by the token constructors of <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=parser-tools&amp;rel=Lexers.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">parser-tools/lex</span></a></p></li><li><p>an instance of <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=parser-tools&amp;rel=Lexers.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">parser-tools/lex</span></a>&rsquo;s <span class="RktSym">position-token</span> whose
<span class="RktSym">position-token-token</span> is a <a href="#%28tech._token%29" class="techoutside" data-pltdoc="x"><span class="techinside">token</span></a>.</p></li></ul></div></p><p>A token whose type is either <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span> or <span class="RktVal">'</span><span class="RktVal">EOF</span> terminates the
source.</p><p>If <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> succeeds, it will return a structured syntax object.  The
structure of the syntax object follows the overall structure of the rules in
the BNF.  For each rule <span class="RktSym">r</span> and its associated pattern <span class="RktSym">p</span>,
<span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> generates a syntax object <span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">r</span><span class="stt"> </span><span class="RktSym">p-value</span><span class="RktPn">)</span> where
<span class="RktSym">p-value</span>&rsquo;s structure follows a case analysis on <span class="RktSym">p</span>:</p><ul><li><p>For implicit and explicit sequences of <a href="#%28tech._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">pattern</span></a>s <span class="RktSym">p1</span>,
<span class="RktSym">p2</span>, ..., the corresponding values, spliced into the
structure.</p></li><li><p>For terminals, the value associated to the token.</p></li><li><p>For <a href="#%28tech._rule._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">rule identifier</span></a>s: the associated parse value for the rule.</p></li><li><p>For <a href="#%28tech._choice._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">choice pattern</span></a>s: the associated parse value for one of the matching subpatterns.</p></li><li><p>For <a href="#%28tech._quantifed._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">quantifed pattern</span></a>s and <a href="#%28tech._optional._pattern%29" class="techoutside" data-pltdoc="x"><span class="techinside">optional pattern</span></a>s: the corresponding values, spliced into the structure.</p></li></ul><p>Consequently, it&rsquo;s only the presence of <a href="#%28tech._rule._identifier%29" class="techoutside" data-pltdoc="x"><span class="techinside">rule identifier</span></a>s in a rule&rsquo;s
pattern that informs the parser to introduces nested structure into the syntax
object.</p><p>If the grammar has ambiguity, <span class="stt">ragg</span> will choose and return a parse, though
it does not guarantee which one it chooses.</p><p>If the parse cannot be performed successfully, or if a token in the
<span class="RktVar">token-source</span> uses a type that isn&rsquo;t mentioned in the grammar, then
<span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span> raises an instance of <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._exn~3afail~3aparsing%29%29" class="RktValLink" data-pltdoc="x">exn:fail:parsing</a></span>.</p><p>It&rsquo;s often convenient to extract a parser for other non-terminal rules in the
grammar, and not just for the first rule.  A <span class="stt">ragg</span>-generated module also
provides a form called <span class="RktSym"><a href="#%28form._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._make-rule-parser%29%29" class="RktStxLink" data-pltdoc="x">make-rule-parser</a></span> to extract a parser for the
other non-terminals:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._ragg/examples/nested-word-list..rkt)._make-rule-parser))"></a><span title="Provided from: ragg/examples/nested-word-list | Package: ragg"><span class="RktSym"><a href="#%28form._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._make-rule-parser%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">make-rule-parser</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Constructs a parser for the <span class="RktVar">name</span> of one of the non-terminals
in the grammar.</div></p><p><div class="SIntrapara">For example, given the <span class="stt">ragg</span> program
<span class="stt">"simple-arithmetic-grammar.rkt"</span>:
</div><div class="SIntrapara"><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"simple-arithmetic-grammar.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">#lang ragg</span></p></td></tr><tr><td><p><span class="stt">expr : term ('+' term)*</span></p></td></tr><tr><td><p><span class="stt">term : factor ('*' factor)*</span></p></td></tr><tr><td><p><span class="stt">factor : INT</span></p></td></tr></table></blockquote></blockquote></div><div class="SIntrapara">the following interaction shows how to extract a parser for <span class="RktSym">term</span>s.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"simple-arithmetic-grammar.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">term-parse</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._make-rule-parser%29%29" class="RktStxLink" data-pltdoc="x">make-rule-parser</a></span><span class="hspace">&nbsp;</span><span class="RktSym">term</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"*"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(expr (term (factor 3) "*" (factor 4)))</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">term-parse</span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(term (factor 3) "*" (factor 4))</span></p></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-token-sequence</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"+"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"*"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">INT</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-%7E3edatum%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._parse%29%29" class="RktValLink" data-pltdoc="x">parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">another-token-sequence</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(expr (term (factor 1)) "+" (term (factor 2) "*" (factor 3)))</span></p></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Note that term-parse will break on another-token-sequence</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">as it does not know what to do with the "+"</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">term-parse</span><span class="hspace">&nbsp;</span><span class="RktSym">another-token-sequence</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktErr">Encountered parsing error near token '+ ("+") while parsing</span></p></td></tr><tr><td><p><span class="RktErr">#f [line=#f, column=#f, offset=#f]</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Finally, the module provides a set of all the used token types in the grammar
in <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._all-token-types%29%29" class="RktValLink" data-pltdoc="x">all-token-types</a></span>:
</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._ragg/examples/nested-word-list..rkt)._all-token-types))"></a><span title="Provided from: ragg/examples/nested-word-list | Package: ragg"><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._all-token-types%29%29" class="RktValDef RktValLink" data-pltdoc="x">all-token-types</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">setof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A set of all the token types used in a grammar.</div></p><p><div class="SIntrapara">For example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"simple-arithmetic-grammar.rkt"</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._all-token-types%29%29" class="RktValLink" data-pltdoc="x">all-token-types</a></span></td></tr><tr><td><p><span class="RktRes">(set '* '+ 'INT)</span></p></td></tr></table></blockquote></div></p><h3 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Support_API&quot;">4<tt>&nbsp;</tt><a name="(part._.Support_.A.P.I)"></a><a name="(mod-path._ragg/support)"></a>Support API</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._ragg%2Fsupport%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">ragg/support</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/ragg" title="Install this package using `raco pkg install ragg`"><span class="stt">ragg</span></a></span></td></tr></table></p><p>The <a href="#%28mod-path._ragg%2Fsupport%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">ragg/support</span></a> module provides functions to interact with
<span class="stt">ragg</span> programs.  The most useful is the <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span> function, which
produces tokens to be parsed.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._ragg/support..rkt)._token))"></a><span title="Provided from: ragg/support | Package: ragg"><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValDef RktValLink" data-pltdoc="x">token</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">type</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktVar">val</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:line</span><span class="hspace">&nbsp;</span><span class="RktVar">line</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:column</span><span class="hspace">&nbsp;</span><span class="RktVar">column</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:offset</span><span class="hspace">&nbsp;</span><span class="RktVar">offset</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:span</span><span class="hspace">&nbsp;</span><span class="RktVar">span</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:skip?</span><span class="hspace">&nbsp;</span><span class="RktVar">skip?</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token-struct~3f%29%29" class="RktValLink" data-pltdoc="x">token-struct?</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">val</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">line</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._positive-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">positive-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">column</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">natural-number?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._positive-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">positive-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">span</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">natural-number?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">skip?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates instances of <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token-struct%29%29" class="RktValLink" data-pltdoc="x">token-struct</a></span>s.</div></p><p>The syntax objects produced by a parse will inject the value <span class="RktVar">val</span> in
place of the token name in the grammar.</p><p>If <span class="RktPn">#:skip?</span> is true, then the parser will skip over it during a
parse.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._ragg/support..rkt)._token-struct-skip~3f))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-span))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-column))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-line))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-offset))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-val))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct-type))"></a><a name="(def._((lib._ragg/support..rkt)._make-token-struct))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct~3f))"></a><a name="(def._((lib._ragg/support..rkt)._struct~3atoken-struct))"></a><a name="(def._((lib._ragg/support..rkt)._token-struct))"></a><span title="Provided from: ragg/support | Package: ragg"><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token-struct%29%29" class="RktValDef RktValLink" data-pltdoc="x">token-struct</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">type</span><span class="stt"> </span><span class="RktSym">val</span><span class="stt"> </span><span class="RktSym">offset</span><span class="stt"> </span><span class="RktSym">line</span><span class="stt"> </span><span class="RktSym">column</span><span class="stt"> </span><span class="RktSym">span</span><span class="stt"> </span><span class="RktSym">skip?</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-token-struct</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">val</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">offset</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._positive-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">positive-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">line</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">natural-number?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">column</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528lib._racket%252Fmath..rkt%2529._positive-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">positive-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">span</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">natural-number?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">skip?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">The token structure type.</div></p><p>Rather than directly using the <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token-struct%29%29" class="RktValLink" data-pltdoc="x">token-struct</a></span> constructor, please use
the helper function <span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._token%29%29" class="RktValLink" data-pltdoc="x">token</a></span> to construct instances.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing-srclocs))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing-continuation-marks))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing-message))"></a><a name="(def._((lib._ragg/support..rkt)._make-exn~3afail~3aparsing))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing~3f))"></a><a name="(def._((lib._ragg/support..rkt)._struct~3aexn~3afail~3aparsing))"></a><a name="(def._((lib._ragg/support..rkt)._exn~3afail~3aparsing))"></a><span title="Provided from: ragg/support | Package: ragg"><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._exn~3afail~3aparsing%29%29" class="RktValDef RktValLink" data-pltdoc="x">exn:fail:parsing</a></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exn:fail</a></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">message</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">continuation-marks</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">srclocs</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-exn:fail:parsing</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">message</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">continuation-marks</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=contmarks.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._continuation-mark-set%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">continuation-mark-set?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">srclocs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._srcloc%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">srcloc?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The exception raised when parsing fails.</div></p><p><span class="RktSym"><a href="#%28def._%28%28lib._ragg%2Fsupport..rkt%29._exn~3afail~3aparsing%29%29" class="RktValLink" data-pltdoc="x">exn:fail:parsing</a></span> implements Racket&rsquo;s <span class="RktSym">prop:exn:srcloc</span>
property, so if this exception reaches DrRacket&rsquo;s default error handler,
DrRacket should highlight the offending locations in the source.</p><h3 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Caveats_and_things_to_do&quot;">5<tt>&nbsp;</tt><a name="(part._.Caveats_and_things_to_do)"></a>Caveats and things to do</h3><p>Here are a few caveats and future aims for <span class="stt">ragg</span>.</p><ul><li><p><span class="stt">ragg</span> doesn&rsquo;t currently have a good story about operator precedence.
Future versions of <span class="stt">ragg</span> will support the specification of operator
precedence to deal with grammar ambiguity, probably by extending the BNF
grammar rules in <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#lang ragg</span><span class="hspace"></span></span> with keyword arguments.</p></li><li><p>I currently depend on the lexer framework provided by
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=parser-tools&amp;rel=Lexers.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">parser-tools/lex</span></a>, which has a steeper learning curve than I&rsquo;d
like.  A future version of <span class="stt">ragg</span> will probably try to provide a nicer set
of tools for defining lexers.</p></li><li><p>The underlying parsing engine (an Earley-style parser) has not been fully
optimized, so it may exhibit degenerate parse times.  A future version of
<span class="stt">ragg</span> will guarantee <span style="font-style: italic">O</span>(<span style="font-style: italic">n</span><span style="vertical-align: super; font-size: 80%"><span style="font-style: italic"></span>3<span style="font-style: italic"></span></span><span style="font-style: italic"></span>)<span style="font-style: italic"></span> time bounds so that at the very least,
parses will be polynomial-time.</p></li><li><p><span class="stt">ragg</span> doesn&rsquo;t yet have a good story on dealing with parser error
recovery.  If a parse fails, it tries to provide the source location, but does
little else.</p></li><li><p><span class="stt">ragg</span> is slightly misnamed: what it really builds is a concrete
syntax tree rather than an abstract syntax tree.  A future version of <span class="stt">ragg</span>
will probably support annotations on patterns so that they can be omitted or
transformed in the parser output.</p></li></ul><h3 x-source-module="(lib &quot;ragg/ragg.scrbl&quot;)" x-source-pkg="ragg" x-part-tag="&quot;Miscellaneous_and_thanks&quot;">6<tt>&nbsp;</tt><a name="(part._.Miscellaneous_and_thanks)"></a>Miscellaneous and thanks</h3><p>Thanks to Matthew Flatt for pointing me to <span class="RktSym">cfg-parser</span> from the
<span class="RktSym">cfg-parser</span> library.  Joe Politz gave me good advice and
feedback.  Also, he suggested the name &ldquo;ragg&rdquo;.  Other alternatives I&rsquo;d been
considering were &ldquo;autogrammar&rdquo; or &ldquo;chompy&rdquo;.  Thankfully, he is a better
Namer than me.  Daniel Patterson provided feedback that led to
<span class="RktSym"><a href="#%28form._%28%28lib._ragg%2Fexamples%2Fnested-word-list..rkt%29._make-rule-parser%29%29" class="RktStxLink" data-pltdoc="x">make-rule-parser</a></span>.  Robby Findler and Guillaume Marceau provided
steadfast suggestions to look into other parsing frameworks like
<a href="https://en.wikipedia.org/wiki/Syntax_Definition_Formalism">SDF</a> and
<a href="http://sablecc.org/">SableCC</a>.  Special thanks to Shriram
Krishnamurthi, who convinced me that other people might find this package
useful.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>