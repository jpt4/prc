<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Feature-Specific Profiling</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Feature-<wbr></wbr>Specific Profiling</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Quick_.Start%29" class="tocviewlink" data-pltdoc="x">Quick Start</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Using_the_.Profiler%29" class="tocviewlink" data-pltdoc="x">Using the Profiler</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Adding_.Profiling_.Support_to_.Libraries%29" class="tocviewlink" data-pltdoc="x">Adding Profiling Support to Libraries</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">Feature-<wbr></wbr>Specific Profiling</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Quick_.Start%29" class="tocsubseclink" data-pltdoc="x">Quick Start</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Using_the_.Profiler%29" class="tocsubseclink" data-pltdoc="x">Using the Profiler</a></td></tr><tr><td><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">feature-<wbr></wbr>profile</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-thunk%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">feature-<wbr></wbr>profile-<wbr></wbr>thunk</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-compile-handler%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">feature-<wbr></wbr>profile-<wbr></wbr>compile-<wbr></wbr>handler</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-features%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">default-<wbr></wbr>features</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.Default_features%29" class="tocsubseclink" data-pltdoc="x">Default features</a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._contracts-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">contracts-<wbr></wbr>feature</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._output-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">output-<wbr></wbr>feature</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._generic-sequence-dispatch-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">generic-<wbr></wbr>sequence-<wbr></wbr>dispatch-<wbr></wbr>feature</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._type-casts-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">type-<wbr></wbr>casts-<wbr></wbr>feature</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._keyword-optional-arguments-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">keyword-<wbr></wbr>optional-<wbr></wbr>arguments-<wbr></wbr>feature</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._pattern-matching-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">pattern-<wbr></wbr>matching-<wbr></wbr>feature</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Ffeatures..rkt%29._send-dispatch-feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">send-<wbr></wbr>dispatch-<wbr></wbr>feature</span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Adding_.Profiling_.Support_to_.Libraries%29" class="tocsubseclink" data-pltdoc="x">Adding Profiling Support to Libraries</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._instrumentation%29" class="tocsubseclink" data-pltdoc="x">Feature Instrumentation</a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._make-latent-mark-compile-handler%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>latent-<wbr></wbr>mark-<wbr></wbr>compile-<wbr></wbr>handler</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-syntactic-latent-mark-keys%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">default-<wbr></wbr>syntactic-<wbr></wbr>latent-<wbr></wbr>mark-<wbr></wbr>keys</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-functional-latent-marks%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">default-<wbr></wbr>functional-<wbr></wbr>latent-<wbr></wbr>marks</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._plug-ins%29" class="tocsubseclink" data-pltdoc="x">Implementing Feature Plug-<wbr></wbr>Ins</a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">feature</span></span></a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._analysis%29" class="tocsubseclink" data-pltdoc="x">Implementing Feature-<wbr></wbr>Specific Analyses</a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature-report%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">feature-<wbr></wbr>report</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._print-feature-profile%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">print-<wbr></wbr>feature-<wbr></wbr>profile</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._make-interner%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>interner</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.Feature-.Specific_.Profiling)"></a><a name="(mod-path._feature-profile)"></a>Feature-Specific Profiling</h2><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">feature-profile</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/feature-profile" title="Install this package using `raco pkg install feature-profile`"><span class="stt">feature-profile</span></a></span></td></tr></table></p><p>This package provides experimental support for profiling the costs of specific
language and library features.</p><p>Unlike Racket&rsquo;s regular profiler, which reports time spent in each function,
the feature-specific profiler reports time spent in <span style="font-style: italic">feature instances</span>:
a particular pattern matching form, a specific contract, etc.
This pinpoints which uses of expensive features are the sources of performance
issues and should be replaced by less expensive equivalents. Conversely, the
feature-specific profiler also reports which feature instances are not
problematic and should be left alone.</p><p><div class="SIntrapara">Out of the box, the profiler includes plug-ins for the following features:
</div><div class="SIntrapara"><ul><li><p>Contracts</p></li><li><p>Output</p></li><li><p>Generic sequence dispatch</p></li><li><p>Typed Racket casts and assertions</p></li><li><p>Pattern matching</p></li><li><p>Method dispatch</p></li><li><p>Optional and keyword arguments</p></li></ul></div></p><p>Libraries may supply additional plug-ins for the features they introduce.
For example, the Marketplace library includes a process accounting plug-in.</p><h3 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;Quick_Start&quot;">1<tt>&nbsp;</tt><a name="(part._.Quick_.Start)"></a>Quick Start</h3><p><a name="(idx._(gentag._0._(lib._feature-profile/scribblings/feature-profile..scrbl)))"></a>The simplest way to use this tool is to use the <span class="stt">raco feature-profile</span>
command, which takes a file name as argument, and runs the feature-specific
profiler on the <span class="RktSym">main</span> submodule of that file (if it exists), or on the
module itself (if there is no <span class="RktSym">main</span> submodule).</p><p>Alternatively, wrap the code you wish to profile with the
<span class="RktSym"><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="RktStxLink" data-pltdoc="x">feature-profile</a></span> form. Then, execute the program with the
<span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-compile-handler%29%29" class="RktValLink" data-pltdoc="x">feature-profile-compile-handler</a></span> active.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Some features, such as contracts, can be profiled without using
the compile handler. To get information about all features, the compile handler
is required.</p></blockquote></blockquote></blockquote><p><div class="SIntrapara">This can be accomplished by
running the program using </div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="stt">racket -l feature-profile -t program.rkt</span></div><div class="SIntrapara">Note that any compiled files (with extension <span class="stt">.zo</span>) should be removed before
running.</div></p><p>Here is an example feature profile:</p><blockquote class="SCodeFlow"><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"fizzbuzz.rkt"</span></span></p><blockquote class="Rfilecontent"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=index.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">racket</span></a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="RktStxLink" data-pltdoc="x">feature-profile</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">divisible</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._modulo%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">modulo</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fizzbuzz</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">range</span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._cond%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">cond</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">divisible</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">15</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"FizzBuzz\n"</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">divisible</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Buzz\n"</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">divisible</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Fizz\n"</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._else%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a\n"</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="RktStxLink" data-pltdoc="x">feature-profile</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._parameterize%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">parameterize</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-output-port%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">current-output-port</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">open-output-nowhere</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fizzbuzz</span><span class="hspace">&nbsp;</span><span class="RktVal">10000000</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></blockquote></blockquote><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">513 samples</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">Output</span></p></td></tr><tr><td><p><span class="stt">account(s) for 54.7% of total running time</span></p></td></tr><tr><td><p><span class="stt">4240 / 7752 ms</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">Cost Breakdown</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">3354 ms : fizzbuzz.rkt:13:28</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">620 ms : fizzbuzz.rkt:12:28</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">134 ms : fizzbuzz.rkt:11:28</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">132 ms : fizzbuzz.rkt:10:28</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">Generic Sequences</span></p></td></tr><tr><td><p><span class="stt">account(s) for 14.47% of total running time</span></p></td></tr><tr><td><p><span class="stt">1122 / 7752 ms</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">Cost Breakdown</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">1122 ms : fizzbuzz.rkt:7:11</span></p></td></tr></table></p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Some of the reports for contracts are produced in separate
files. See <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=contract-profile&amp;rel=index.html&amp;version=7.4" class="Sq" data-pltdoc="x">Contract Profiling</a>.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">The first part of the profile reports the time spent performing output, and
lists each call to <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">printf</a></span> separately.
The second part reports the time spent doing generic sequence dispatch.
The <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span> form on line 5 operates generically on the list returned by
<span class="RktSym">range</span>, which introduces dispatch.</div></p><h3 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;Using_the_Profiler&quot;">2<tt>&nbsp;</tt><a name="(part._.Using_the_.Profiler)"></a>Using the Profiler</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._feature-profile/main..rkt)._feature-profile))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">feature-profile</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">#:features</span><span class="hspace">&nbsp;</span><span class="RktVar">features</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">features</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Reports costs of feature instances and the overall costs of each feature to
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-output-port%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">current-output-port</a></span>.</div></p><p>For each profiled feature, reports how much time was spent in the feature
overall, then breaks down that time by feature instance.
Features are sorted in decreasing order of time, and only features for which
time was observed are displayed.</p><p>The optional <span class="RktVar">features</span> argument contains the lists of features that
should be observed by the feature profiler.
It defaults to <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-features%29%29" class="RktValLink" data-pltdoc="x">default-features</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._feature-profile/main..rkt)._feature-profile-thunk))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-thunk%29%29" class="RktValDef RktValLink" data-pltdoc="x">feature-profile-thunk</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:features</span><span class="hspace">&nbsp;</span><span class="RktVar">features</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">thunk</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">any</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">features</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">thunk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="RktStxLink" data-pltdoc="x">feature-profile</a></span>, but as a function which takes a thunk to profile
as argument.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._feature-profile/main..rkt)._feature-profile-compile-handler))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-compile-handler%29%29" class="RktValDef RktValLink" data-pltdoc="x">feature-profile-compile-handler</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">stx</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">immediate-eval?</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._compiled-expression%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">compiled-expression?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stx</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">immediate-eval?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Compiles <span class="RktVar">stx</span> for feature profiling. This adds intrumentation around
feature code, which introduces a slight overhead (less than 20%).</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/main..rkt)._default-features))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-features%29%29" class="RktValDef RktValLink" data-pltdoc="x">default-features</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The default set of features observed by the profiler.</div></p><h4 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;Default_features&quot;">2.1<tt>&nbsp;</tt><a name="(part._.Default_features)"></a><a name="(mod-path._feature-profile/features)"></a>Default features</h4><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._feature-profile%2Ffeatures%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">feature-profile/features</span></a><span class="RktPn">)</span></td></tr><tr><td align="left">&nbsp;</td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/feature-profile" title="Install this package using `raco pkg install feature-profile`"><span class="stt">feature-profile</span></a></span></td></tr></table></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._contracts-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">contracts-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._output-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">output-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._generic-sequence-dispatch-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">generic-sequence-dispatch-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._type-casts-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">type-casts-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._keyword-optional-arguments-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">keyword-optional-arguments-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._pattern-matching-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">pattern-matching-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="together"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/features..rkt)._send-dispatch-feature))"></a><span title="Provided from: feature-profile/features | Package: feature-profile"><span class="RktSym"><span class="RktSymDef RktSym">send-dispatch-feature</span></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></p></blockquote></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Individual features provided by the feature profiler.
To use all of the features, use <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-features%29%29" class="RktValLink" data-pltdoc="x">default-features</a></span>.</div></p><h3 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;Adding_Profiling_Support_to_Libraries&quot;">3<tt>&nbsp;</tt><a name="(part._.Adding_.Profiling_.Support_to_.Libraries)"></a>Adding Profiling Support to Libraries</h3><p>Not all expensive features come from the standard library; some are provided by
third-party libraries. For this reason, feature-specific profiling support for
third-party library features can be useful.</p><p>Adding feature-specific profiling for a library requires implementing a
feature-specific plug-in and adding feature marks to the library&rsquo;s
implementation (see <a href="#%28part._instrumentation%29" data-pltdoc="x">Feature Instrumentation</a>).</p><h4 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;instrumentation&quot;">3.1<tt>&nbsp;</tt><a name="(part._instrumentation)"></a>Feature Instrumentation</h4><p>Implementing feature-specific profiling support for a library requires
instrumenting its implementation. Specifically, library code must arrange to
have <span style="font-style: italic">feature marks</span> on the stack whenever feature code is running.
This is usually a non-intrusive change, and does not change program behavior.
Feature marks allow the profiler&rsquo;s sampling thread to observe when programs are
executing feature code.</p><p>Conceptually, feature marks are conditionally enabled
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=eval-model.html%23%2528tech._continuation._mark%2529&amp;version=7.4" class="Sq" data-pltdoc="x">continuation marks</a>
that map feature keys to payloads.
Feature keys can be any value, but must uniquely identify features and must be
consistent with with the feature&rsquo;s plug-in (see <a href="#%28part._plug-ins%29" data-pltdoc="x">Implementing Feature Plug-Ins</a>).</p><p>Payloads can also be any value (except <span class="RktVal">#f</span>), but they should uniquely
identify feature instances (e.g. a specific pattern matching form). The source
location of feature instances is an example of a good payload. Payloads with
additional information can be useful when implementing more sophisticated
feature-specific analyses (see <a href="#%28part._analysis%29" data-pltdoc="x">Implementing Feature-Specific Analyses</a>).</p><p>To avoid attributing time to a feature when feature code transfers control to
user code (e.g. when a feature calls a function that was provided by the user),
you can install <span style="font-style: italic">antimarks</span> which are feature marks with the
<span class="RktVal">'</span><span class="RktVal">antimark</span> symbol as payload. Antimarks are recognized specially by the
profiling library, and any sample taken while an antimark is the most recent
feature mark will not contribute time toward that feature.</p><p>Feature marks come in three flavors, each with different tradeoffs and
appropriate for different use cases.</p><ul><li><p><div class="SIntrapara"><span style="font-style: italic">Active marks</span> correspond directly to continuation marks. Feature
code can be instrumented with active marks by wrapping it in
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=wcm.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._with-continuation-mark%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">with-continuation-mark</a></span><span class="hspace">&nbsp;</span><span class="RktVar">feature-key</span><span class="hspace">&nbsp;</span><span class="RktVar">payload</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="RktPn">)</span></p></blockquote></div></p><p>Active marks are the simplest flavor of feature marks, and do not require
recompiling programs (with <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-compile-handler%29%29" class="RktValLink" data-pltdoc="x">feature-profile-compile-handler</a></span>) before
profiling. On the other hand, they impose a performance overhead even when not
profiling, and must be used with caution.</p></li><li><p><span style="font-style: italic">Syntactic latent marks</span> are
<a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528tech._syntax._property%2529&amp;version=7.4" class="Sq" data-pltdoc="x">syntax properties</a> attached to the
syntax of feature code, that are turned into actual continuation marks by
<span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-compile-handler%29%29" class="RktValLink" data-pltdoc="x">feature-profile-compile-handler</a></span> or a similar compile handler that
supports the key (see <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._make-latent-mark-compile-handler%29%29" class="RktValLink" data-pltdoc="x">make-latent-mark-compile-handler</a></span>).</p><p><div class="SIntrapara">To instrument feature code with syntactic latent marks, syntax objects
corresponding to feature code must be wrapped with
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stxprops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._syntax-property%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">syntax-property</a></span><span class="hspace">&nbsp;</span><span class="RktVar">stx</span><span class="hspace">&nbsp;</span><span class="RktVar">feature-key</span><span class="hspace">&nbsp;</span><span class="RktVar">payload</span><span class="RktPn">)</span></p></blockquote></div></p><p>If the payload is <span class="RktVal">#f</span>, the compile handler will automatically use the
syntax object&rsquo;s source location as payload.</p><p>Syntactic latent marks, unlike active marks, require recompilation but do not
impose overhead unless activated by the compile handler (which is typically
only done when profiling). Because of their reliance on syntax properties, they
are only appropriate for features implemented as syntactic extensions.</p></li><li><p><span style="font-style: italic">Functional latent marks</span> are functions that are recognized
specially and whose calls are wrapped in continuation marks by a latent mark
compile handler. Functional latent marks make it possible to instrument
features that are implemented as functions, while avoiding the overhead of
active marks when not profiling.</p><p>For more details on how to use functional latent marks, see
<span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._make-latent-mark-compile-handler%29%29" class="RktValLink" data-pltdoc="x">make-latent-mark-compile-handler</a></span>.</p><p>Compile handlers automatically use source locations as payloads for functional
latent marks.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._feature-profile/main..rkt)._make-latent-mark-compile-handler))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._make-latent-mark-compile-handler%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-latent-mark-compile-handler</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">latent-mark-keys</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">functional-latent-marks</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=eval.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._compiled-expression%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">compiled-expression?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">latent-mark-keys</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">functional-latent-marks</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">dict?</span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a compile handler similar to <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-compile-handler%29%29" class="RktValLink" data-pltdoc="x">feature-profile-compile-handler</a></span>
that supports the provided kinds of latent marks.
Compile handlers produced by <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._make-latent-mark-compile-handler%29%29" class="RktValLink" data-pltdoc="x">make-latent-mark-compile-handler</a></span> turn
latent marks with keys it recognizes into continuation marks, allowing the
corresponding features to be profiled.</div></p><p>The first argument is the list of feature keys used by the latent marks that
should be activated. It should usually be an extension of
<span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-syntactic-latent-mark-keys%29%29" class="RktValLink" data-pltdoc="x">default-syntactic-latent-mark-keys</a></span>.</p><p>The second argument is a dictionary mapping the names of functions whose calls should
be profiled to the key of the feature that the function corresponds to.
It should usually be an extension of <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-functional-latent-marks%29%29" class="RktValLink" data-pltdoc="x">default-functional-latent-marks</a></span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/main..rkt)._default-syntactic-latent-mark-keys))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-syntactic-latent-mark-keys%29%29" class="RktValDef RktValLink" data-pltdoc="x">default-syntactic-latent-mark-keys</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">The list of syntactic latent mark keys used by features supported out of the
box by the feature-specific profiler.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._feature-profile/main..rkt)._default-functional-latent-marks))"></a><span title="Provided from: feature-profile | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._default-functional-latent-marks%29%29" class="RktValDef RktValLink" data-pltdoc="x">default-functional-latent-marks</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">dict?</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Dictionary mapping feature-related functions profiled by default to the
feature keys their marks should use.</div></p><h4 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;plug-ins&quot;">3.2<tt>&nbsp;</tt><a name="(part._plug-ins)"></a><a name="(mod-path._feature-profile/plug-in-lib)"></a>Implementing Feature Plug-Ins</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._feature-profile%2Fplug-in-lib%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">feature-profile/plug-in-lib</span></a><span class="RktPn">)</span></td></tr><tr><td align="left">&nbsp;</td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/feature-profile" title="Install this package using `raco pkg install feature-profile`"><span class="stt">feature-profile</span></a></span></td></tr></table></p><p>At its core, a plug-in is a <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature%29%29" class="RktValLink" data-pltdoc="x">feature</a></span> struct.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-analysis))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-grouper))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-key))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-name))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._make-feature))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature~3f))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._struct~3afeature))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature))"></a><span title="Provided from: feature-profile/plug-in-lib | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature%29%29" class="RktValDef RktValLink" data-pltdoc="x">feature</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">key</span><span class="stt"> </span><span class="RktSym">grouper</span><span class="stt"> </span><span class="RktSym">analysis</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-feature</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">grouper</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">analysis</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">feature-profile?</span><span class="hspace">&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktSym">name</span> is a string representing the user-facing name of the feature, and
is printed in the profile.</div></p><p><span class="RktSym">key</span> is the continuation mark key used by the feature&rsquo;s feature
marks. It can be any value, but must be consistent with the key used by the
feature&rsquo;s instrumentation.</p><p><span class="RktSym">grouper</span> is a function that should be used to group mark payloads that
correspond to a single feature instance. The function takes a payload as
argument, and returns a value that identifies the payload&rsquo;s equivalence class.
That is, all payloads that should be grouped together must return the same
value. The grouping function only considers the payload of the most recent mark
for a given feature.</p><p>A value of <span class="RktVal">#f</span> will result in the plug-in using the default grouping
functions, which is usually what you want. The default function expects that the
payloads will be a vector holding the fields of a <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._srcloc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">srcloc</a></span>.</p><p><span class="RktSym">analysis</span> is a function that performs feature-specific analysis to
present profile results in a custom format. It is expected to produce its
results as a side-effect. Writing analysis functions is covered in
<a href="#%28part._analysis%29" data-pltdoc="x">Implementing Feature-Specific Analyses</a>.</p><p>A value of <span class="RktVal">#f</span> will result in the plug-in using the default analysis
provided by the profiling library. This analysis groups costs by feature
instance and prints them to standard output. It is usually best to use this
option to start with, and eventually migrate to a more sophisticated analysis.</p><p>The most basic feature plug-in is a feature struct with a name and a key, and
uses the default grouping and analysis.
To include the new feature when profiling, pass the feature struct to
<span class="RktSym"><a href="#%28form._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile%29%29" class="RktStxLink" data-pltdoc="x">feature-profile</a></span>&rsquo;s or <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fmain..rkt%29._feature-profile-thunk%29%29" class="RktValLink" data-pltdoc="x">feature-profile-thunk</a></span>&rsquo;s
<span class="RktPn">#:extra-features</span> argument.</p><h4 x-source-module="(lib &quot;feature-profile/scribblings/feature-profile.scrbl&quot;)" x-source-pkg="feature-profile" x-part-tag="&quot;analysis&quot;">3.3<tt>&nbsp;</tt><a name="(part._analysis)"></a>Implementing Feature-Specific Analyses</h4><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left" colspan="2"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._feature-profile%2Fplug-in-lib%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">feature-profile/plug-in-lib</span></a><span class="RktPn">)</span></td></tr><tr><td align="left">&nbsp;</td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/feature-profile" title="Install this package using `raco pkg install feature-profile`"><span class="stt">feature-profile</span></a></span></td></tr></table></p><p>While the basic analysis provided by default by the profiling library (grouping
costs by feature instance) is useful, instances of some features (such as
contracts) carry enough information to make further analysis worthwhile.
Further analysis can be used to produce precise reports tailored specifically
to a given feature.</p><p>This section describes the API provided by the profiling library for building
feature-specific analyses.
This API is still experimental, and is likely to change in the future.</p><p>A feature-specific analysis is a function that takes a <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature-report%29%29" class="RktValLink" data-pltdoc="x">feature-report</a></span>
structure as an argument and emits profiling reports as a side effect.
This function should be used as the <span class="RktSym">analysis</span> field of the relevant
<span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature%29%29" class="RktValLink" data-pltdoc="x">feature</a></span> object.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report-feature-time))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report-total-time))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report-grouped-samples))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report-raw-samples))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report-core-samples))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report-feature))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._make-feature-report))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report~3f))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._struct~3afeature-report))"></a><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._feature-report))"></a><span title="Provided from: feature-profile/plug-in-lib | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature-report%29%29" class="RktValDef RktValLink" data-pltdoc="x">feature-report</a></span></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">feature</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">core-samples</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">raw-samples</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">grouped-samples</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">total-time</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">feature-time</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-feature-report</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">feature</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature~3f%29%29" class="RktValLink" data-pltdoc="x">feature?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">core-samples</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">raw-samples</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">grouped-samples</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">total-time</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">feature-time</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Feature report structures contain information about a feature gathered during
program execution. Information is available in raw form (what&rsquo;s directly
gathered via sampling) and at various stages of processing by the core
profiler. This information can be used by feature-specific analyses to generate
custom reports and views.</div></p><p>The <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature%29%29" class="RktValLink" data-pltdoc="x">feature</a></span> field contains the <span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature%29%29" class="RktValLink" data-pltdoc="x">feature</a></span> structure that
corresponds to the feature being profiled and analyzed.</p><p>The <span class="RktSym">core-samples</span> field contains feature <span style="font-style: italic">core samples</span>, that is
each sample is a list of all marks related to the feature of interest that are
on the stack at the time the sample is taken. The most recent mark is at the
front of the list. These core samples include antimarks.</p><p>The <span class="RktSym">raw-samples</span> field contains the samples collected by the regular
Racket profiler during program execution, in the (intentionally) undocumented
format used by the profiler. These samples can be passed to the regular
profiler&rsquo;s analyzer, and the result correlated with feature data.</p><p>The <span class="RktSym">grouped-samples</span> field contains a list of groups (lists) of
samples, grouped using the feature&rsquo;s grouping function. Each sample has the
most recent payload as its <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._car%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">car</a></span> and a sample in the regular profiler&rsquo;s
format as its <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._cdr%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">cdr</a></span>.</p><p>The <span class="RktSym">total-time</span> field contains the total time (in milliseconds)
observed by the sampler.</p><p>The <span class="RktSym">feature-time</span> field contains the time (in milliseconds) for which a
feature mark was observed, as estimated by interpolating sample timestamps.</p><p>This library also provides helper functions for common analysis tasks.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._print-feature-profile))"></a><span title="Provided from: feature-profile/plug-in-lib | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._print-feature-profile%29%29" class="RktValDef RktValLink" data-pltdoc="x">print-feature-profile</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">f-p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">f-p</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._feature-report~3f%29%29" class="RktValLink" data-pltdoc="x">feature-report?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Displays the results of the built-in basic analysis. Useful when the custom
analysis for a feature supplements (but does not completely replace) basic
analysis.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._feature-profile/plug-in-lib..rkt)._make-interner))"></a><span title="Provided from: feature-profile/plug-in-lib | Package: feature-profile"><span class="RktSym"><a href="#%28def._%28%28lib._feature-profile%2Fplug-in-lib..rkt%29._make-interner%29%29" class="RktValDef RktValLink" data-pltdoc="x">make-interner</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Produces an interning function that takes a name-location pair (e.g. from the
regular profiler&rsquo;s samples) and interns it. The regular profiler&rsquo;s analysis
requires name-location pairs to be interned, hence this function.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>