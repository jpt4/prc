<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>with-cache</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">with-<wbr></wbr>cache</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Parameters%29" class="tocviewlink" data-pltdoc="x">Parameters</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Utilities%29" class="tocviewlink" data-pltdoc="x">Utilities</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">with-<wbr></wbr>cache</a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">with-<wbr></wbr>cache</span></span></a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Parameters%29" class="tocsubseclink" data-pltdoc="x">Parameters</a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Ause-cache~3f%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">*use-<wbr></wbr>cache?*</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Awith-cache-fasl~3f%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">*with-<wbr></wbr>cache-<wbr></wbr>fasl?*</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-directory%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">*current-<wbr></wbr>cache-<wbr></wbr>directory*</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">*current-<wbr></wbr>cache-<wbr></wbr>keys*</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Akeys-equal~3f%2A%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">*keys-<wbr></wbr>equal?*</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Utilities%29" class="tocsubseclink" data-pltdoc="x">Utilities</a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._cachefile%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">cachefile</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._parent-directory-exists~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">parent-<wbr></wbr>directory-<wbr></wbr>exists?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._equivalence%2Fc%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">equivalence/<span class="mywbr"> &nbsp;</span>c</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._get-with-cache-version%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">get-<wbr></wbr>with-<wbr></wbr>cache-<wbr></wbr>version</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache-logger%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">with-<wbr></wbr>cache-<wbr></wbr>logger</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;with-cache/scribblings/with-cache.scrbl&quot;)" x-source-pkg="with-cache" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(mod-path._with-cache)"></a>with-cache</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author"><a href="https://github.com/bennn">Ben Greenman</a></p></span></div><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">with-cache</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/with-cache" title="Install this package using `raco pkg install with-cache`"><span class="stt">with-cache</span></a></span></td></tr></table></p><p>Simple, filesystem-based caching.
Wrap your large computations in a thunk and let <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> deal with
 saving and retrieving the result.</p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fish</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._cachefile%29%29" class="RktValLink" data-pltdoc="x">cachefile</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"stdfish.rktd"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">standard-fish</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>By default, any cache built by an older version of <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">with-cache</span></a> is invalid. Set <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span> to override this default.</p></blockquote></blockquote></blockquote></div></p><p>Here&rsquo;s a diagram of what&rsquo;s happening in <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span>:</p><blockquote class="SCentered"><p><img style="vertical-align: -4.5px; margin: -3px -3px -3px -3px;" src="pict.png" alt="image" width="635.7998046875" height="135.7001953125"/></p></blockquote><ul><li><p>The <span style="font-style: italic">dollar sign</span> on the left represents a value that is expensive to compute.</p></li><li><p>The <span style="font-style: italic">box</span> in the left-middle is a serialized version of the expensive value.</p></li><li><p>The <span style="font-style: italic">yellow box</span> in the right-middle is the serialized data paired with a (yellow) label.</p></li><li><p>The <span style="font-style: italic">file symbol</span> on the right represents a location on the filesystem.</p></li></ul><p><div class="SIntrapara">The <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> function implements this pipeline and provides hooks for controlling the interesting parts.
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">#:write</span> and <span class="RktPn">#:read</span> are optional arguments to <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span>.
They default to <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=serialization.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fserialize..rkt%2529._serialize%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">serialize</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=serialization.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fserialize..rkt%2529._deserialize%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">deserialize</a></span>.</p></li><li><p><span class="RktSym">add-keys</span> is a hidden function that adds the value of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span> to a cached value.</p></li><li><p><span class="RktSym">keys-equal?</span> compares the keys in a cache file to the now-current value of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span>.</p></li><li><p><span class="RktSym">write-data</span> and <span class="RktSym">read-data</span> are <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=fasl.html%23%2528def._%2528%2528lib._racket%252Ffasl..rkt%2529._s-exp-%7E3efasl%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">s-exp-&gt;fasl</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=fasl.html%23%2528def._%2528%2528lib._racket%252Ffasl..rkt%2529._fasl-%7E3es-exp%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">fasl-&gt;s-exp</a></span> when the parameter <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Awith-cache-fasl~3f%2A%29%29" class="RktValLink" data-pltdoc="x">*with-cache-fasl?*</a></span> is <span class="RktVal">#t</span>.
Otherwise, these functions are <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">write</a></span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">read</a></span>.</p></li></ul></div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._with-cache))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValDef RktValLink" data-pltdoc="x">with-cache</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">cache-path</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">thunk</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:read</span><span class="hspace">&nbsp;</span><span class="RktVar">read-proc</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:write</span><span class="hspace">&nbsp;</span><span class="RktVar">write-proc</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:use-cache?</span><span class="hspace">&nbsp;</span><span class="RktVar">use-cache?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:fasl?</span><span class="hspace">&nbsp;</span><span class="RktVar">fasl?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:keys</span><span class="hspace">&nbsp;</span><span class="RktVar">keys</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:keys-equal?</span><span class="hspace">&nbsp;</span><span class="RktVar">keys-equal?</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">any</a></span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cache-path</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">thunk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">read-proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=serialization.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fserialize..rkt%2529._deserialize%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">deserialize</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">write-proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">any</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=serialization.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fserialize..rkt%2529._serialize%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">serialize</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">use-cache?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Ause-cache~3f%2A%29%29" class="RktValLink" data-pltdoc="x">*use-cache?*</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fasl?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Awith-cache-fasl~3f%2A%29%29" class="RktValLink" data-pltdoc="x">*with-cache-fasl?*</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">keys</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._parameter%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">parameter?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">keys-equal?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._equivalence%2Fc%29%29" class="RktValLink" data-pltdoc="x">equivalence/c</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Akeys-equal~3f%2A%29%29" class="RktValLink" data-pltdoc="x">*keys-equal?*</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">If <span class="RktVar">cache-path</span> exists:
</div><div class="SIntrapara"><blockquote><ol><li><p>reads the contents of <span class="RktVar">cache-path</span> (using <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=fasl.html%23%2528def._%2528%2528lib._racket%252Ffasl..rkt%2529._s-exp-%7E3efasl%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">s-exp-&gt;fasl</a></span> if <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Awith-cache-fasl~3f%2A%29%29" class="RktValLink" data-pltdoc="x">*with-cache-fasl?*</a></span> is <span class="RktVal">#t</span> and <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Reading.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._read%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">read</a></span> otherwise);</p></li><li><p>checks whether the result contains keys equal to <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span>,
 where "equal" is determined by <span class="RktVar">keys-equal?</span>;</p></li><li><p>if so, removes the keys and deserializes a value.</p></li></ol></blockquote></div><div class="SIntrapara">If <span class="RktVar">cache-path</span> does not exist or contains invalid data:
</div><div class="SIntrapara"><blockquote><ol><li><p>executes <span class="RktVar">thunk</span>, obtains result <span class="RktSym">r</span>;</p></li><li><p>retrieves the values of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span>;</p></li><li><p>saves the keys and <span class="RktSym">r</span> to <span class="RktVar">cache-path</span>;</p></li><li><p>returns <span class="RktSym">r</span></p></li></ol></blockquote></div></p><p>Uses <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528lib._racket%252Ffile..rkt%2529._call-with-file-lock%252Ftimeout%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">call-with-file-lock/timeout</a></span> to protect concurrent reads and writes to the same <span class="RktVar">cache-path</span>.
If a thread fails to lock <span class="RktVar">cache-path</span>, <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> throws an exception (<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%7E3afilesystem%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exn:fail:filesystem</a></span>) giving the location of the problematic lock file.
All lock files are generated by <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528lib._racket%252Ffile..rkt%2529._make-lock-file-name%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">make-lock-file-name</a></span> and stored in <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._find-system-path%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">find-system-path</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">temp-dir</span><span class="RktPn">)</span>.</p><p>Diagnostic information is logged under the <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> topic.
To see logging information, use either:</p><blockquote><p><span class="stt">racket -W with-cache &lt;file.rkt&gt;</span></p></blockquote><p>or, if you are not invoking <span class="stt">racket</span> directly:</p><blockquote><p><span class="stt">PLTSTDERR="error info@with-cache" &lt;CMD&gt;</span></p></blockquote><h3 x-source-module="(lib &quot;with-cache/scribblings/with-cache.scrbl&quot;)" x-source-pkg="with-cache" x-part-tag="&quot;Parameters&quot;">1<tt>&nbsp;</tt><a name="(part._.Parameters)"></a>Parameters</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._*use-cache~3f*))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Ause-cache~3f%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*use-cache?*</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Ause-cache~3f%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*use-cache?*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">use-cache?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">use-cache?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#t</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Parameter for disabling <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span>.
When <span class="RktVal">#f</span>, <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> will not read or write any cachefiles.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._*with-cache-fasl~3f*))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Awith-cache-fasl~3f%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*with-cache-fasl?*</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Awith-cache-fasl~3f%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*with-cache-fasl?*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">fasl?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">fasl?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">#t</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">When <span class="RktVal">#t</span>, write files in <span class="stt">fasl</span> format.
Otherwise, write files with <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._write%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">write</a></span>.</div></p><p>Note that byte strings written using <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=fasl.html%23%2528def._%2528%2528lib._racket%252Ffasl..rkt%2529._s-exp-%7E3efasl%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">s-exp-&gt;fasl</a></span> cannot be read by code running a different version of Racket.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._*current-cache-directory*))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-directory%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*current-cache-directory*</a></span></span><span class="RktPn"></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._and%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._directory-exists%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">directory-exists?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-directory%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*current-cache-directory*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">cache-dir</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">cache-dir</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._and%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._directory-exists%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">directory-exists?</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._build-path%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">build-path</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-directory%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">current-directory</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"compiled"</span><span class="hspace">&nbsp;</span><span class="RktVal">"with-cache"</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">The value of this parameter is the prefix of paths returned by <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._cachefile%29%29" class="RktValLink" data-pltdoc="x">cachefile</a></span>.
Another good default is <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Filesystem.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._find-system-path%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">find-system-path</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">temp-dir</span><span class="RktPn">)</span>.
See also the <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=basedir&amp;rel=index.html&amp;version=7.4" class="Sq" data-pltdoc="x">XDG Basedir Library</a>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._*current-cache-keys*))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*current-cache-keys*</a></span></span><span class="RktPn"></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._parameter%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">parameter?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*current-cache-keys*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">params</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">params</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._parameter%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">parameter?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._get-with-cache-version%29%29" class="RktValLink" data-pltdoc="x">get-with-cache-version</a></span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">List of parameters (or thunks) used to check when a cache is invalid.</div></p><p>Before writing a cache file, <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> gets the value of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span>
 (by taking the value of the parameters and forcing the thunks)
 and writes the result to the file.
When reading a cache file, <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> gets the current value of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span>
 and compares this value to the value written in the cache file.
If the current keys are NOT equal to the old keys (equal in the sense of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Akeys-equal~3f%2A%29%29" class="RktValLink" data-pltdoc="x">*keys-equal?*</a></span>),
 then the cache is invalid.</p><p>For example, <span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=time.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-seconds%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">current-seconds</a></span><span class="RktPn">)</span><span class="RktPn">)</span> causes
 <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> to ignore cachefiles written more than 1 second ago.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fresh-fish</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=parameters.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fmore-scheme..rkt%2529._parameterize%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">parameterize</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=pairs.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._list%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=time.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._current-seconds%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">current-seconds</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._cachefile%29%29" class="RktValLink" data-pltdoc="x">cachefile</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"stdfish.rktd"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=lambda.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._%7Ece%7Ebb%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">standard-fish</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">fresh-fish</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Writes to "compiled/with-cache/stdfish.rktd"</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">fresh-fish</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Reads from "compiled/with-cache/stdfish.rktd"</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=threads.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._sleep%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">sleep</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">fresh-fish</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Writes to "compiled/with-cache/stdfish.rktd"</span></td></tr></table></blockquote><p>By default, the only key is a thunk that retrieves the installed version of
 the <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span> package.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._*keys-equal~3f*))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Akeys-equal~3f%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*keys-equal?*</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._equivalence%2Fc%29%29" class="RktValLink" data-pltdoc="x">equivalence/c</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Akeys-equal~3f%2A%29%29" class="RktValDef RktValLink" data-pltdoc="x">*keys-equal?*</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">=?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">=?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._equivalence%2Fc%29%29" class="RktValLink" data-pltdoc="x">equivalence/c</a></span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._equal%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">equal?</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Used to check whether a cache file is invalid.</div></p><p>A cache is invalid if <span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">old-keys</span><span class="stt"> </span><span class="RktVar">current-keys</span><span class="RktPn">)</span> returns <span class="RktVal">#false</span>,
 where <span class="RktVar">current-keys</span> is the current value of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-keys%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-keys*</a></span>.</p><p><div class="SIntrapara">By convention, the function bound to <span class="RktVar">=?</span> should be an equivalence,
 meaning it obeys the following 3 laws:
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">k</span><span class="stt"> </span><span class="RktVar">k</span><span class="RktPn">)</span> returns a true value for all <span class="RktVar">k</span>;</p></li><li><p><span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">k1</span><span class="stt"> </span><span class="RktVar">k2</span><span class="RktPn">)</span> returns the same value as <span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">k2</span><span class="stt"> </span><span class="RktVar">k1</span><span class="RktPn">)</span>; and</p></li><li><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=if.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fletstx-scheme..rkt%2529._and%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">and</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">k1</span><span class="stt"> </span><span class="RktVar">k2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">k2</span><span class="stt"> </span><span class="RktVar">k3</span><span class="RktPn">)</span><span class="RktPn">)</span> implies <span class="RktPn">(</span><span class="RktVar">=?</span><span class="stt"> </span><span class="RktVar">k1</span><span class="stt"> </span><span class="RktVar">k3</span><span class="RktPn">)</span> is true.</p></li></ul></div></p><p>The contract <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._equivalence%2Fc%29%29" class="RktValLink" data-pltdoc="x">equivalence/c</a></span> does not enforce these laws,
 but it might in the future.</p><h3 x-source-module="(lib &quot;with-cache/scribblings/with-cache.scrbl&quot;)" x-source-pkg="with-cache" x-part-tag="&quot;Utilities&quot;">2<tt>&nbsp;</tt><a name="(part._.Utilities)"></a>Utilities</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._cachefile))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._cachefile%29%29" class="RktValDef RktValLink" data-pltdoc="x">cachefile</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">filename</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._parent-directory-exists~3f%29%29" class="RktValLink" data-pltdoc="x">parent-directory-exists?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">filename</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Manipulating_Paths.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._path-string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Prefix <span class="RktVar">filename</span> with the value of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._%2Acurrent-cache-directory%2A%29%29" class="RktValLink" data-pltdoc="x">*current-cache-directory*</a></span>.
By contract, this function returns only paths whose parent directory exists.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._parent-directory-exists~3f))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._parent-directory-exists~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">parent-directory-exists?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Flat contract that checks whether <span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=More_Path_Utilities.html%23%2528def._%2528%2528lib._racket%252Fpath..rkt%2529._path-only%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">path-only</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="RktPn">)</span> exists.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._equivalence/c))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._equivalence%2Fc%29%29" class="RktValDef RktValLink" data-pltdoc="x">equivalence/c</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Flat contract for functions that implement equivalence relations.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._with-cache/main..rkt)._get-with-cache-version))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._get-with-cache-version%29%29" class="RktValDef RktValLink" data-pltdoc="x">get-with-cache-version</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=version&amp;rel=index.html%23%2528def._%2528%2528lib._version%252Futils..rkt%2529._valid-version%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">valid-version?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Return the current version of <span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache%29%29" class="RktValLink" data-pltdoc="x">with-cache</a></span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>value</p></div></div><p class="RForeground"><a name="(def._((lib._with-cache/main..rkt)._with-cache-logger))"></a><span title="Provided from: with-cache | Package: with-cache"><span class="RktSym"><a href="#%28def._%28%28lib._with-cache%2Fmain..rkt%29._with-cache-logger%29%29" class="RktValDef RktValLink" data-pltdoc="x">with-cache-logger</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=logging.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._logger%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">logger?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">A <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=logging.html%23%2528tech._logger%2529&amp;version=7.4" class="techoutside Sq" data-pltdoc="x"><span class="techinside">logger</span></a> that reports events from the <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">with-cache</span></a> library.
Logs <span class="RktVal">'</span><span class="RktVal">info</span> events when reading or writing caches and <span class="RktVal">'</span><span class="RktVal">error</span> events after detecting corrupted cache files.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>