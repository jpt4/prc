<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Scripty: Distributable shell scripts with dependencies</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Scripty:<span class="mywbr"> &nbsp;</span> Distributable shell scripts with dependencies</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._usage%29" class="tocviewlink" data-pltdoc="x">Using Scripty</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._options%29" class="tocviewlink" data-pltdoc="x">Script Options</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">Scripty:<span class="mywbr"> &nbsp;</span> Distributable shell scripts with dependencies</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._usage%29" class="tocsubseclink" data-pltdoc="x">Using Scripty</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._options%29" class="tocsubseclink" data-pltdoc="x">Script Options</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;scribblings/scripty.scrbl&quot;)" x-source-pkg="scripty-doc" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.Scripty__.Distributable_shell_scripts_with_dependencies)"></a><a name="(mod-path._scripty)"></a>Scripty: Distributable shell scripts with dependencies</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Alexis King &lt;<a href="mailto:lexi.lambda@gmail.com">lexi.lambda@gmail.com</a>&gt;</p></span></div><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">scripty</span></a></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/scripty-lib" title="Install this package using `raco pkg install scripty-lib`"><span class="stt">scripty-lib</span></a></span></td></tr></table></p><p>The <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">scripty</span></a> language is a tool for developing self-installing shell scripts. Every
Scripty script is composed of two parts: a <a href="#%28tech._script._preamble%29" class="techoutside" data-pltdoc="x"><span class="techinside">script preamble</span></a>, which describes metadata about the
script, such as its dependencies, and a <a href="#%28tech._script._body%29" class="techoutside" data-pltdoc="x"><span class="techinside">script body</span></a>, which is the runnable body of the script.
The body can be written in any Racket language, and it is not coupled to <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">scripty</span></a>&#8217;s
reader syntax.</p><h3 x-source-module="(lib &quot;scribblings/scripty.scrbl&quot;)" x-source-pkg="scripty-doc" x-part-tag="&quot;usage&quot;">1<tt>&nbsp;</tt><a name="(part._usage)"></a>Using Scripty</h3><p>Making a script with Scripty is not complicated, since the bulk of any Scripty script is just an
ordinary Racket module. Since Racket treats lines starting with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">#!</span><span class="hspace"></span></span> as comments, it&#8217;s quite
easy to turn any module into a runnable Unix script. Here&#8217;s a simple example:</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"hello.rkt"</span></span></p><blockquote class="Rfilecontent"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">#!/usr/bin/env</span><span class="hspace">&nbsp;</span><span class="RktCmt">racket</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fmisc..rkt%2529._displayln%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">displayln</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"Hello,</span><span class="hspace">&nbsp;</span><span class="RktVal">world!"</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote><p>Now it&#8217;s possible to run the above file as a Unix executable:</p><p><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ chmod +x hello.rkt</span></div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ ./hello.rkt</span></div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Hello, world!</span></div></p><p>This is great, but unfortunately, this approach won&#8217;t work so well if your script depends on some
libraries a user doesn&#8217;t have. That&#8217;s where <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">scripty</span></a> comes in.</p><p>To convert any Racket module into a Scripty-managed script, add <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a> <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">scripty</span></a>
to the top, followed by a <a name="(tech._script._preamble)"></a><span style="font-style: italic">script preamble</span>:</p><blockquote class="Rfilebox"><p class="Rfiletitle"><span class="Rfilename"><span class="stt">"parse.rkt"</span></span></p><blockquote class="Rfilecontent"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">#!/usr/bin/env</span><span class="hspace">&nbsp;</span><span class="RktCmt">racket</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">scripty</span><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;</span><span class="hspace">&nbsp;</span><span class="RktCmt">\</span><span class="hspace">&nbsp;</span><span class="RktCmt">script</span><span class="hspace">&nbsp;</span><span class="RktCmt">preamble</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">#:dependencies</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">'</span><span class="RktPn">(</span><span class="RktVal">"base"</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">"megaparsack-lib"</span><span class="RktPn">)</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktCmt">;</span><span class="hspace">&nbsp;</span><span class="RktCmt">/</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">------------------------------------------</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktMeta">#lang</span><span class="hspace">&nbsp;</span><span class="RktMeta">racket/base</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta">&#160;</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">megaparsack</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote></blockquote></blockquote><p>The preamble contains metadata about the script, such as its dependencies, as demonstrated by the
above example, and it must be separated from the rest of the module by a line composed exclusively of
at least 3 <span class="RktInBG"><span class="hspace"></span><span class="RktIn">-</span><span class="hspace"></span></span> characters.</p><p>The script preamble is followed by an ordinary Racket module, which forms the <a name="(tech._script._body)"></a><span style="font-style: italic">script body</span>,
and usually begins with a second <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a> line. When the script is run from the command line, the
script body will be run after dependencies have been installed.</p><p>When a user runs a Scripty script, but they don&#8217;t have all of the required dependencies already
installed, they will be interactively prompted to ask if they would like to install them. If they
agree, then the packages will be installed, and the script will be run. Otherwise, the script will
terminate. If all packages are already installed, the script will run as usual.</p><p>Packages installed by scripty are marked as &#8220;auto-installed&#8221;, so running
<span class="stt">raco pkg remove --auto</span> will remove them if they are not depended upon by
other packages. If packages that a script depends on are uninstalled, then the user will simply be
prompted to reinstall them the next time they run the script.</p><h3 x-source-module="(lib &quot;scribblings/scripty.scrbl&quot;)" x-source-pkg="scripty-doc" x-part-tag="&quot;options&quot;">2<tt>&nbsp;</tt><a name="(part._options)"></a>Script Options</h3><p>Currently, the only option supported by the <a href="#%28tech._script._preamble%29" class="techoutside" data-pltdoc="x"><span class="techinside">script preamble</span></a> is <span class="RktPn">#:dependencies</span>.</p><p><table cellspacing="0" cellpadding="0"><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">script-preamble</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:dependencies</span><span class="hspace">&nbsp;</span><span class="RktVar">deps-expr</span></td></tr></table></p><p>The <span class="RktVar">deps-expr</span> form is evaluated at phase one, and it should produce a list of package
dependencies in the same format as the <span class="RktSym">deps</span> key of <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=guide&amp;rel=Module_Syntax.html%23%2528part._hash-lang%2529&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktMod">#lang</span></a> <a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=raco&amp;rel=info_rkt.html&amp;version=7.4" class="RktModLink Sq" data-pltdoc="x"><span class="RktSym">info</span></a>.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>