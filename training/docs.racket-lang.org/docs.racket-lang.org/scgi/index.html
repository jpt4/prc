<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>scgi: Web Server HTTP SCGI and CGI</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">scgi:<span class="mywbr"> &nbsp;</span> Web Server HTTP SCGI and CGI</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Interface%29" class="tocviewlink" data-pltdoc="x">Interface</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Apache_mod_scgi%29" class="tocviewlink" data-pltdoc="x">Apache mod_<span class="mywbr"> &nbsp;</span>scgi</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.History%29" class="tocviewlink" data-pltdoc="x">History</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.Legal%29" class="tocviewlink" data-pltdoc="x">Legal</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">scgi:<span class="mywbr"> &nbsp;</span> Web Server HTTP SCGI and CGI</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Interface%29" class="tocsubseclink" data-pltdoc="x">Interface</a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-content-length%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>content-<wbr></wbr>length</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._make-cgi-variable-proc%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">make-<wbr></wbr>cgi-<wbr></wbr>variable-<wbr></wbr>proc</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-content-type%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>content-<wbr></wbr>type</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-document-root%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>document-<wbr></wbr>root</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-http-cookie%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>http-<wbr></wbr>cookie</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-http-host%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>http-<wbr></wbr>host</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-http-referer%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>http-<wbr></wbr>referer</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-http-user-agent%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>http-<wbr></wbr>user-<wbr></wbr>agent</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-https%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>https</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-path-info%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>path-<wbr></wbr>info</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-path-translated%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>path-<wbr></wbr>translated</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-query-string%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>query-<wbr></wbr>string</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-remote-addr%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>remote-<wbr></wbr>addr</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-remote-host%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>remote-<wbr></wbr>host</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-remote-user%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>remote-<wbr></wbr>user</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-request-method%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>request-<wbr></wbr>method</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-request-uri%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>request-<wbr></wbr>uri</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-script-name%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>script-<wbr></wbr>name</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-server-name%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>server-<wbr></wbr>name</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-server-port%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>server-<wbr></wbr>port</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._scgi-variables%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">scgi-<wbr></wbr>variables</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-type%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>type</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._cgi-request-id%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">cgi-<wbr></wbr>request-<wbr></wbr>id</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._scgi%2Fmain..rkt%29._stop-cgi-service-immediately%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">stop-<wbr></wbr>cgi-<wbr></wbr>service-<wbr></wbr>immediately</span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Apache_mod_scgi%29" class="tocsubseclink" data-pltdoc="x">Apache mod_<span class="mywbr"> &nbsp;</span>scgi</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.Apache_mod_scgi_.Configuration%29" class="tocsubseclink" data-pltdoc="x">Apache mod_<span class="mywbr"> &nbsp;</span>scgi Configuration</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.Apache_mod_scgi_.Troubleshooting%29" class="tocsubseclink" data-pltdoc="x">Apache mod_<span class="mywbr"> &nbsp;</span>scgi Troubleshooting</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.History%29" class="tocsubseclink" data-pltdoc="x">History</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Legal%29" class="tocsubseclink" data-pltdoc="x">Legal</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">3:3</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._scgi__.Web_.Server_.H.T.T.P_.S.C.G.I_and_.C.G.I)"></a><a name="(mod-path._scgi)"></a>scgi: Web Server HTTP SCGI and CGI</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Neil Van Dyke</p></span></div><p><div class="SIntrapara"></div><div class="SIntrapara">License: <a href="#%28part._.Legal%29" class="plainlink" data-pltdoc="x">LGPLv3</a> <span class="hspace">&nbsp;</span> Web: <a href="http://www.neilvandyke.org/racket/scgi/" class="plainlink">http://www.neilvandyke.org/racket/scgi/</a>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">scgi</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/scgi" title="Install this package using `raco pkg install scgi`"><span class="stt">scgi</span></a></span></td></tr></table></div></p><h3 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;Introduction&quot;">1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p><div class="SIntrapara">The <span style="font-weight: bold">scgi</span> library implements fast Web CGI using the SCGI protocol.  This
library is used in conjunction with an HTTP server supporting SCGI, such as
Apache HTTP Server with the <span class="RktSym">mod_scgi</span><span class="RktMeta"></span> module.</div><div class="SIntrapara">The <span style="font-weight: bold">scgi</span> library also supports running as normal Web CGI without any change
to the source code of the app, such as during development of an application
intended to be deployed using SCGI.  This also gives flexibility in deployment,
allowing a system administrator to switch between either mode just by editing
the HTTP server configuration.</div><div class="SIntrapara">The SCGI protocol was specified by Neil Schemenauer in &ldquo;<a href="http://python.ca/scgi/protocol.txt">SCGI: A Simple Common Gateway Interface alternative</a>,&rdquo; dated 2008-06-23.</div><div class="SIntrapara">An example use of this library:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">require</span><span class="hspace">&nbsp;</span><span class="RktSym">scgi</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">cgi</span><span class="hspace">&nbsp;</span><span class="RktPn">#:startup</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"Startup for cgi-type ~S..."</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cgi-type</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:request</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktVal">"Content-type: text/html\r\n\r\n"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display</span><span class="hspace">&nbsp;</span><span class="RktVal">"&lt;p&gt;Hello, world!&lt;/p&gt;"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"&lt;p&gt;Your IP address is: ~S&lt;/p&gt;"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cgi-remote-addr</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:shutdown</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"Shutdown for cgi-type ~S..."</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cgi-type</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The procedure provided to the <span class="RktPn">#:request</span> is the one that gets called for each request.  Within that procedure, is the <a name="(tech._cgi._request._context)"></a><span style="font-style: italic">CGI request context</span>, in which procedures like <span class="RktSym">cgi-remote-addr</span> may be called to get information about that particular request.  All three procedures are called within <a name="(tech._cgi._context)"></a><span style="font-style: italic">CGI context</span>, in which procedures concerning the CGI mechanism separate from individual requests, such as <span class="RktSym">cgi-type</span> may be called.  Many programs will need to provide only the <span class="RktPn">#:request</span> procedure.</div></p><h3 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;Interface&quot;">2<tt>&nbsp;</tt><a name="(part._.Interface)"></a>Interface</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:startup</span><span class="hspace">&nbsp;</span><span class="RktVar">startup-proc</span>]</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:request</span><span class="hspace">&nbsp;</span><span class="RktVar">request-proc</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:shutdown</span><span class="hspace">&nbsp;</span><span class="RktVar">shutdown-proc</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:scgi-hostname</span><span class="hspace">&nbsp;</span><span class="RktVar">scgi-hostname</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:scgi-max-allow-wait</span><span class="hspace">&nbsp;</span><span class="RktVar">scgi-max-allow-wait</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:scgi-portnum</span><span class="hspace">&nbsp;</span><span class="RktVar">scgi-portnum</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:reuse-scgi-port?</span><span class="hspace">&nbsp;</span><span class="RktVar">reuse-scgi-port?</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">void?</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">startup-proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym">void</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">request-proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">shutdown-proc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym">void</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">scgi-hostname</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">"127.0.0.1"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">scgi-max-allow-wait</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">exact-nonnegative-integer?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">4</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">scgi-portnum</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">and/c</span><span class="hspace">&nbsp;</span><span class="RktSym">exact-nonnegative-integer?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">integer-in</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">65535</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVal">4000</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">reuse-scgi-port?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></blockquote></div><div class="SIntrapara">Implement CGI.  Normal CGI is used if the <span class="RktSym">REQUEST_URI</span><span class="RktMeta"></span> environment variable is defined (which suggests that the code is
being called in a CGI context); otherwise, SCGI is used.</div><div class="SIntrapara"><span class="RktVar">startup-proc</span> is a thunk that is evaluated once (before listener starts).  <span class="RktVar">request-proc</span> is evaluated once for each request (which, in normal CGI, is once). <span class="RktVar">shutdown-proc</span> is evaluated once, as processing of all CGI requests has finished.</div><div class="SIntrapara">For evaluation of <span class="RktVar">request-proc</span>, the default input and output ports are as with normal CGI, regardless
of whether normal CGI or SCGI is in use.</div><div class="SIntrapara">This procedure also accepts a few optional keyword arguments, all of
which apply to SCGI mode only.  <span class="RktVar">scgi-hostname</span> is the hostname or IP address (as a string) for the interface on which
to listen.  <span class="RktVar">scgi-portnum</span> is the TCP port number on that interface.  <span class="RktVar">scgi-max-allow-wait</span> is the maximum number of unaccepted connections to permit waiting.  <span class="RktVar">reuse-scgi-port?</span> is whether or not to reuse the TCP port number, such as if a previous
server exited and the port is in a <span class="RktSym">TIME_WAIT</span> state.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-content-length))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-content-length</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">exact-nonnegative-integer?</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">In a CGI request context, returns the CGI content length &ndash; the
number of bytes that can be read from the default input port &ndash; as integer.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._make-cgi-variable-proc))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">make-cgi-variable-proc</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">proc-name-sym</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">name-bytes</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">proc-name-sym</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name-bytes</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span></td></tr></table></blockquote></div><div class="SIntrapara">Produces a procedure for getting a CGI environment variable value
as a string.  Works whether in normal CGI or SCGI.  This is useful for
accessing non-standard variables, such as might be provided by an unusual
Apache module.  Argument <span class="RktVar">proc-name-sym</span> is a symbol for the name of the procedure, which is used in
error reporting.  Argument <span class="RktVar">name-bytes</span> is the name of the environment variable, as a byte string.</div><div class="SIntrapara">For example, were the <span class="RktSym">cgi-remote-user</span> procedure not already defined, it could be defined as:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">cgi-remote-user</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-cgi-variable-proc</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">cgi-remote-user</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#"REMOTE_USER"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-content-type))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-content-type</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-document-root))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-document-root</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-http-cookie))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-http-cookie</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-http-host))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-http-host</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-http-referer))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-http-referer</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-http-user-agent))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-http-user-agent</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-https))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-https</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-path-info))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-path-info</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-path-translated))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-path-translated</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-query-string))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-query-string</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-remote-addr))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-remote-addr</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-remote-host))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-remote-host</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-remote-user))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-remote-user</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-request-method))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-request-method</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-request-uri))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-request-uri</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-script-name))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-script-name</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-server-name))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-server-name</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-server-port))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-server-port</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr></table></blockquote></div><div class="SIntrapara">In a CGI request context, returns the corresponding CGI value as
a string.  Note that <span class="RktSym">cgi-content-length</span> is <span style="font-style: italic">not</span> in this list, and it returns a number rather than a string.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._scgi-variables))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">scgi-variables</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span><span class="hspace">&nbsp;</span><span class="RktSym">bytes?</span><span class="RktPn">)</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">When called in SCGI mode, this procedure yields an alist of SCGI
variables with both the key and value of each pair being byte strings.  Calling
this procedure in normal CGI mode is an error.</div><div class="SIntrapara">Note that normally you will not need to use this procedure, and will
instead use procedures like <span class="RktSym">cgi-request-uri</span>, which work in both SCGI and normal CGI modes.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-type))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-type</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">normal</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">scgi</span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Returns a symbol indicating the CGI type: <span class="RktVal">'</span><span class="RktVal">normal</span> or <span class="RktVal">'</span><span class="RktVal">scgi</span>. Behavior outside of the procedures of the <span class="RktSym">cgi</span> procedure is undefined.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._cgi-request-id))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">cgi-request-id</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">In CGI request context, yields a printable identifying object for
the current request that is unique at least for the current requests being
handled.  This identifying object is intended to be used in debugging
messages.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._scgi/main..rkt)._stop-cgi-service-immediately))"></a><span title="Provided from: scgi | Package: scgi"><span class="RktSym"><span class="RktSymDef RktSym">stop-cgi-service-immediately</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">void?</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Stops processing all CGI requests.  This works only within the <span class="RktPn">#:request</span> procedure of the <span class="RktSym">cgi</span> procedure.</div></p><h3 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;Apache_mod_scgi&quot;">3<tt>&nbsp;</tt><a name="(part._.Apache_mod_scgi)"></a>Apache mod_scgi</h3><h4 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;Apache_mod_scgi_Configuration&quot;">3.1<tt>&nbsp;</tt><a name="(part._.Apache_mod_scgi_.Configuration)"></a>Apache mod_scgi Configuration</h4><p><div class="SIntrapara">Apache HTTP Server is one way to run SCGI, though not the only way.
Note that your Apache installation might not have the <span class="RktSym">mod_scgi</span><span class="RktMeta"></span> module installed or enabled by default.  If you happen to be
running Debian GNU/Linux, this module can be installed via the Debian package <span class="RktSym">libapache2-mod-scgi</span><span class="RktMeta"></span>.</div><div class="SIntrapara">Once you&rsquo;ve installed <span class="RktSym">mod_scgi</span><span class="RktMeta"></span>, you need some standard SCGI directives to end up in your Apache
config files, whether you accomplish that by editing config files manually,
making symbolic links in a <span class="stt">"mods-enabled"</span> directory, or clicking in a GUI.</div><div class="SIntrapara">For example, the following loads <span class="RktSym">mod_scgi</span><span class="RktMeta"></span>, maps URL paths under <span class="stt">"/mypath"</span> to the SCGI server on the local machine at the standard SCGI TCP
port, and sets a 60-second timeout for the SCGI server to respond to a request
before Apache drops the connection:</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">LoadModule scgi_module /usr/lib/apache2/modules/mod_scgi.so</span></p></td></tr><tr><td><p><span class="stt">SCGIMount /mypath 127.0.0.1:4000</span></p></td></tr><tr><td><p><span class="stt">SCGIServerTimeout 60</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr></table></div><div class="SIntrapara">There are additional <span class="RktSym">mod_scgi</span><span class="RktMeta"></span> Apache config directives, including <span class="RktSym">SCGIHandler</span><span class="RktMeta"></span> and <span class="RktSym">SCGIServer</span><span class="RktMeta"></span>.</div></p><h4 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;Apache_mod_scgi_Troubleshooting&quot;">3.2<tt>&nbsp;</tt><a name="(part._.Apache_mod_scgi_.Troubleshooting)"></a>Apache mod_scgi Troubleshooting</h4><p><div class="SIntrapara">This section has some troubleshooting tips.  Currently, these come from
use with <span class="RktSym">mod_scgi</span><span class="RktMeta"></span> atop Apache 2.2.9 atop Debian GNU/Linux.</div><div class="SIntrapara"><ul><li><p>Racket error &ldquo;tcp-write: error writing (Broken pipe; errno=32)&rdquo;
or &ldquo;tcp-write: error writing (Connection reset by peer; errno=104)&rdquo; is likely
due to the HTTP request having been dropped by the HTTP client (e.g., user
stops a page load in their browser before page finishes loading) or by Apache
hitting <span class="RktSym">SCGIServerTimeout</span><span class="RktMeta"></span> for the request.  Note that buffered I/O means that you won&rsquo;t
necessarily get this error even if the request is aborted this way.</p></li><li><p>Apache error log entry &ldquo;Premature end of script headers: <span style="font-style: italic">PATH</span>&rdquo; followed by &ldquo;(500)Unknown error 500: scgi: Unknown error 500:
error reading response headers&rdquo; can mean that <span class="RktSym">SCGIServerTimeout</span><span class="RktMeta"></span> was hit before any HTTP headers from the SCGI request handler
were started or completed.  Note that buffered I/O can mean that some of the
Racket code of the handler wrote some text, but it was not yet flushed to the
SCGI client.</p></li><li><p>Apache error log entry &ldquo;(70007)The timeout specified has expired:
ap_content_length_filter: apr_bucket_read() failed&rdquo; followed by &ldquo;(70007)The
timeout specified has expired: scgi: The timeout specified has expired:
ap_pass_brigade()&rdquo; can mean that <span class="RktSym">SCGIServerTimeout</span><span class="RktMeta"></span> was hit after HTTP headers from the request handler had been
received by the SCGI client.</p></li><li><p>Apache error log entry &ldquo;(32)Broken pipe: scgi: Broken pipe: error
sending request body&rdquo; might be due to a request handler finished without
consuming all of the HTTP <span class="RktSym">POST</span><span class="RktMeta"></span> data.</p></li><li><p>Apache error log entry &ldquo;(103)Software caused connection abort:
scgi: Software caused connection abort: ap_pass_brigade()&rdquo; is another one that
can be caused by the HTTP client dropping the connection before the handler
finishes.</p></li></ul></div></p><h3 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;History&quot;">4<tt>&nbsp;</tt><a name="(part._.History)"></a>History</h3><ul><li><p><div class="SIntrapara">Version 3:3 &#8212;<wbr></wbr> 2016-03-02</div><div class="SIntrapara"><ul><li><p>Tweaked info.rkt, filenames.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 3:2 &#8212;<wbr></wbr> 2016-02-25</div><div class="SIntrapara"><ul><li><p>Fixed deps.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 3:1 &#8212;<wbr></wbr> 2016-02-25</div><div class="SIntrapara"><ul><li><p>Commented-out code in <span class="stt">"stress1-server.rkt"</span> as the most expedient way to get new package system
build to pass.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 3:0 &#8212;<wbr></wbr> 2016-02-21</div><div class="SIntrapara"><ul><li><p>Moving from PLaneT to new package system.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:4 &#8212;<wbr></wbr> 2015-04-02</div><div class="SIntrapara"><ul><li><p>Documentation tweaks.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:3 &#8212;<wbr></wbr> 2014-11-23</div><div class="SIntrapara"><ul><li><p>Removed file <span class="stt">sample-1.rkt</span> from package, to reduce package
dependencies.  (Suggested by Matt Gushee.)</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:2 &#8212;<wbr></wbr> 2013-04-19</div><div class="SIntrapara"><ul><li><p>Now accommodate SCGI variable names generated by Mellon
authentication.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:1 &#8212;<wbr></wbr> 2013-04-12</div><div class="SIntrapara"><ul><li><p>Now doesn&rsquo;t barf on headers like <span class="stt">proxy-nokeepalive</span>.  (Thanks to Erik for bug report and diagnosis.)</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:0 &#8212;<wbr></wbr> 2012-06-12</div><div class="SIntrapara"><ul><li><p>The three main procedures arguments to the <span class="RktSym">cgi</span> procedure now have keywords.  What are now the <span class="RktPn">#:startup</span> and <span class="RktPn">#:shutdown</span> arguments are now also optional.</p></li><li><p>Converted to <a href="http://www.neilvandyke.org/mcfly/">McFly</a>.</p></li><li><p>Changed internal-only identifiers from having a <span class="stt">%</span> prefix to a <span class="stt">%scgi:</span> prefix, to help disambiguate when identifiers appear in
error messages in large systems.</p></li><li><p>Documentation changes.</p></li><li><p>Improvement to the internal debugging macro.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.6 &#8212;<wbr></wbr> Version 1:5 &#8212;<wbr></wbr> 2011-08-22</div><div class="SIntrapara"><ul><li><p>Small documentation fixes.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.5 &#8212;<wbr></wbr> Version 1:4 &#8212;<wbr></wbr> 2011-05-16</div><div class="SIntrapara"><ul><li><p>For closer to backward compatibility with PLT Scheme
4.x, changed references to <span class="RktSym">racket</span> modules to <span class="RktSym">scheme</span>.</p></li><li><p>More documentation.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.4 &#8212;<wbr></wbr> Version 1:3 &#8212;<wbr></wbr> 2011-05-16</div><div class="SIntrapara"><ul><li><p>Added <span class="RktPn">#:reuse-scgi-port?</span> argument to procedure <span class="RktSym">cgi</span>. Added several new CGI environment variable procedures.</p></li><li><p>Added <span class="RktSym">make-cgi-variable-proc</span>.</p></li><li><p>The <span class="RktSym">cgi</span> procedure now uses <span class="RktSym">tcp-accept/enable-break</span> rather than <span class="RktSym">tcp-accept</span>.</p></li><li><p>Added more <span class="RktSym">log-debug</span>.</p></li><li><p>Added documentation about <span class="RktSym">mod_scgi</span><span class="RktMeta"></span> configuration, troubleshooting,and the keyword
arguments to the <span class="RktSym">cgi</span> procedure.</p></li><li><p>Removed documentation placeholders for <span class="RktSym">end-cgi-request</span> for now.</p></li><li><p>Various additional quality assurance testing has been
done, and more is the works.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.3 &#8212;<wbr></wbr> Version 1:2 &#8212;<wbr></wbr> 2010-11-14</div><div class="SIntrapara"><ul><li><p>Added <span class="RktSym">cgi-http-user-agent</span>.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.2 &#8212;<wbr></wbr> Version 1:1 &#8212;<wbr></wbr> 2010-10-11</div><div class="SIntrapara"><ul><li><p>Documentation changes to reflect that it is successfully in use in a real
system, and some work remains.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.1 &#8212;<wbr></wbr> Version 1:0 &#8212;<wbr></wbr> 2010-05-25</div><div class="SIntrapara"><ul><li><p>Initial release.  Preliminary.</p></li></ul></div></p></li></ul><h3 x-source-module="(lib &quot;scgi/scgi.scrbl&quot;)" x-source-pkg="scgi" x-part-tag="&quot;Legal&quot;">5<tt>&nbsp;</tt><a name="(part._.Legal)"></a>Legal</h3><p>Copyright 2010&ndash;2013, 2015, 2016 Neil Van Dyke.  This program is Free
Software; you can redistribute it and/or modify it under the terms of the GNU
Lesser General Public License as published by the Free Software Foundation;
either version 3 of the License, or (at your option) any later version.  This
program is distributed in the hope that it will be useful, but without any
warranty; without even the implied warranty of merchantability or fitness for a
particular purpose.  See http://www.gnu.org/licenses/ for details.  For other
licenses and consulting, please contact the author.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>