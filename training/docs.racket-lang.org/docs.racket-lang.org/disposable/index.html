<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Disposable Values</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Disposable Values</a></td></tr></table></div><div class="tocviewsublistonly" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Basic_Disposable_API_and_Concepts.html" class="tocviewlink" data-pltdoc="x">Basic Disposable API and Concepts</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Reusing_Disposables_with_Pools.html" class="tocviewlink" data-pltdoc="x">Reusing Disposables with Pools</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Transient_Values.html" class="tocviewlink" data-pltdoc="x">Transient Values</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="Batteries-Included_Disposables.html" class="tocviewlink" data-pltdoc="x">Batteries-<wbr></wbr>Included Disposables</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">Disposable Values</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<a href="Basic_Disposable_API_and_Concepts.html" title="forward to &quot;1 Basic Disposable API and Concepts&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h2 x-source-module="(lib &quot;disposable/scribblings/main.scrbl&quot;)" x-source-pkg="disposable" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.Disposable_.Values)"></a><a name="(mod-path._disposable)"></a>Disposable Values</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Jack Firth &lt;<a href="mailto:jackhfirth@gmail.com">jackhfirth@gmail.com</a>&gt;</p></span></div><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/disposable" title="Install this package using `raco pkg install disposable`"><span class="stt">disposable</span></a></span></td></tr></table></div><div class="SIntrapara"></div></p><p>This library defines <a href="Basic_Disposable_API_and_Concepts.html#%28tech._disposable%29" class="techoutside" data-pltdoc="x"><span class="techinside">disposables</span></a>, composable first-class
producers of values with associated external resources that must be allocated
and deallocated such as database connections. Several safe abstractions are
provided to consume disposable values while ensuring their associated resources
are deallocated after use.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">connect!</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-connection</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disconnect!</span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">close-connection</span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">disposable-connection</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Basic_Disposable_API_and_Concepts.html#%28def._%28%28lib._disposable%2Fmain..rkt%29._disposable%29%29" class="RktValLink" data-pltdoc="x">disposable</a></span><span class="hspace">&nbsp;</span><span class="RktSym">connect!</span><span class="hspace">&nbsp;</span><span class="RktSym">disconnect!</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="Basic_Disposable_API_and_Concepts.html#%28form._%28%28lib._disposable%2Fmain..rkt%29._with-disposable%29%29" class="RktStxLink" data-pltdoc="x">with-disposable</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktSym">disposable-connection</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">use</span><span class="hspace">&nbsp;</span><span class="RktSym">conn</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stx-patterns.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fstxcase-scheme..rkt%2529._......%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></table></blockquote><p>Source code for this library is avaible <a href="https://github.com/jackfirth/racket-disposable">on Github</a> and is
provided under the terms of the <a href="https://github.com/jackfirth/racket-disposable/blob/master/LICENSE">Apache License 2.0</a>.</p><p><span style="font-weight: bold">Warning!</span> This library is <span style="font-style: italic">experimental</span>; it may change in backwards
incompatible ways without notice. As such, now is the best time for feedback and
suggestions so feel free to open a repository issue or reach out to me directly.</p><p>This package provides several modules, all in the <a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable</span></a>
collection:</p><ul><li><p><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable</span></a> - A safe high-level interface to
<a href="Basic_Disposable_API_and_Concepts.html#%28tech._disposable%29" class="techoutside" data-pltdoc="x"><span class="techinside">disposables</span></a> along with combinators for extending and
composing them. Does not reprovide any of the modules listed below.</p></li><li><p><a href="Basic_Disposable_API_and_Concepts.html#%28mod-path._disposable%2Funsafe%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable/unsafe</span></a> - Unsafe low-level interface for
manually allocating and deallocating <a href="Basic_Disposable_API_and_Concepts.html#%28tech._disposable._value%29" class="techoutside" data-pltdoc="x"><span class="techinside">disposable values</span></a>.</p></li><li><p><a href="Batteries-Included_Disposables.html#%28mod-path._disposable%2Ffile%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable/file</span></a> - <a href="Basic_Disposable_API_and_Concepts.html#%28tech._disposable%29" class="techoutside" data-pltdoc="x"><span class="techinside">Disposables</span></a>
representing filesystem resources, such as temporary directories.</p></li><li><p><a href="Batteries-Included_Disposables.html#%28mod-path._disposable%2Ftesting%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable/testing</span></a> - Utilities for testing code that uses
<a href="Basic_Disposable_API_and_Concepts.html#%28tech._disposable%29" class="techoutside" data-pltdoc="x"><span class="techinside">disposables</span></a>.</p></li><li><p><a href="Batteries-Included_Disposables.html#%28mod-path._disposable%2Fexample%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">disposable/example</span></a> - Utilities for documenting
<a href="Basic_Disposable_API_and_Concepts.html#%28tech._disposable%29" class="techoutside" data-pltdoc="x"><span class="techinside">disposables</span></a> and using disposables in Scribble examples.</p></li></ul><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html" class="toptoclink" data-pltdoc="x">1<span class="hspace">&nbsp;</span>Basic Disposable API and Concepts</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Data_.Definition%29" class="toclink" data-pltdoc="x">1.1<span class="hspace">&nbsp;</span>Data Definition</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Consuming_.Disposable_.Values%29" class="toclink" data-pltdoc="x">1.2<span class="hspace">&nbsp;</span>Consuming Disposable Values</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Unsafe_.Allocation_of_.Disposables%29" class="toclink" data-pltdoc="x">1.3<span class="hspace">&nbsp;</span>Unsafe Allocation of Disposables</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Monadic_.Composition_of_.Disposables%29" class="toclink" data-pltdoc="x">1.4<span class="hspace">&nbsp;</span>Monadic Composition of Disposables</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Asynchronous_.Cleanup%29" class="toclink" data-pltdoc="x">1.5<span class="hspace">&nbsp;</span>Asynchronous Cleanup</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Disposables_with_.Associated_.Custodians%29" class="toclink" data-pltdoc="x">1.6<span class="hspace">&nbsp;</span>Disposables with Associated Custodians</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Basic_Disposable_API_and_Concepts.html#%28part._.Memoization_and_.Disposables%29" class="toclink" data-pltdoc="x">1.7<span class="hspace">&nbsp;</span>Memoization and Disposables</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Reusing_Disposables_with_Pools.html" class="toptoclink" data-pltdoc="x">2<span class="hspace">&nbsp;</span>Reusing Disposables with Pools</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Reusing_Disposables_with_Pools.html#%28part._gpvl%29" class="toclink" data-pltdoc="x">2.1<span class="hspace">&nbsp;</span>Global Pools with Virtual Leases</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Transient_Values.html" class="toptoclink" data-pltdoc="x">3<span class="hspace">&nbsp;</span>Transient Values</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Transient_Values.html#%28part._.Definition_and_.Construction%29" class="toclink" data-pltdoc="x">3.1<span class="hspace">&nbsp;</span>Definition and Construction</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Transient_Values.html#%28part._.Manipulating_.Transients%29" class="toclink" data-pltdoc="x">3.2<span class="hspace">&nbsp;</span>Manipulating Transients</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Batteries-Included_Disposables.html" class="toptoclink" data-pltdoc="x">4<span class="hspace">&nbsp;</span>Batteries-Included Disposables</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Batteries-Included_Disposables.html#%28part._.Filesystem_.Disposables%29" class="toclink" data-pltdoc="x">4.1<span class="hspace">&nbsp;</span>Filesystem Disposables</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Batteries-Included_Disposables.html#%28part._.Utilities_for_.Testing_.Disposables%29" class="toclink" data-pltdoc="x">4.2<span class="hspace">&nbsp;</span>Utilities for Testing Disposables</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="Batteries-Included_Disposables.html#%28part._.Example_.Disposables%29" class="toclink" data-pltdoc="x">4.3<span class="hspace">&nbsp;</span>Example Disposables</a></p></td></tr></table><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<a href="Basic_Disposable_API_and_Concepts.html" title="forward to &quot;1 Basic Disposable API and Concepts&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>