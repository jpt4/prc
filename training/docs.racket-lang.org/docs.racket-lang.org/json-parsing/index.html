<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>json-parsing: JSON Parsing, Folding, and Conversion</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">json-<wbr></wbr>parsing:<span class="mywbr"> &nbsp;</span> JSON Parsing, Folding, and Conversion</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Exceptions%29" class="tocviewlink" data-pltdoc="x">Exceptions</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Parse_.Fold%29" class="tocviewlink" data-pltdoc="x">Parse Fold</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.Conversion%29" class="tocviewlink" data-pltdoc="x">Conversion</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.History%29" class="tocviewlink" data-pltdoc="x">History</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._.Legal%29" class="tocviewlink" data-pltdoc="x">Legal</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">json-<wbr></wbr>parsing:<span class="mywbr"> &nbsp;</span> JSON Parsing, Folding, and Conversion</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Exceptions%29" class="tocsubseclink" data-pltdoc="x">Exceptions</a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._exn~3afail~3ainvalid-json~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>invalid-<wbr></wbr>json?</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._exn~3afail~3ainvalid-json-location%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>invalid-<wbr></wbr>json-<wbr></wbr>location</span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Parse_.Fold%29" class="tocsubseclink" data-pltdoc="x">Parse Fold</a></td></tr><tr><td><a href="#%28form._%28%28lib._json-parsing%2Fmain..rkt%29._json-fold-lambda%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>fold-<wbr></wbr>lambda</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._make-json-fold%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">make-<wbr></wbr>json-<wbr></wbr>fold</span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Conversion%29" class="tocsubseclink" data-pltdoc="x">Conversion</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.Conversion_to_.J.S.O.N%29" class="tocsubseclink" data-pltdoc="x">Conversion to JSON</a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-object-start%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>object-<wbr></wbr>start</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-object-end%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>object-<wbr></wbr>end</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-member-start%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>member-<wbr></wbr>start</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-member-end%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>member-<wbr></wbr>end</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-array-start%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>array-<wbr></wbr>start</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-array-end%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>array-<wbr></wbr>end</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-string%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>string</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-number%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>number</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-to-sjson-visit-constant%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>to-<wbr></wbr>sjson-<wbr></wbr>visit-<wbr></wbr>constant</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-~3esjson%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>&gt;sjson</span></a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.Conversion_to_.S.X.M.L%29" class="tocsubseclink" data-pltdoc="x">Conversion to SXML</a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-~3esxml%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>&gt;sxml</span></a></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._.Conversion_to_.X.M.L%29" class="tocsubseclink" data-pltdoc="x">Conversion to XML</a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._write-json-as-xml%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">write-<wbr></wbr>json-<wbr></wbr>as-<wbr></wbr>xml</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._json-parsing%2Fmain..rkt%29._json-~3exml%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>&gt;xml</span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.History%29" class="tocsubseclink" data-pltdoc="x">History</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Legal%29" class="tocsubseclink" data-pltdoc="x">Legal</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">3:2</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._json-parsing__.J.S.O.N_.Parsing__.Folding__and_.Conversion)"></a><a name="(mod-path._json-parsing)"></a>json-parsing: JSON Parsing, Folding, and Conversion</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Neil Van Dyke</p></span></div><p><div class="SIntrapara"></div><div class="SIntrapara">License: <a href="#%28part._.Legal%29" class="plainlink" data-pltdoc="x">LGPLv3</a> <span class="hspace">&nbsp;</span> Web: <a href="http://www.neilvandyke.org/racket/json-parsing/" class="plainlink">http://www.neilvandyke.org/racket/json-parsing/</a>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">json-parsing</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/json-parsing" title="Install this package using `raco pkg install json-parsing`"><span class="stt">json-parsing</span></a></span></td></tr></table></div></p><h3 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Introduction&quot;">1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p><div class="SIntrapara">The <span class="RktSym">json-parsing</span><span class="RktMeta"></span> package for Racket provides JSON parsing and format conversion
using a streaming tree fold.  This tree fold approach permits processing JSON
input of arbitrary size in relatively small space for some applications, unlike
the common approach of parsing the entire input to an AST before processing the
AST.</div><div class="SIntrapara">The supported JSON format is as specified on <a href="https://json.org/"><span class="url">http://json.org/</span></a>, as viewed on 2010-12-25.</div><div class="SIntrapara">The format converters in package include a convertor to <a name="(tech._sjson)"></a><span style="font-style: italic">SJSON</span> s-expression format.  SJSON has been made to be fully compatible
with the <span style="font-style: italic">jsexpr</span> of Dave Herman&rsquo;s PLaneT package <span class="RktSym">dherman/json:3:=0</span><span class="RktMeta"></span>.</div><div class="SIntrapara">The parser does not consume any characters not belonging to the
JSON value,and can be used to read multiple JSON values or to be intermixed
with other kinds of reading from the same input.</div><div class="SIntrapara">The tree fold approach of this package&rsquo;s parser was inspired and
informed by Oleg Kiselyov&rsquo;s <a href="http://okmij.org/ftp/Scheme/xml.html">SSAX</a> XML parsing work.</div><div class="SIntrapara">Implementing the <span class="RktSym">json-parsing</span><span class="RktMeta"></span> package was originally intended as an exercise for getting more
experience with SSAX-like folding, before undertaking some new XML packages,
but the JSON work has turned out useful in its own right.  A future version of
this package might also implement alternative tree fold approaches.</div></p><h3 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Exceptions&quot;">2<tt>&nbsp;</tt><a name="(part._.Exceptions)"></a>Exceptions</h3><p><div class="SIntrapara">When the parser encounters invalid JSON, it raises an <span class="RktSym">exn:fail:invalid-json</span> exception.  While this exception will be caught by
handlers such as <span class="RktSym">exn:fail?</span>, the distinct exception type permits
JSON-parsing errors to be handled separately from other errors, and it also
includes some location information.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._exn~3afail~3ainvalid-json~3f))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">exn:fail:invalid-json?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr></table></blockquote></div><div class="SIntrapara">Type predicate.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._exn~3afail~3ainvalid-json-location))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">exn:fail:invalid-json-location</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">exn</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">exact-positive-integer?</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">exact-nonnegative-integer?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">exact-positive-integer?</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">exn</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">exn:fail:invalid-json?</span></td></tr></table></blockquote></div><div class="SIntrapara">Gets information on the location of the error within the input
stream.  Currently, this is a list of three elements, of the three values
returned by Racket&rsquo;s <span class="RktSym">port-next-location</span> procedure.</div></p><h3 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Parse_Fold&quot;">3<tt>&nbsp;</tt><a name="(part._.Parse_.Fold)"></a>Parse Fold</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><table cellspacing="0" cellpadding="0" class="RktBlk RForeground"><tr><td><span class="RktPn">(</span><a name="(form._((lib._json-parsing/main..rkt)._json-fold-lambda))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-fold-lambda</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:error-name</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">error-name-symbol</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-object-start</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-object-start-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-object-end</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVar">visit-object-end-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-member-start</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-member-start-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-member-end</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVar">visit-member-end-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-array-start</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-array-start-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-array-end</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">visit-array-end-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-string</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">visit-string-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-number</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">visit-number-proc</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">#:visit-constant</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVar">visit-constant-proc</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Special syntax that expands to a JSON parser procedure.  Normally
you would use this if you were defining a new application of what processing
the parser should do while it is parsing JSON.  The resulting procedure of this
syntax has the arguments:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym">in</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="hspace">&nbsp;</span><span class="RktSym">exhaust?</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">where <span class="RktSym">in</span> is an input port or string, <span class="RktSym">seed</span> is a seed value,and <span class="RktSym">exhaust?</span> is whether or not to exhaustively consume all input and ensure
that there is no other non-JSON-whitespace.</div><div class="SIntrapara"><span class="RktSym">json-fold-lambda</span> has many arguments, all of which must be present. Here is an
example of how you might define a <span class="RktSym">my-json-to-sjson</span> procedure using <span class="RktSym">json-fold-lambda</span>:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">define</span><span class="hspace">&nbsp;</span><span class="RktSym">my-json-to-sjson</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">json-fold-lambda</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:error-name</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">my-json-to-sjson</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-object-start</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-hasheq</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-object-end</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">seed</span><span class="hspace">&nbsp;</span><span class="RktSym">parent-seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktSym">seed</span><span class="hspace">&nbsp;</span><span class="RktRdr">,@</span><span class="RktSym">parent-seed</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-member-start</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-member-end</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="hspace">&nbsp;</span><span class="RktSym">parent-seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hash-set!</span><span class="hspace">&nbsp;</span><span class="RktSym">parent-seed</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-&gt;symbol</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">car</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">parent-seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-array-start</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-array-end</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">seed</span><span class="hspace">&nbsp;</span><span class="RktSym">parent-seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">reverse</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">,@</span><span class="RktSym">parent-seed</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-string</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktRdr">,@</span><span class="RktSym">seed</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-number</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">num</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktSym">num</span><span class="hspace">&nbsp;</span><span class="RktRdr">,@</span><span class="RktSym">seed</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:visit-constant</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">seed</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">case</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">true</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">false</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">null</span><span class="RktPn">)</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#\nul</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">else</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">error</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">my-json-to-sjson</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"invalid constant ~S"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">name</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,@</span><span class="RktSym">seed</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">As you can see, the arguments provide a set of procedures that
are applied at various states in the parsing.  Each of these callback
procedures accepts at least one seed value from its preceding sibling and/or
parent, and it produces a seed value for the next sibling, child, or parent.</div><div class="SIntrapara">The concepts <a name="(tech._object)"></a><span style="font-style: italic">object</span>, <a name="(tech._member)"></a><span style="font-style: italic">member</span>, and <a name="(tech._array)"></a><span style="font-style: italic">array</span> are non-leaf nodes in the tree.  The <a name="(tech._start)"></a><span style="font-style: italic">start</span> callback for each non-leaf node receives a seed from its
preceding sibling, and the value it produces is the seed for its first child.
The <a name="(tech._end)"></a><span style="font-style: italic">end</span> callback receives both the seed from the last child, and the
parent seed (the sibling predecessor seed of the node; the same seed received
by the corresponding <a href="#%28tech._start%29" class="techoutside" data-pltdoc="x"><span class="techinside">start</span></a>).</div><div class="SIntrapara">The leaf nodes each simply receive a seed from the sibling
predecessor callback (or, if the first sibling, from the parent <a href="#%28tech._start%29" class="techoutside" data-pltdoc="x"><span class="techinside">start</span></a>; or, if the first callback, from the seed provided to the parser
call), and provide one to the sibling successor (or, if the last sibling, to
the parent <a href="#%28tech._end%29" class="techoutside" data-pltdoc="x"><span class="techinside">end</span></a>; or, if the last callback, to the result of the parser call).</div><div class="SIntrapara">Note that two different techniques are used above to build
collections of objects during processing, using seeds.  The first is to use a
hash that is passed in the seed, which in this case is used because SJSON
requires a hash as part of its format.  The second, and more common, is to
construct lists by incrementally consing onto the front of the list, so that
the list is ordred backwards, and waiting til the list is finished to put it in
correct order using the <span class="RktSym">reverse</span> procedure.</div><div class="SIntrapara">The parser procedure returns either the value of the last
callback, or, if the end of the input is reached without a JSON value, the <span class="RktSym">eof-object</span><span class="RktMeta"></span>.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._make-json-fold))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">make-json-fold</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:error-name</span><span class="hspace">&nbsp;</span><span class="RktVar">error-name</span>]</td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-object-start</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-object-start</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-object-end</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-object-end</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-member-start</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-member-start</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-member-end</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-member-end</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-array-start</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-array-start</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-array-end</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-array-end</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-string</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-string</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-number</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-number</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:visit-constant</span><span class="hspace">&nbsp;</span><span class="RktVar">visit-constant</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span>*</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">input-port?</span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">#:exhaust?</span><span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">error-name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">&lt;make-json-fold&gt;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-object-start</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-object-end</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-member-start</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-member-end</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-array-start</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-array-end</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-string</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-number</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">number?</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">visit-constant</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="nobreak">-&gt;</span></span><span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This is like <span class="RktSym">json-fold-lambda</span>, except it is a procedure, rather than syntax.  <span class="RktSym">make-json-fold</span> can be used in the less-common case that you need to define a
new parser dynamically.</div><div class="SIntrapara">Note that, in the produced procedure, the <span class="RktSym">exhaust?</span> argument is optional (defaulting to <span class="RktVal">#t</span>).</div></p><h3 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Conversion&quot;">4<tt>&nbsp;</tt><a name="(part._.Conversion)"></a>Conversion</h3><h4 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Conversion_to_JSON&quot;">4.1<tt>&nbsp;</tt><a name="(part._.Conversion_to_.J.S.O.N)"></a>Conversion to JSON</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-object-start))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-object-start</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">seed</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-object-end))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-object-end</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">seed</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">parent-seed</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">any/c</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">parent-seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-member-start))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-member-start</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">name</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">seed</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">any/c</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-member-end))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-member-end</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">name</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">seed</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">parent-seed</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">any/c</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">parent-seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-array-start))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-array-start</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">seed</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-array-end))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-array-end</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">seed</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">parent-seed</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">any/c</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">parent-seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-string))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-string</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">str</span><span class="hspace">&nbsp;</span><span class="RktVar">seed</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">str</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-number))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-number</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">num</span><span class="hspace">&nbsp;</span><span class="RktVar">seed</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">num</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">number?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-to-sjson-visit-constant))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-to-sjson-visit-constant</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span><span class="RktVar">seed</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seed</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr></table></blockquote></div><div class="SIntrapara">Fold visitor procedures used by <span class="RktSym">json-&gt;sjson</span>.  May also be used by other fold definitions.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-~3esjson))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-&gt;sjson</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:exhaust?</span><span class="hspace">&nbsp;</span><span class="RktVar">exhaust?</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">sjson?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">input-port?</span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">exhaust?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></blockquote></div><div class="SIntrapara">Parse a JSON value from input port or string <span class="RktVar">in</span>, and return an <a href="#%28tech._sjson%29" class="techoutside" data-pltdoc="x"><span class="techinside">SJSON</span></a> parsed representation.</div></p><h4 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Conversion_to_SXML&quot;">4.2<tt>&nbsp;</tt><a name="(part._.Conversion_to_.S.X.M.L)"></a>Conversion to SXML</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-~3esxml))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-&gt;sxml</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:exhaust?</span><span class="hspace">&nbsp;</span><span class="RktVar">exhaust?</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">sxml/xexp?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">input-port?</span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">exhaust?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></blockquote></div><div class="SIntrapara">Parse the JSON input from input port or string <span class="RktVar">in</span>, and return in a contrived XML data format that can be processed
with various SXML tools.</div></p><h4 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Conversion_to_XML&quot;">4.3<tt>&nbsp;</tt><a name="(part._.Conversion_to_.X.M.L)"></a>Conversion to XML</h4><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._write-json-as-xml))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">write-json-as-xml</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">in</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:exhaust?</span><span class="hspace">&nbsp;</span><span class="RktVar">exhaust?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:out</span><span class="hspace">&nbsp;</span><span class="RktVar">out</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">void?</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">input-port?</span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">exhaust?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">out</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">output-port?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">current-output-port</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Parse the JSON input from input port or string <span class="RktVar">in</span>, and write it in contrived XML data format to output port <span class="RktVar">out</span> (which defaults to the value of the <span class="RktSym">current-output-port</span> parameter).  This is mainly a demonstration of &ldquo;streaming&rdquo;
processing that can scale to arbitrary JSON input sizes.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._json-parsing/main..rkt)._json-~3exml))"></a><span title="Provided from: json-parsing | Package: json-parsing"><span class="RktSym"><span class="RktSymDef RktSym">json-&gt;xml</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:exhaust?</span><span class="hspace">&nbsp;</span><span class="RktVar">exhaust?</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">string?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">in</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">input-port?</span><span class="hspace">&nbsp;</span><span class="RktSym">string?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">exhaust?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#t</span></td></tr></table></blockquote></div><div class="SIntrapara">This is like <span class="RktSym">write-json-as-xml</span>, but instead of writing to a port, it returns the XML as a string.
Most people would not choose to do this.</div></p><h3 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;History&quot;">5<tt>&nbsp;</tt><a name="(part._.History)"></a>History</h3><ul><li><p><div class="SIntrapara">Version 3:2 &#8212;<wbr></wbr> 2016-03-02</div><div class="SIntrapara"><ul><li><p>Tweaked info.rkt, filenames.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 3:1 &#8212;<wbr></wbr> 2016-02-25</div><div class="SIntrapara"><ul><li><p>Fixed deps.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 3:0 &#8212;<wbr></wbr> 2016-02-21</div><div class="SIntrapara"><ul><li><p>Moving from PLaneT to new package system.</p></li><li><p>Moved unit tests to main source file.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:0 &#8212;<wbr></wbr> 2012-06-13</div><div class="SIntrapara"><ul><li><p>Converted to McFly and Overeasy.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.3 &#8212;<wbr></wbr> Version 1:2 &#8212;<wbr></wbr> 2011-08-22</div><div class="SIntrapara"><ul><li><p>Added <span class="RktSym">json-to-sjson-visit-</span> procedures.</p></li><li><p>Documentation fix.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.2 &#8212;<wbr></wbr> Version 1:1 &#8212;<wbr></wbr> 2010-12-27</div><div class="SIntrapara"><ul><li><p>Added missing export.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 0.1 &#8212;<wbr></wbr> Version 1:0 &#8212;<wbr></wbr> 2010-12-26</div><div class="SIntrapara"><ul><li><p>Initial release.</p></li></ul></div></p></li></ul><h3 x-source-module="(lib &quot;json-parsing/json-parsing.scrbl&quot;)" x-source-pkg="json-parsing" x-part-tag="&quot;Legal&quot;">6<tt>&nbsp;</tt><a name="(part._.Legal)"></a>Legal</h3><p>Copyright 2010&ndash;2012, 2016 Neil Van Dyke.  This program is Free Software; you
can redistribute it and/or modify it under the terms of the GNU Lesser General
Public License as published by the Free Software Foundation; either version 3
of the License, or (at your option) any later version.  This program is
distributed in the hope that it will be useful, but without any warranty;
without even the implied warranty of merchantability or fitness for a
particular purpose.  See http://www.gnu.org/licenses/ for details.  For other
licenses and consulting, please contact the author.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>