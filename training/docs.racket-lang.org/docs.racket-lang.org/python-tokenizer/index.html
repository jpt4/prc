<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>python-tokenizer: a translation of Python's tokenize.py library for Racket</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">python-<wbr></wbr>tokenizer:<span class="mywbr"> &nbsp;</span> a translation of Python&rsquo;s <span class="stt">tokenize.py</span> library for Racket</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.A.P.I%29" class="tocviewlink" data-pltdoc="x">API</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Translator_comments%29" class="tocviewlink" data-pltdoc="x">Translator comments</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Release_history%29" class="tocviewlink" data-pltdoc="x">Release history</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">python-<wbr></wbr>tokenizer:<span class="mywbr"> &nbsp;</span> a translation of Python&rsquo;s <span class="stt">tokenize.py</span> library for Racket</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.A.P.I%29" class="tocsubseclink" data-pltdoc="x">API</a></td></tr><tr><td><a href="#%28def._%28%28lib._python-tokenizer%2Fmain..rkt%29._generate-tokens%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">generate-<wbr></wbr>tokens</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._python-tokenizer%2Fmain..rkt%29._exn~3afail~3atoken%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>token</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._python-tokenizer%2Fmain..rkt%29._exn~3afail~3aindentation%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>indentation</span></a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Translator_comments%29" class="tocsubseclink" data-pltdoc="x">Translator comments</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Release_history%29" class="tocsubseclink" data-pltdoc="x">Release history</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;python-tokenizer/python-tokenizer.scrbl&quot;)" x-source-pkg="python-tokenizer" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._python-tokenizer__a_translation_of_.Python_s_tokenize_py_library_for_.Racket)"></a>python-tokenizer: a translation of Python&rsquo;s <span class="stt">tokenize.py</span> library for Racket</h2><p>Danny Yoo &lt;<a href="mailto:dyoo@hashcollision.org">dyoo@hashcollision.org</a>&gt;</p><p>This is a fairly close translation of the
<a href="https://hg.python.org/cpython/file/2.7/Lib/tokenize.py"><span class="stt">tokenize.py</span></a>
library from <a href="https://python.org">Python</a>.</p><p>The main function, <span class="RktSym">generate-tokens</span>, consumes an input port
and produces a sequence of tokens.</p><p>For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">python-tokenizer</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sample-input</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=stringport.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._open-input-string%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">open-input-string</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"def d22(a, b, c=2, d=2, *k): pass"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">generate-tokens</span><span class="hspace">&nbsp;</span><span class="RktSym">sample-input</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=for.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._for%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">for</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">tokens</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=Writing.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._printf%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~s ~s ~s ~s\n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">first</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">second</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">third</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fourth</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktOut">NAME "def" (1 0) (1 3)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "d22" (1 4) (1 7)</span></p></td></tr><tr><td><p><span class="RktOut">OP "(" (1 7) (1 8)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "a" (1 8) (1 9)</span></p></td></tr><tr><td><p><span class="RktOut">OP "," (1 9) (1 10)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "b" (1 11) (1 12)</span></p></td></tr><tr><td><p><span class="RktOut">OP "," (1 12) (1 13)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "c" (1 14) (1 15)</span></p></td></tr><tr><td><p><span class="RktOut">OP "=" (1 15) (1 16)</span></p></td></tr><tr><td><p><span class="RktOut">NUMBER "2" (1 16) (1 17)</span></p></td></tr><tr><td><p><span class="RktOut">OP "," (1 17) (1 18)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "d" (1 19) (1 20)</span></p></td></tr><tr><td><p><span class="RktOut">OP "=" (1 20) (1 21)</span></p></td></tr><tr><td><p><span class="RktOut">NUMBER "2" (1 21) (1 22)</span></p></td></tr><tr><td><p><span class="RktOut">OP "," (1 22) (1 23)</span></p></td></tr><tr><td><p><span class="RktOut">OP "*" (1 24) (1 25)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "k" (1 25) (1 26)</span></p></td></tr><tr><td><p><span class="RktOut">OP ")" (1 26) (1 27)</span></p></td></tr><tr><td><p><span class="RktOut">OP ":" (1 27) (1 28)</span></p></td></tr><tr><td><p><span class="RktOut">NAME "pass" (1 29) (1 33)</span></p></td></tr><tr><td><p><span class="RktOut">ENDMARKER "" (2 0) (2 0)</span></p></td></tr></table></td></tr></table></blockquote><h3 x-source-module="(lib &quot;python-tokenizer/python-tokenizer.scrbl&quot;)" x-source-pkg="python-tokenizer" x-part-tag="&quot;API&quot;">1<tt>&nbsp;</tt><a name="(part._.A.P.I)"></a><a name="(mod-path._python-tokenizer)"></a>API</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._python-tokenizer%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">python-tokenizer</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/python-tokenizer" title="Install this package using `raco pkg install python-tokenizer`"><span class="stt">python-tokenizer</span></a></span></td></tr></table></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._python-tokenizer/main..rkt)._generate-tokens))"></a><span title="Provided from: python-tokenizer | Package: python-tokenizer"><span class="RktSym"><span class="RktSymDef RktSym">generate-tokens</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">inp</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sequenceof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=symbols.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._symbol%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._number%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">number?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">inp</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">input-port</span></td></tr></table></blockquote></div><div class="SIntrapara">Consumes an input port and produces a sequence of tokens.</div></p><p><div class="SIntrapara">Each token is a 5-tuple consisting of:
</div><div class="SIntrapara"><ol><li><p>token-type: one of the following symbols:
<span class="RktVal">'</span><span class="RktVal">NAME</span>, <span class="RktVal">'</span><span class="RktVal">NUMBER</span>, <span class="RktVal">'</span><span class="RktVal">STRING</span>,
<span class="RktVal">'</span><span class="RktVal">OP</span>, <span class="RktVal">'</span><span class="RktVal">COMMENT</span>, <span class="RktVal">'</span><span class="RktVal">NL</span>,
<span class="RktVal">'</span><span class="RktVal">NEWLINE</span>, <span class="RktVal">'</span><span class="RktVal">DEDENT</span>, <span class="RktVal">'</span><span class="RktVal">INDENT</span>,
<span class="RktVal">'</span><span class="RktVal">ERRORTOKEN</span>, or <span class="RktVal">'</span><span class="RktVal">ENDMARKER</span>.  The only difference between
<span class="RktVal">'</span><span class="RktVal">NEWLINE</span> and <span class="RktVal">'</span><span class="RktVal">NL</span> is that <span class="RktVal">'</span><span class="RktVal">NEWLINE</span> will only occurs
if the indentation level is at <span class="RktVal">0</span>.</p></li><li><p>text: the string content of the token.</p></li><li><p>start-pos: the line and column as a list of two numbers</p></li><li><p>end-pos: the line and column as a list of two numbers</p></li><li><p>current-line: the current line that the tokenizer is on</p></li></ol></div></p><p>The last token produced, under normal circumstances, will be
<span class="RktVal">'</span><span class="RktVal">ENDMARKER</span>.</p><p>If a recoverable error occurs, <span class="RktSym">generate-tokens</span> will produce
single-character tokens with the <span class="RktVal">'</span><span class="RktVal">ERRORTOKEN</span> type until it
can recover.</p><p>Unrecoverable errors occur when the tokenizer encounters <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">eof</a></span>
in the middle of a multi-line string or statement, or if an
indentation level is inconsistent.  On an unrecoverable error,
<span class="RktSym">generate-tokesn</span> will raise an <span class="RktSym">exn:fail:token</span> or
<span class="RktSym">exn:fail:indentation</span> error.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._python-tokenizer/main..rkt)._exn~3afail~3atoken-loc))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._make-exn~3afail~3atoken))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._exn~3afail~3atoken~3f))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._struct~3aexn~3afail~3atoken))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._exn~3afail~3atoken))"></a><span title="Provided from: python-tokenizer | Package: python-tokenizer"><span class="RktSym"><span class="RktSymDef RktSym">exn:fail:token</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exn:fail</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loc</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-exn:fail:token</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">loc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktSym">number</span><span class="hspace">&nbsp;</span><span class="RktSym">number</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Raised when <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=port-ops.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._eof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">eof</a></span> is unexpectedly encounted.
<span class="RktSym">exn:fail:token-loc</span> holds the start position.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._python-tokenizer/main..rkt)._exn~3afail~3aindentation-loc))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._make-exn~3afail~3aindentation))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._exn~3afail~3aindentation~3f))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._struct~3aexn~3afail~3aindentation))"></a><a name="(def._((lib._python-tokenizer/main..rkt)._exn~3afail~3aindentation))"></a><span title="Provided from: python-tokenizer | Package: python-tokenizer"><span class="RktSym"><span class="RktSymDef RktSym">exn:fail:indentation</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exn:fail</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loc</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-exn:fail:indentation</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">loc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list/c</span><span class="hspace">&nbsp;</span><span class="RktSym">number</span><span class="hspace">&nbsp;</span><span class="RktSym">number</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Raised when the indentation is inconsistent.
<span class="RktSym">exn:fail:indentation-loc</span> holds the start position.</div></p><h3 x-source-module="(lib &quot;python-tokenizer/python-tokenizer.scrbl&quot;)" x-source-pkg="python-tokenizer" x-part-tag="&quot;Translator_comments&quot;">2<tt>&nbsp;</tt><a name="(part._.Translator_comments)"></a>Translator comments</h3><p>The translation is a fairly direct one; I wrote an
<a href="https://github.com/dyoo/while-loop">auxiliary package</a> to deal
with the <span class="RktSym">while</span> loops, which proved invaluable during the
translation of the code.  It may be instructive to compare the
<a href="https://github.com/jbclements/python-tokenizer/blob/master/python-tokenizer/python-tokenizer.rkt">source</a>
here to that of
<a href="https://hg.python.org/cpython/file/2.7/Lib/tokenize.py">tokenize.py</a>.</p><p>Here are some points I observed while doing the translation:</p><ul><li><p>Mutation pervades the entirety of the tokenizer&rsquo;s main loop.
The main reason is because <span class="RktSym">while</span> has no return type and
doesn&rsquo;t carry variables around; the <span class="RktSym">while</span> loop communicates
values from one part of the code to others through mutation, often in
wildly distant locations.</p></li><li><p>Racket makes a syntactic distinction between variable definition
(<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._define%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">define</a></span>) and mutation (<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=set_.html%23%2528form._%2528%2528quote._%7E23%7E25kernel%2529._set%2521%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">set!</a></span>).  I&rsquo;ve had to deduce
which variables were intended to be temporaries, and hopefully I
haven&rsquo;t induced any errors along the way.</p></li><li><p>In some cases, Racket has finer-grained type distinctions than
Python.  Python does not use a separate type to represent individual
characters, and instead uses a length-1 string.  In this translation,
I&rsquo;ve used characters where I think they&rsquo;re appropriate.</p></li><li><p>Most uses of raw strings in Python can be translated to
uses of the
<a href="https://docs.racket-lang.org/scribble/reader-internals.html#(mod-path._at-exp)">at-exp</a>
reader.</p></li><li><p>Generators in Racket and in Python are pretty similar, though
the Racket documentation can do a better job in documenting them.</p><p>When dealing with generators in Racket, what one really wants to
usually produce is a generic sequence.  For that reason, the
Racket documentation really needs to place more emphasis in
<span class="RktSym">in-generator</span>, not the raw <span class="RktSym">generator</span> form.</p></li><li><p>Python heavily overloads the <span class="stt">in</span> operator.  Its expressivity
makes it easy to write code with it.  On the flip side, its
flexibility makes it a little harder to know what it actually means.</p></li><li><p>Regular expressions, on the whole, match
well between the two
languages.  Minor differences in the syntax are potholes: Racket&rsquo;s
regular expression matcher does not have an implicit <span style="font-style: italic">begin</span>
anchor, and Racket&rsquo;s regexps are more sensitive to escape characters.</p><p>Python&rsquo;s regexp engine returns a single match object that can support
different operators.  Racket, on the other hand, requires the user to
select between getting the position of the match, with
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=regexp.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._regexp-match-positions%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">regexp-match-positions</a></span>, or getting the textual content with
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=regexp.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._regexp-match%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">regexp-match</a></span>.</p></li></ul><h3 x-source-module="(lib &quot;python-tokenizer/python-tokenizer.scrbl&quot;)" x-source-pkg="python-tokenizer" x-part-tag="&quot;Release_history&quot;">3<tt>&nbsp;</tt><a name="(part._.Release_history)"></a>Release history</h3><ul><li><p>1.0 (2012-02-29): Initial release.</p></li><li><p>1.1 (2012-09-10): Bug fix.  Corrected an infinite-loop bug due to mis-typing a paren.  Thanks to Joe Politz for the bug report!</p></li></ul><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>