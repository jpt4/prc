<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>nat-traversal</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">nat-<wbr></wbr>traversal</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.How_to_use_the_library%29" class="tocviewlink" data-pltdoc="x">How to use the library</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.References%29" class="tocviewlink" data-pltdoc="x">References</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">nat-<wbr></wbr>traversal</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.How_to_use_the_library%29" class="tocsubseclink" data-pltdoc="x">How to use the library</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._.The_.High-.Level_.Interface%29" class="tocsubseclink" data-pltdoc="x">The High-<wbr></wbr>Level Interface</a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._udp-bind%21%2Fpublic%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">udp-<wbr></wbr>bind!/<span class="mywbr"> &nbsp;</span>public</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._tcp-listen%2Fpublic%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">tcp-<wbr></wbr>listen/<span class="mywbr"> &nbsp;</span>public</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">mapping-<wbr></wbr>change-<wbr></wbr>listener</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">mapping-<wbr></wbr>change-<wbr></wbr>listener</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">port-<wbr></wbr>assignment</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener-current-mappings%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">mapping-<wbr></wbr>change-<wbr></wbr>listener-<wbr></wbr>current-<wbr></wbr>mappings</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener-stop%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">mapping-<wbr></wbr>change-<wbr></wbr>listener-<wbr></wbr>stop!</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._.Getting_information_on_local_gateways_and_interfaces%29" class="tocsubseclink" data-pltdoc="x">Getting information on local gateways and interfaces</a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._gateway-ip-address%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">gateway-<wbr></wbr>ip-<wbr></wbr>address</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._interface-ip-addresses%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">interface-<wbr></wbr>ip-<wbr></wbr>addresses</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._best-interface-ip-address%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">best-<wbr></wbr>interface-<wbr></wbr>ip-<wbr></wbr>address</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._wildcard-ip-address~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">wildcard-<wbr></wbr>ip-<wbr></wbr>address?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._localhost-ip-address~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">localhost-<wbr></wbr>ip-<wbr></wbr>address?</span></span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._private-ip-address~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktValLink">private-<wbr></wbr>ip-<wbr></wbr>address?</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._.Low-level_interfaces%29" class="tocsubseclink" data-pltdoc="x">Low-<wbr></wbr>level interfaces</a></td></tr><tr><td><span class="tocsublinknumber">2.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Records_of_established_mappings%29" class="tocsubseclink" data-pltdoc="x">Records of established mappings</a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">mapping</span></a></td></tr><tr><td><span class="tocsublinknumber">2.3.2<tt>&nbsp;</tt></span><a href="#%28part._.N.A.T-.P.M.P%29" class="tocsubseclink" data-pltdoc="x">NAT-<wbr></wbr>PMP</a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._nat-pmp-external-ip-address%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">nat-<wbr></wbr>pmp-<wbr></wbr>external-<wbr></wbr>ip-<wbr></wbr>address</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._nat-pmp-make-persistent-mapping%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">nat-<wbr></wbr>pmp-<wbr></wbr>make-<wbr></wbr>persistent-<wbr></wbr>mapping</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._nat-pmp-map-port%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">nat-<wbr></wbr>pmp-<wbr></wbr>map-<wbr></wbr>port!</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._nat-pmp-unmap-all-ports%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">nat-<wbr></wbr>pmp-<wbr></wbr>unmap-<wbr></wbr>all-<wbr></wbr>ports!</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._nat-pmp-refresh-mapping%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">nat-<wbr></wbr>pmp-<wbr></wbr>refresh-<wbr></wbr>mapping!</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._nat-pmp-delete-mapping%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">nat-<wbr></wbr>pmp-<wbr></wbr>delete-<wbr></wbr>mapping!</span></a></td></tr><tr><td><span class="tocsublinknumber">2.3.3<tt>&nbsp;</tt></span><a href="#%28part._.U.Pn.P%29" class="tocsubseclink" data-pltdoc="x">UPn<span class="mywbr"> &nbsp;</span>P</a></td></tr><tr><td><span class="tocsublinknumber">2.3.4<tt>&nbsp;</tt></span><a href="#%28part._.Managing_low-level_persistent_mappings%29" class="tocsubseclink" data-pltdoc="x">Managing low-<wbr></wbr>level persistent mappings</a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._stop-persistent-mapping%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">stop-<wbr></wbr>persistent-<wbr></wbr>mapping!</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._current-persistent-mapping%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">current-<wbr></wbr>persistent-<wbr></wbr>mapping</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._refresh-persistent-mapping%21%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">refresh-<wbr></wbr>persistent-<wbr></wbr>mapping!</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._persistent-mapping%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">persistent-<wbr></wbr>mapping</span></a></td></tr><tr><td><span class="tocsublinknumber">2.3.5<tt>&nbsp;</tt></span><a href="#%28part._.Calling_other_.U.Pn.P_services%29" class="tocsubseclink" data-pltdoc="x">Calling other UPn<span class="mywbr"> &nbsp;</span>P services</a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._default-scan-time%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">default-<wbr></wbr>scan-<wbr></wbr>time</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._exn~3afail~3aupnp%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>upnp</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._exn~3afail~3aupnp~3f%2Fcode%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">exn:<span class="mywbr"> &nbsp;</span>fail:<span class="mywbr"> &nbsp;</span>upnp?/<span class="mywbr"> &nbsp;</span>code</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._upnp-service%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">upnp-<wbr></wbr>service</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._upnp-service-action%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">upnp-<wbr></wbr>service-<wbr></wbr>action</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._in-upnp-services%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">in-<wbr></wbr>upnp-<wbr></wbr>services</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._upnp-service-type~3d~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">upnp-<wbr></wbr>service-<wbr></wbr>type=?</span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.References%29" class="tocsubseclink" data-pltdoc="x">References</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._nat-traversal)"></a>nat-traversal</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Tony Garnock-Jones &lt;<a href="mailto:tonygarnockjones@gmail.com">tonygarnockjones@gmail.com</a>&gt;</p></span></div><p>If you find that this library lacks some feature you need, or you have
a suggestion for improving it, please don&rsquo;t hesitate to
<a href="mailto:tonygarnockjones@gmail.com">get in touch with me</a>!</p><h3 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;Introduction&quot;">1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p>Using this library, you can discover the external IP address of your
home router, and can manage port mappings from the public internet to
internal TCP and UDP ports.</p><p>The library implements</p><ul><li><p>NAT-PMP, the Apple/IETF protocol for opening TCP and UDP ports
on home routers, and</p></li><li><p>UPnP, in particular the "WANIPConnection" service, the
Microsoft et al. protocol for doing the same, plus a whole lot
more.</p></li></ul><p>It provides both a low-level interface to each of the two protocols as
well as a high-level interface that abstracts away from the details of
the particular NAT traversal techniques available.</p><h3 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;How_to_use_the_library&quot;">2<tt>&nbsp;</tt><a name="(part._.How_to_use_the_library)"></a><a name="(mod-path._nat-traversal)"></a>How to use the library</h3><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="#%28mod-path._nat-traversal%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">nat-traversal</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/nat-traversal" title="Install this package using `raco pkg install nat-traversal`"><span class="stt">nat-traversal</span></a></span></td></tr></table></p><h4 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;The_High-Level_Interface&quot;">2.1<tt>&nbsp;</tt><a name="(part._.The_.High-.Level_.Interface)"></a>The High-Level Interface</h4><p>The high-level interface to the library lets you automatically manage
NAT port mappings by simply changing calls to <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=udp.html%23%2528def._%2528%2528lib._racket%252Fudp..rkt%2529._udp-bind%2521%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">udp-bind!</a></span> and
<span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=tcp.html%23%2528def._%2528%2528lib._racket%252Ftcp..rkt%2529._tcp-listen%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">tcp-listen</a></span> to <span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._udp-bind%21%2Fpublic%29%29" class="RktValLink" data-pltdoc="x">udp-bind!/public</a></span> and
<span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._tcp-listen%2Fpublic%29%29" class="RktValLink" data-pltdoc="x">tcp-listen/public</a></span>, respectively.</p><p>Each socket managed by the library is associated with a
<span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener</a></span>, a background thread that tracks
changes to the NAT configuration, keeping a set of "port assignments"
up-to-date. A user-supplied callback (<span class="stt">on-mapping-change</span>) is
called every time the port assignment set changes.</p><p>Each port assignment in a set is an address at which the corresponding
socket is reachable. A set of port assignments includes both local
(internal to the NAT) and public (external to the NAT) addresses.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._udp-bind!/public))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._udp-bind%21%2Fpublic%29%29" class="RktValDef RktValLink" data-pltdoc="x">udp-bind!/public</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">udp-socket</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">hostname-string</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">port-no</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:on-mapping-change</span><span class="hspace">&nbsp;</span><span class="RktVar">on-mapping-change</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener~3f%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">udp-socket</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=udp.html%23%2528def._%2528%2528lib._racket%252Fudp..rkt%2529._udp%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">udp?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">hostname-string</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">port-no</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._and%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._integer-in%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer-in</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">65535</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">on-mapping-change</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=sets.html%23%2528def._%2528%2528lib._racket%252Fset..rkt%2529._set%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">set/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment~3f%29%29" class="RktValLink" data-pltdoc="x">port-assignment?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Does the work of <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=udp.html%23%2528def._%2528%2528lib._racket%252Fudp..rkt%2529._udp-bind%2521%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">udp-bind!</a></span>, and opens and starts managing a
UDP port mapping at the local NAT.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._tcp-listen/public))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._tcp-listen%2Fpublic%29%29" class="RktValDef RktValLink" data-pltdoc="x">tcp-listen/public</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">port-no</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktVar">max-allow-wait</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">reuse?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">hostname</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:on-mapping-change</span><span class="hspace">&nbsp;</span><span class="RktVar">on-mapping-change</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0"><tr><td><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=tcp.html%23%2528def._%2528%2528lib._racket%252Ftcp..rkt%2529._tcp-listener%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">tcp-listener?</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener~3f%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener?</a></span></td></tr></table></td></tr></table></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">port-no</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._and%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._integer-in%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer-in</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">65535</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">max-allow-wait</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">4</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">reuse?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">hostname</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">on-mapping-change</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=sets.html%23%2528def._%2528%2528lib._racket%252Fset..rkt%2529._set%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">set/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment~3f%29%29" class="RktValLink" data-pltdoc="x">port-assignment?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Does the work of <span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=tcp.html%23%2528def._%2528%2528lib._racket%252Ftcp..rkt%2529._tcp-listen%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">tcp-listen</a></span>, and opens and starts managing a
     TCP port mapping at the local NAT.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._mapping-change-listener))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener%29%29" class="RktValDef RktValLink" data-pltdoc="x">mapping-change-listener</a></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">protocol</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">initial-local-address</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">local-port</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">on-mapping-change</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener~3f%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">tcp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">udp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">initial-local-address</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">local-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._integer-in%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer-in</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">65535</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">on-mapping-change</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=sets.html%23%2528def._%2528%2528lib._racket%252Fset..rkt%2529._set%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">set/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment~3f%29%29" class="RktValLink" data-pltdoc="x">port-assignment?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Opens and starts managing a TCP or UDP port mapping at the local NAT
for the given port. This routine is the workhorse that both
<span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._udp-bind%21%2Fpublic%29%29" class="RktValLink" data-pltdoc="x">udp-bind!/public</a></span> and <span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._tcp-listen%2Fpublic%29%29" class="RktValLink" data-pltdoc="x">tcp-listen/public</a></span> delegate to.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._nat-traversal/main..rkt)._mapping-change-listener-thread))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping-change-listener~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3amapping-change-listener))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping-change-listener))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener%29%29" class="RktValDef RktValLink" data-pltdoc="x">mapping-change-listener</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">thread</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:prefab</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">thread</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=threads.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._thread%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">thread?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Handle for a mapping change listener. Useful with
<span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener-stop%21%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener-stop!</a></span> and so forth.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._nat-traversal/main..rkt)._port-assignment-nat-traversal-technique))"></a><a name="(def._((lib._nat-traversal/main..rkt)._port-assignment-port))"></a><a name="(def._((lib._nat-traversal/main..rkt)._port-assignment-address))"></a><a name="(def._((lib._nat-traversal/main..rkt)._port-assignment-protocol))"></a><a name="(def._((lib._nat-traversal/main..rkt)._port-assignment~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3aport-assignment))"></a><a name="(def._((lib._nat-traversal/main..rkt)._port-assignment))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment%29%29" class="RktValDef RktValLink" data-pltdoc="x">port-assignment</a></span></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">protocol</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">address</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">port</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">nat-traversal-technique</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:prefab</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">udp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">tcp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">address</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">nat-traversal-technique</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">nat-pmp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">upnp</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Record of a particular name for a socket. The protocol, address, and
port together form a name that can be used by remote peers to contact
the socket. The <span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment-nat-traversal-technique%29%29" class="RktValLink" data-pltdoc="x">port-assignment-nat-traversal-technique</a></span> field
is <span class="RktVal">'</span><span class="RktVal">nat-pmp</span> or <span class="RktVal">'</span><span class="RktVal">upnp</span> for a NAT-originated name, or
<span class="RktVal">#f</span> for a local interface name (i.e., built from the results
of <span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._interface-ip-addresses%29%29" class="RktValLink" data-pltdoc="x">interface-ip-addresses</a></span>).</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._mapping-change-listener-current-mappings))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener-current-mappings%29%29" class="RktValDef RktValLink" data-pltdoc="x">mapping-change-listener-current-mappings</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">mcl</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=sets.html%23%2528def._%2528%2528lib._racket%252Fset..rkt%2529._set%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">set/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._port-assignment~3f%29%29" class="RktValLink" data-pltdoc="x">port-assignment?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mcl</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener~3f%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Retrieves the current set of port assignments from the given change
listener. May be useful instead of or in addition to using
<span class="stt">on-mapping-change</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._mapping-change-listener-stop!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener-stop%21%29%29" class="RktValDef RktValLink" data-pltdoc="x">mapping-change-listener-stop!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">mcl</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mcl</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._mapping-change-listener~3f%29%29" class="RktValLink" data-pltdoc="x">mapping-change-listener?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Deletes any active NAT mappings, and stops the background thread
involved in a mapping change listener. Call this while or after
closing the associated socket.</div></p><h4 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;Getting_information_on_local_gateways_and_interfaces&quot;">2.2<tt>&nbsp;</tt><a name="(part._.Getting_information_on_local_gateways_and_interfaces)"></a>Getting information on local gateways and interfaces</h4><p>This library provides utilities for discovering and classifying
interface IP addresses, and for discovering the local default gateway
IP.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._gateway-ip-address))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._gateway-ip-address%29%29" class="RktValDef RktValLink" data-pltdoc="x">gateway-ip-address</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Retrieves a string representation of the current default gateway IP
address, for example <span class="RktVal">"10.0.0.1"</span>. Currently, this library
learns this information by running the system utility <span class="stt">netstat</span> and
parsing its output.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._interface-ip-addresses))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._interface-ip-addresses%29%29" class="RktValDef RktValLink" data-pltdoc="x">interface-ip-addresses</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Retrieves a list of string representations of the IP addresses
associated with the system&rsquo;s currently-active interfaces. This is done
by running the system utility <span class="stt">ifconfig</span> and parsing its output.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._best-interface-ip-address))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._best-interface-ip-address%29%29" class="RktValDef RktValLink" data-pltdoc="x">best-interface-ip-address</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Returns the "best" value from the list returned by
<span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._interface-ip-addresses%29%29" class="RktValLink" data-pltdoc="x">interface-ip-addresses</a></span>, where</div></p><ul><li><p>the first non-private, non-local IP address found is considered best;</p></li><li><p>the first private, non-local IP address found is considered second-best;</p></li><li><p>any other address found is considered third-best;</p></li><li><p>and if no addresses were found at all, <span class="RktVal">"127.0.0.1"</span> is returned.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._wildcard-ip-address~3f))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._wildcard-ip-address~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">wildcard-ip-address?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if the argument is the wildcard
(a.k.a. <span class="stt">INADDR_ANY</span>) IP address string; that is, if it is the
string "0.0.0.0".</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._localhost-ip-address~3f))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._localhost-ip-address~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">localhost-ip-address?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if the argument is a local IP address
string; that is, if it begins with the string "127.".</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._private-ip-address~3f))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._private-ip-address~3f%29%29" class="RktValDef RktValLink" data-pltdoc="x">private-ip-address?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">addr</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">addr</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if the argument is an IP address in
one of the <a href="https://tools.ietf.org/html/rfc1918">RFC 1918</a>
"private" address ranges; that is, 10.x.y.z, 172.16.x.y through
172.31.x.y, or 192.168.x.y.</div></p><h4 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;Low-level_interfaces&quot;">2.3<tt>&nbsp;</tt><a name="(part._.Low-level_interfaces)"></a>Low-level interfaces</h4><h5 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;Records_of_established_mappings&quot;">2.3.1<tt>&nbsp;</tt><a name="(part._.Records_of_established_mappings)"></a>Records of established mappings</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._nat-traversal/main..rkt)._mapping-lifetime))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping-external-port))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping-internal-port))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping-internal-address))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping-protocol))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3amapping))"></a><a name="(def._((lib._nat-traversal/main..rkt)._mapping))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">mapping</span></span></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">protocol</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">internal-address</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">internal-port</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">external-port</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">lifetime</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:prefab</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">udp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">tcp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">internal-address</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">internal-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">external-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">lifetime</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">A record of an established mapping. In cases where the internal
address is not known at the time of mapping (e.g. when using NAT-PMP),
<span class="RktSym">mapping-internal-address</span> will be <span class="RktVal">#f</span>.</div></p><h5 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;NAT-PMP&quot;">2.3.2<tt>&nbsp;</tt><a name="(part._.N.A.T-.P.M.P)"></a>NAT-PMP</h5><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">nat-traversal/nat-pmp</span><span class="RktPn">)</span></p><p>NAT-PMP depends on being able to learn the IP address of the current
default gateway. It does so by calling <span class="RktSym"><a href="#%28def._%28%28lib._nat-traversal%2Fmain..rkt%29._gateway-ip-address%29%29" class="RktValLink" data-pltdoc="x">gateway-ip-address</a></span>.</p><p>Requests made to the gateway using NAT-PMP will eventually time out if
the gateway does not support NAT-PMP. When this happens, an exception
is raised by the routine making the request.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._nat-pmp-external-ip-address))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">nat-pmp-external-ip-address</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></p></blockquote></td></tr></table></blockquote></div><div class="SIntrapara">Uses the NAT-PMP protocol to ask the current gateway what the current
external IP address is.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top" colspan="3"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._nat-pmp-make-persistent-mapping))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">nat-pmp-make-persistent-mapping</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">protocol</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">local-port</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">requested-port</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:refresh-interval</span><span class="hspace">&nbsp;</span><span class="RktVar">refresh-interval</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:on-mapping</span><span class="hspace">&nbsp;</span><span class="RktVar">on-mapping</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">persistent-mapping?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">udp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">tcp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">local-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">requested-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">refresh-interval</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">3600</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="argcontract"><tr><td valign="top"><span class="hspace">&nbsp;&nbsp;</span></td><td valign="top"><span class="RktVar">on-mapping</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">:</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym">mapping?</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">=</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void</a></span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Establishes a persistent mapping, which will refresh itself in the
background every <span class="RktPn">#:refresh-interval</span> seconds until told to
stop with <span class="RktSym">stop-persistent-mapping!</span>.</div></p><p>Every time the externally mapped port changes (including when the
mapping is first established!) the <span class="RktPn">#:on-mapping</span> callback is
called with the updated mapping information. Note that the callback is
invoked directly from the mapping&rsquo;s thread - if it raises an
exception, it will kill the persistent mapping.</p><p>If you can&rsquo;t or don&rsquo;t want to use persistent mapping, the following
routines let you explicitly manage mappings with the gateway.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._nat-pmp-map-port!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">nat-pmp-map-port!</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">protocol</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">local-port</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">requested-port</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">lifetime-seconds</span><span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktSym">mapping?</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">udp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">tcp</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">local-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">requested-port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">lifetime-seconds</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a mapping at the gateway, requesting that
<span class="RktVar">requested-port</span> on the external IP address be mapped to
<span class="RktVar">local-port</span> on the IP address of the local machine. The
mapping will survive on the gateway for <span class="RktVar">lifetime-seconds</span>
seconds or until the router is rebooted. If both
<span class="RktVar">requested-port</span> and <span class="RktVar">lifetime-seconds</span> are zero, an
existing mapping for <span class="RktVar">local-port</span> is deleted (but use
<span class="RktSym">nat-pmp-delete-mapping!</span> instead).</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._nat-pmp-unmap-all-ports!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">nat-pmp-unmap-all-ports!</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">protocol</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">protocol</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">udp</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">tcp</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Unmaps all existing mappings for the local IP address and the given protocol.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._nat-pmp-refresh-mapping!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">nat-pmp-refresh-mapping!</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">mapping</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">mapping?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mapping</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">mapping?</span></td></tr></table></blockquote></div><div class="SIntrapara">Refreshes a mapping by extracting its fields and calling <span class="RktSym">nat-pmp-map-port!</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._nat-pmp-delete-mapping!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">nat-pmp-delete-mapping!</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">mapping</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mapping</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">mapping?</span></td></tr></table></blockquote></div><div class="SIntrapara">Deletes a mapping.</div></p><h5 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;UPnP&quot;">2.3.3<tt>&nbsp;</tt><a name="(part._.U.Pn.P)"></a>UPnP</h5><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">nat-traversal/upnp-ip-gateway</span><span class="RktPn">)</span></p><p>TODO</p><h5 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;Managing_low-level_persistent_mappings&quot;">2.3.4<tt>&nbsp;</tt><a name="(part._.Managing_low-level_persistent_mappings)"></a>Managing low-level persistent mappings</h5><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._stop-persistent-mapping!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">stop-persistent-mapping!</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">p</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">persistent-mapping?</span></td></tr></table></blockquote></div><div class="SIntrapara">Deletes and stops refreshing an earlier-established persistent mapping.
The mapping is deleted at the gateway where it was established.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._current-persistent-mapping))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">current-persistent-mapping</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">mapping?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">p</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">persistent-mapping?</span></td></tr></table></blockquote></div><div class="SIntrapara">Retrieves the current mapping details from a persistent mapping.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._refresh-persistent-mapping!))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">refresh-persistent-mapping!</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">p</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">persistent-mapping?</span></td></tr></table></blockquote></div><div class="SIntrapara">Overrides the internal timers in the persistent mapping, causing it to
refresh itself at its gateway right now. Normal refreshing will resume
thereafter.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._nat-traversal/main..rkt)._persistent-mapping-thread))"></a><a name="(def._((lib._nat-traversal/main..rkt)._persistent-mapping~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3apersistent-mapping))"></a><a name="(def._((lib._nat-traversal/main..rkt)._persistent-mapping))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">persistent-mapping</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">thread</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:prefab</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">thread</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=threads.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._thread%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">thread?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Handle for a persistent mapping. Useful with <span class="RktSym">stop-persistent-mapping!</span>, etc.</div></p><h5 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;Calling_other_UPnP_services&quot;">2.3.5<tt>&nbsp;</tt><a name="(part._.Calling_other_.U.Pn.P_services)"></a>Calling other UPnP services</h5><p><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">nat-traversal/upnp</span><span class="RktPn">)</span></p><p>Routines for discovering UPnP services and calling service actions.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>parameter</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._default-scan-time))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">default-scan-time</span></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></p></blockquote></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">default-scan-time</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">seconds</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=void.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._void%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">seconds</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Defines the number of seconds that an <span class="RktSym">in-upnp-services</span>
discovery scan will remain active for.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._nat-traversal/main..rkt)._exn~3afail~3aupnp-description))"></a><a name="(def._((lib._nat-traversal/main..rkt)._exn~3afail~3aupnp-code))"></a><a name="(def._((lib._nat-traversal/main..rkt)._exn~3afail~3aupnp~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3aexn~3afail~3aupnp))"></a><a name="(def._((lib._nat-traversal/main..rkt)._exn~3afail~3aupnp))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">exn:fail:upnp</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=exns.html%23%2528def._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._exn%7E3afail%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exn:fail</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">code</span><span class="stt"> </span><span class="RktSym">description</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">code</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">description</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._or%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Exception thrown upon a UPnP-related SOAP fault or failure.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._exn~3afail~3aupnp~3f/code))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">exn:fail:upnp?/code</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">code</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fmisc..rkt%2529._any%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">code</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns a predicate that returns <span class="RktVal">#t</span> if and only if its
argument is an <span class="RktSym">exn:fail:upnp?</span> with
<span class="RktSym">exn:fail:upnp-code</span> equal to <span class="RktVar">code</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-scpd-url))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-event-url))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-control-url))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-type))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3aupnp-service))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">upnp-service</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">type</span><span class="stt"> </span><span class="RktSym">control-url</span><span class="stt"> </span><span class="RktSym">event-url</span><span class="stt"> </span><span class="RktSym">scpd-url</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:prefab</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">control-url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">url?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">event-url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">url?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">scpd-url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">url?</span></td></tr></table></blockquote></div><div class="SIntrapara">Describes a UPnP service. The <span class="RktSym">upnp-service-type</span> will be a URI.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-action-results))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-action-args))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-action-name))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-action~3f))"></a><a name="(def._((lib._nat-traversal/main..rkt)._struct~3aupnp-service-action))"></a><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-action))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">upnp-service-action</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">args</span><span class="stt"> </span><span class="RktSym">results</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:prefab</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">args</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">results</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Describes a particular action available on a UPnP service. The
<span class="RktSym">upnp-service-action-args</span> are the names of the arguments
expected from the caller, and the <span class="RktSym">upnp-service-action-results</span>
are the names of the results expected to be returned from the server.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._in-upnp-services))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">in-upnp-services</span></span></span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:scan-time</span><span class="hspace">&nbsp;</span><span class="RktVar">scan-time</span>]<span class="RktPn">)</span></p></blockquote></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="prototype"><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top">&rarr;</td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">sequenceof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._case-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">case-&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">descriptor</span><span class="hspace">&nbsp;</span><span class="RktSym">upnp-service?</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">actions</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fhash..rkt%2529._hash%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">hash/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">upnp-service-action?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=function-contracts.html%23%2528form._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._-%7E3e%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">#:rest</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fbase..rkt%2529._listof%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=data-structure-contracts.html%23%2528def._%2528%2528lib._racket%252Fcontract%252Fprivate%252Fhash..rkt%2529._hash%252Fc%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">hash/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">scan-time</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=number-types.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._exact-nonnegative-integer%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">default-scan-time</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Produces a sequence of service dispatchers, one for each discovered
UPnP service on the local network. Yields each dispatcher as it is
discovered. Continues producing values as they arrive until
<span class="RktVar">scan-time</span> seconds have elapsed, at which point the sequence
ends.</div></p><p>Each of the yielded dispatchers is a procedure taking a variable
number of arguments:</p><ul><li><p>If the first argument is <span class="RktVal">'</span><span class="RktVal">descriptor</span>, the underlying
<span class="RktSym">upnp-service</span> is returned.</p></li><li><p>If the first argument is <span class="RktVal">'</span><span class="RktVal">actions</span>, a hashtable
mapping action name strings to <span class="RktSym">upnp-service-action</span>
instances is returned.</p></li><li><p>Otherwise, the first argument must be a string naming an
action supported by the service being dispatched to. The number of
additional arguments must be equal to the number of arguments
expected by the named action, and they must all be strings. The
result will be a hashtable mapping result name to string result
value.</p></li></ul><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._nat-traversal/main..rkt)._upnp-service-type~3d~3f))"></a><span title="Provided from: nat-traversal | Package: nat-traversal"><span class="RktSym"><span class="RktSymDef RktSym">upnp-service-type=?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span><span class="RktVar">type</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=booleans.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._boolean%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">boolean?</a></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">s</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">upnp-service?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=strings.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._string%7E3f%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">string?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktVal">#t</span> if and only if <span class="RktPn">(</span><span class="RktSym">upnp-service-type</span><span class="stt"> </span><span class="RktVar">s</span><span class="RktPn">)</span> is
equal to <span class="RktVar">type</span>.</div></p><h3 x-source-module="(lib &quot;nat-traversal/scribblings/nat-traversal.scrbl&quot;)" x-source-pkg="nat-traversal" x-part-tag="&quot;References&quot;">3<tt>&nbsp;</tt><a name="(part._.References)"></a>References</h3><p>NAT-PMP is currently defined in an Internet-Draft.</p><ul><li><p><a href="https://tools.ietf.org/html/draft-cheshire-nat-pmp-06">The NAT-PMP Internet-Draft at the time this library was written</a>.</p></li><li><p><a href="http://miniupnp.free.fr/nat-pmp.html">A useful quick overview of the protocol</a>.</p></li><li><p><a href="https://en.wikipedia.org/wiki/NAT_Port_Mapping_Protocol">NAT-PMP on Wikipedia</a>.</p></li></ul><p>UPnP is a vast expanse of entangled specification.</p><ul><li><p>The core discovery mechanism is
<a href="https://en.wikipedia.org/wiki/Simple_Service_Discovery_Protocol">SSDP</a>.</p></li><li><p>Everything else in UPnP is done with
<a href="https://en.wikipedia.org/wiki/SOAP">SOAP</a> (!) over HTTP.</p></li><li><p>You can <a href="http://www.upnp.org/specs/arch/">download</a> the
70MB (!) specification zip file from the
<a href="http://www.upnp.org/">UPnP forum</a>. Fair warning, it&rsquo;s not
an easy read.</p></li></ul><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>