<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>mediafile: Media File Metadata Utilities</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">mediafile:<span class="mywbr"> &nbsp;</span> Media File Metadata Utilities</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Types%29" class="tocviewlink" data-pltdoc="x">Types</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Content_.Types%29" class="tocviewlink" data-pltdoc="x">Content Types</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.Files_and_.Scanning%29" class="tocviewlink" data-pltdoc="x">Files and Scanning</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.Test_.Files%29" class="tocviewlink" data-pltdoc="x">Test Files</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._.Known_.Issues%29" class="tocviewlink" data-pltdoc="x">Known Issues</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#%28part._.History%29" class="tocviewlink" data-pltdoc="x">History</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#%28part._.Legal%29" class="tocviewlink" data-pltdoc="x">Legal</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">mediafile:<span class="mywbr"> &nbsp;</span> Media File Metadata Utilities</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Types%29" class="tocsubseclink" data-pltdoc="x">Types</a></td></tr><tr><td><a href="#%28def._%28%28lib._mediafile%2Fmain..rkt%29._mediafile-type~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">mediafile-<wbr></wbr>type?</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._mediafile%2Fmain..rkt%29._mediafile-props~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">mediafile-<wbr></wbr>props?</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._mediafile%2Fmain..rkt%29._mediafile%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">mediafile</span></a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Content_.Types%29" class="tocsubseclink" data-pltdoc="x">Content Types</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.T.I.F.F__image_tiff_%29" class="tocsubseclink" data-pltdoc="x">TIFF (image/<span class="mywbr"> &nbsp;</span>tiff)</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.J.P.E.G_.Exif__image_jpeg_%29" class="tocsubseclink" data-pltdoc="x">JPEG/<span class="mywbr"> &nbsp;</span>Exif (image/<span class="mywbr"> &nbsp;</span>jpeg)</a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._.Ogg_.Vorbis__audio_ogg_%29" class="tocsubseclink" data-pltdoc="x">Ogg Vorbis (audio/<span class="mywbr"> &nbsp;</span>ogg)</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Files_and_.Scanning%29" class="tocsubseclink" data-pltdoc="x">Files and Scanning</a></td></tr><tr><td><a href="#%28def._%28%28lib._mediafile%2Fmain..rkt%29._path-~3emediafile%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">path-<wbr></wbr>&gt;mediafile</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._mediafile%2Fmain..rkt%29._scan-mediafiles%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">scan-<wbr></wbr>mediafiles</span></a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Test_.Files%29" class="tocsubseclink" data-pltdoc="x">Test Files</a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._.Current_.Test_.Files%29" class="tocsubseclink" data-pltdoc="x">Current Test Files</a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._.Contributing_.Test_.Files%29" class="tocsubseclink" data-pltdoc="x">Contributing Test Files</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Known_.Issues%29" class="tocsubseclink" data-pltdoc="x">Known Issues</a></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._.History%29" class="tocsubseclink" data-pltdoc="x">History</a></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="#%28part._.Legal%29" class="tocsubseclink" data-pltdoc="x">Legal</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">2:1</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._mediafile__.Media_.File_.Metadata_.Utilities)"></a><a name="(mod-path._mediafile)"></a>mediafile: Media File Metadata Utilities</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Neil Van Dyke</p></span></div><p><div class="SIntrapara"></div><div class="SIntrapara">License: <a href="#%28part._.Legal%29" class="plainlink" data-pltdoc="x">LGPLv3</a> <span class="hspace">&nbsp;</span> Web: <a href="http://www.neilvandyke.org/racket/mediafile/" class="plainlink">http://www.neilvandyke.org/racket/mediafile/</a>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=require.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._require%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" data-pltdoc="x"><span class="RktSym">mediafile</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <a href="https://pkgs.racket-lang.org/package/mediafile" title="Install this package using `raco pkg install mediafile`"><span class="stt">mediafile</span></a></span></td></tr></table></div></p><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Introduction&quot;">1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p><div class="SIntrapara">The <span class="stt">mediafile</span> package provides utilities for dealing with collections of media
files (still image, audio, video) and the metadata properties of those files.
Currently, this package provides procedures for extracting metadata from a few
popular media file formats, and procedures for maintaining a database of media
files currently in various filesystem directory trees.  This functionality is
useful for media-player applications, and for managing collections of media
files.</div><div class="SIntrapara">Currently, this package is implemented in pure Racket code, without
linking any new native code into the Racket process, nor running external
programs.</div><div class="SIntrapara">This package was written for the RackOut appliance, but has not
been exercised heavily.</div></p><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Types&quot;">2<tt>&nbsp;</tt><a name="(part._.Types)"></a>Types</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._mediafile/main..rkt)._mediafile-type~3f))"></a><span title="Provided from: mediafile | Package: mediafile"><span class="RktSym"><span class="RktSymDef RktSym">mediafile-type?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr></table></blockquote></div><div class="SIntrapara">Predicate for whether or not <span class="RktVar">x</span> is a <span class="RktSym">mediafile-type</span>.</div><div class="SIntrapara">A valid type is either a symbol, of a MIME content-type name, or
a list of symbols, in which the last symbol is the MIME content-type and the
one-or-more preceeding symbols are encodings atop the content-type.  For
example, file <span class="stt">"foo.tif"</span> might have type <span class="RktVal">'</span><span class="RktVal">image/tiff</span>, and file <span class="stt">"foo.tif.gz"</span> might have type <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">gzip</span><span class="stt"> </span><span class="RktVal">image/tiff</span><span class="RktVal">)</span>.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._mediafile/main..rkt)._mediafile-props~3f))"></a><span title="Provided from: mediafile | Package: mediafile"><span class="RktSym"><span class="RktSymDef RktSym">mediafile-props?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr></table></blockquote></div><div class="SIntrapara">Predicate for whether or not <span class="RktVar">x</span> is a <span class="RktSym">mediafile-props</span>, which is used to represent properties of a media file.</div><div class="SIntrapara">A props is an alist of alists of symbols to datums.  In other words, following this contract:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">listof</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cons/c</span><span class="hspace">&nbsp;</span><span class="RktSym">symbol?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">any/c</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The top level alist is for &ldquo;parts&rdquo;, such as for distinguishing
multiple media objects in a single container file.  The <span class="RktSym">car</span> of each of these top level alist pairs can be any datum, although will often be a number representing the sequence of the part in the container, unless there is a better unique key.  A special <span class="RktSym">car</span> is <span class="RktVal">#f</span>, which means properties of the entire container file.</div><div class="SIntrapara">The <span class="RktSym">cdr</span> of these top-level pairs is the second-level alist, which is
symbol-to-datum pairs specific to the part.  The names of the symbols are often
specific to the type of either the file or the part.  The datum values
corresponding to the names in the part can be of any type; an application
wishing to do more with the value than display it in raw form must have <span style="font-style: italic">a priori</span> knowledge of the type, such as that <span class="RktVal">'</span><span class="RktVal">exif:metering-mode</span> typically has values like <span class="RktVal">'</span><span class="RktVal">center-weighted-average</span> and <span class="RktVal">'</span><span class="RktVal">spot</span>, and what those values mean for the application.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>struct</p></div></div><table cellspacing="0" cellpadding="0" class="RForeground"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=define-struct.html%23%2528form._%2528%2528lib._racket%252Fprivate%252Fbase..rkt%2529._struct%2529%2529&amp;version=7.4" class="RktStxLink Sq" data-pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><a name="(def._((lib._mediafile/main..rkt)._mediafile-props))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile-mtime))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile-size))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile-identity))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile-type))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile-path))"></a><a name="(def._((lib._mediafile/main..rkt)._make-mediafile))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile~3f))"></a><a name="(def._((lib._mediafile/main..rkt)._struct~3amediafile))"></a><a name="(def._((lib._mediafile/main..rkt)._mediafile))"></a><span title="Provided from: mediafile | Package: mediafile"><span class="RktSym"><span class="RktSymDef RktSym">mediafile</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">path</span><span class="stt"> </span><span class="RktSym">type</span><span class="stt"> </span><span class="RktSym">identity</span><span class="stt"> </span><span class="RktSym">size</span><span class="stt"> </span><span class="RktSym">mtime</span><span class="stt"> </span><span class="RktSym">props</span><span class="RktPn">)</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym">make-mediafile</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">path</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">path?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">type</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">mediafile-type?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">identity</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">size</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">mtime</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any/c</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">props</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">mediafile-props?</span></td></tr></table></blockquote></div><div class="SIntrapara">Struct representing a <span class="RktSym">mediafile</span>.  The <span class="RktSym">identity</span>, <span class="RktSym">size</span>, and <span class="RktSym">mtime</span> values are intended to help determine whether a file has been
modified since it was last scanned for properties.</div></p><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Content_Types&quot;">3<tt>&nbsp;</tt><a name="(part._.Content_.Types)"></a>Content Types</h3><p>This package currently supports a few different MIME content-types,
listed in the following subsections, along with lists of references that were
used in the implementation for each content-type.</p><h4 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;TIFF__image_tiff_&quot;">3.1<tt>&nbsp;</tt><a name="(part._.T.I.F.F__image_tiff_)"></a>TIFF (image/tiff)</h4><ul><li><p>Adobe Developers Association, <a href="http://www.exif.org/TIFF6.pdf">TIFF Revision 6.0</a>, 1992-06-03</p></li><li><p><a href="http://www.fileformat.info/format/tiff/sample/index.htm">FileFormat.Info TIFF Sample Files</a></p></li></ul><h4 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;JPEG_Exif__image_jpeg_&quot;">3.2<tt>&nbsp;</tt><a name="(part._.J.P.E.G_.Exif__image_jpeg_)"></a>JPEG/Exif (image/jpeg)</h4><ul><li><p><a href="https://www.w3.org/Graphics/JPEG/itu-t81.pdf">ITU CCITT T.81</a>, Terminal Equipment and Protocols for Telematic Services -
Information Technology - Digital Compression and Coding of Continuous-Tone
Still Images - Requirements and Guidelines, 1992-09</p></li><li><p><a href="http://www.cipa.jp/english/hyoujunka/kikaku/pdf/DC-008-2010_E.pdf">CIPA DC-008-Translation-2010: Exchangeable image file
format for digital still cameras: Exif Version 2.3</a>, 2010-04-26</p></li><li><p><a href="http://www.burren.cx/david/canon.html">Davis Burren, EXIF MakerNote of Canon</a>, Revision 1.15, 2001-06-03</p></li><li><p><a href="http://www.ozhiker.com/electronics/pjmt/jpeg_info/canon_mn.html">Evan Hunter, Canon Makernote information</a>, viewed 2012-11-17</p></li><li><p><a href="http://www.exiv2.org/tags-canon.html">Canon MakerNote Tags defined in Exiv2</a>, viewed 2012-11-17</p></li><li><p><a href="http://gvsoft.homedns.org/exif/">GVsoft Exif MakerNote information</a>, viewed 2012-11-23</p></li></ul><h4 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Ogg_Vorbis__audio_ogg_&quot;">3.3<tt>&nbsp;</tt><a name="(part._.Ogg_.Vorbis__audio_ogg_)"></a>Ogg Vorbis (audio/ogg)</h4><ul><li><p><a href="https://xiph.org/vorbis/doc/Vorbis_I_spec.html">Vorbis I specification</a>, 2012-02-03</p></li><li><p><a href="https://xiph.org/vorbis/doc/v-comment.html">Ogg Vorbis I format specification: comment field and
header specification</a></p></li><li><p><a href="https://xiph.org/vorbis/doc/oggstream.html">Ogg logical and physical bitstream overview</a></p></li><li><p><a href="https://xiph.org/vorbis/doc/framing.html">Ogg logical bitstream framing</a></p></li><li><p><a href="https://xiph.org/ogg/doc/ogg-multiplex.html">Page Multiplexing and Ordering in a Physical Ogg Stream</a></p></li></ul><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Files_and_Scanning&quot;">4<tt>&nbsp;</tt><a name="(part._.Files_and_.Scanning)"></a>Files and Scanning</h3><p><div class="SIntrapara">This section lists procedures for maintaining a database of <span class="RktVal">"mediafile"</span> objects corresponding to files in filesystem directory trees.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._mediafile/main..rkt)._path-~3emediafile))"></a><span title="Provided from: mediafile | Package: mediafile"><span class="RktSym"><span class="RktSymDef RktSym">path-&gt;mediafile</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">path</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:canonicalize-path?</span><span class="hspace">&nbsp;</span><span class="RktVar">canonicalize-path?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:old-mediafile</span><span class="hspace">&nbsp;</span><span class="RktVar">old-mediafile</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:type-mandatory?</span><span class="hspace">&nbsp;</span><span class="RktVar">type-mandatory?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:props-mandatory?</span><span class="hspace">&nbsp;</span><span class="RktVar">props-mandatory?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:exception?</span><span class="hspace">&nbsp;</span><span class="RktVar">exception?</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">mediafile?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">path</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">path-string?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">canonicalize-path?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#true</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">old-mediafile</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="hspace">&nbsp;</span><span class="RktSym">mediafile?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">type-mandatory?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#false</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">props-mandatory?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#false</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">exception?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#true</span></td></tr></table></blockquote></div><div class="SIntrapara">Yields a <span class="RktSym">mediafile</span>, given a path to the file.  If <span class="RktPn">#:old-mediafile</span> is given, then that value will be returned if the file does not seem to have changed since that <span class="RktSym">mediafile</span> was created, which potentially saves the cost of scanning for properties.</div><div class="SIntrapara">If there is a problem creating a <span class="RktSym">mediafile</span>, then the behavior depends on <span class="RktPn">#:exception?</span> &ndash; if true, then an exception is raised; if false, then this procedure returns <span class="RktVal">#false</span> rather than a <span class="RktSym">mediafile</span>.  The <span class="RktPn">#:type-mandatory?</span> and <span class="RktPn">#:props-mandatory?</span> arguments specify what should be considered a &ldquo;problem&rdquo; for this purpose.</div><div class="SIntrapara">The <span class="RktPn">#:canonicalize-path?</span> specifies whether or not to store a canonicalized path in the <span class="RktSym">mediafile</span>, rather than the <span class="RktVar">path</span> argument verbatim.  Most applications will want to have a
canonicalized path, which is the default behavior.</div><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><table cellspacing="0" cellpadding="0" class="prototype RForeground"><tr><td valign="top"><span class="RktPn">(</span><a name="(def._((lib._mediafile/main..rkt)._scan-mediafiles))"></a><span title="Provided from: mediafile | Package: mediafile"><span class="RktSym"><span class="RktSymDef RktSym">scan-mediafiles</span></span></span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktVar">start-path-or-paths</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span>[</td><td valign="top"><span class="RktPn">#:canonicalize-paths?</span><span class="hspace">&nbsp;</span><span class="RktVar">canonicalize-paths?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:type-mandatory?</span><span class="hspace">&nbsp;</span><span class="RktVar">type-mandatory?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:props-mandatory?</span><span class="hspace">&nbsp;</span><span class="RktVar">props-mandatory?</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:old-hash</span><span class="hspace">&nbsp;</span><span class="RktVar">old-hash</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr><tr><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="hspace">&nbsp;</span></td><td valign="top"><span class="RktPn">#:remove-other-paths?</span><span class="hspace">&nbsp;</span><span class="RktVar">remove-other-paths?</span>]<span class="RktPn">)</span></td><td valign="top"><span class="hspace">&nbsp;</span></td></tr></table></blockquote></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">immutable-hash?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">start-path-or-paths</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">or/c</span><span class="hspace">&nbsp;</span><span class="RktSym">path-string?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">list-of</span><span class="hspace">&nbsp;</span><span class="RktSym">path-string?</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">canonicalize-paths?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#true</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">type-mandatory?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#false</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">props-mandatory?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#false</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">old-hash</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">immutable-hash?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#f</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">remove-other-paths?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">boolean?</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">#true</span></td></tr></table></blockquote></div><div class="SIntrapara">Scans filesystems recursively, beneath the paths given as <span class="RktVar">start-path-or-paths</span>, and returns a hash of paths to <span class="RktSym">mediafile</span> objects.</div><div class="SIntrapara">If <span class="RktPn">#:old-hash</span> is provided, then this hash is used as a starting point for the hash that will ultimately be returned, such as for updating from a previous run of <span class="RktSym">scan-mediafiles</span>.  If <span class="RktPn">#:old-hash</span> is provided, then <span class="RktPn">#:remove-other-paths?</span> determines whether paths in the old hash that are not within the scope of <span class="RktVar">start-path-or-paths</span> should be removed before returning the new hash.</div><div class="SIntrapara">The <span class="RktPn">#:canonicalize-paths?</span>, <span class="RktPn">#:type-mandatory?</span>, and <span class="RktPn">#:props-mandatory?</span> arguments are passed to <span class="RktSym">path-&gt;mediafile</span>.</div></p><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Test_Files&quot;">5<tt>&nbsp;</tt><a name="(part._.Test_.Files)"></a>Test Files</h3><p>This package contains some files that are used for test data.</p><h4 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Current_Test_Files&quot;">5.1<tt>&nbsp;</tt><a name="(part._.Current_.Test_.Files)"></a>Current Test Files</h4><p><div class="SIntrapara">The following directory structure exists in the source code
distribution for this package.</div><div class="SIntrapara"><ul><li><p><div class="SIntrapara"><span class="stt">"test-files/"</span></div><div class="SIntrapara"><ul><li><p><span class="stt">"exif-org/"</span> &ndash; JPEG/Exif and other files, from <a href="http://exif.org/samples.html"><span class="url">http://exif.org/samples.html</span></a>, courtesy of John Hawkins.</p></li><li><p><div class="SIntrapara"><span class="stt">"public-domain/"</span> &ndash; Files known to be in the legal public domain, for
testing with a breadth of file creators (e.g., different camera models) and
situations (e.g., different Ogg container layouts).</div><div class="SIntrapara"><ul><li><p><span class="stt">"jpeg/"</span> &ndash; JPEG/Exif and JPEG/JFIF files from public
domain, especially verbatim as saved by particular camera models.</p></li></ul></div></p></li></ul></div></p></li></ul></div></p><h4 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Contributing_Test_Files&quot;">5.2<tt>&nbsp;</tt><a name="(part._.Contributing_.Test_.Files)"></a>Contributing Test Files</h4><p><div class="SIntrapara">Please note that we are not currently soliciting contributions of
test data for this package.  This section remains just in case we resume.</div><div class="SIntrapara">If you&rsquo;d like to contribute a JPEG file from a particular camera
model, that would be very welcome.  Here&rsquo;s how:</div><div class="SIntrapara"><ol><li><p>Set camera to capture the image in a relatively <span style="font-style: italic">small</span> file size.  This means setting camera to low resolution,
high compression, low quality, etc.  (The small size is to make including files
with the package more practical.)</p></li><li><p><div class="SIntrapara">Choose a photographic subject (e.g., stop sign, cloud,
thumbtack, light switch) that:</div><div class="SIntrapara"><ul><li><p>Does not contain any trademarks or copyrighted
material (no brand names, logos, book pages, etc.).</p></li><li><p>Does not contain anything personally-identifiable,
such as faces.</p></li><li><p>Is G-rated.  (No showing off Racket programmer abs.)</p></li><li><p>Is not too complicated, so should compress well.</p></li></ul></div></p></li><li><p>Take photo with camera.</p></li><li><p>Do <span style="font-style: italic">not</span> edit the photo in any way at all &ndash; it must be
byte-for-byte identical to how the camera first wrote it to your memory card.</p></li><li><p>Email the file to: <span class="stt">neil</span><span style="font-weight: bold"><span class="stt">@</span></span><span class="stt">neilvandyke.org</span><br/>In the text of the email, please state &ldquo;This file is in
the public domain.&rdquo;  Note that you are legally giving up all copyright to the
image, to make including the file in a regression test suite more practical.</p></li></ol></div></p><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Known_Issues&quot;">6<tt>&nbsp;</tt><a name="(part._.Known_.Issues)"></a>Known Issues</h3><ul><li><p>Assemble a suite of test input files, without legal encumbrances.
Preferrably small enough file sizes to include in PLaneT package, as part of
built-in unit tests.</p></li><li><p>Needs more real-world testing with diversity of files.</p></li><li><p>Malformed or insufficiently supported TIFF and Exif files can
result in infinite loops or use excessive resources.</p></li><li><p>Support for additional Exif MakerNotes, especially Nikon ones.</p></li><li><p>A little bit more support for Canon Exif MakerNotes is possible,
such as decoding Custom Functions.</p></li><li><p>Add support for getting info about multiple streams in Ogg
files.</p></li><li><p>Support additional file types, especially JPEG/JFIF, PNG, and the
multiple MP3 ID3 variants.</p></li><li><p>Add feature to map properties of different formats to common ontology.</p></li><li><p>Make a variation on <span class="RktSym">scan-mediafiles</span> with a fold interface, such as for various ways of getting
incremental results, including if the scanning is in concurrent thread or
process.</p></li></ul><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;History&quot;">7<tt>&nbsp;</tt><a name="(part._.History)"></a>History</h3><ul><li><p><div class="SIntrapara">Version 2:1 &#8212;<wbr></wbr> 2016-03-02</div><div class="SIntrapara"><ul><li><p>Tests changes.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 2:0 &#8212;<wbr></wbr> 2016-02-27</div><div class="SIntrapara"><ul><li><p>Moving from PLaneT to new package system.</p></li><li><p>Fixed test cases in <span class="stt">"mediafile-exif.rkt"</span>.  Old change, perhaps unreleased.</p></li></ul></div></p></li><li><p><div class="SIntrapara">Version 1:0 &#8212;<wbr></wbr> 2012-11-27</div><div class="SIntrapara"><ul><li><p>Initial version, for alpha testing and soliciting
additional test files.  Some subsequent releases are likely to have
backward-incompatible changes, such as changes to types of properties.</p></li></ul></div></p></li></ul><h3 x-source-module="(lib &quot;mediafile/mediafile.scrbl&quot;)" x-source-pkg="mediafile" x-part-tag="&quot;Legal&quot;">8<tt>&nbsp;</tt><a name="(part._.Legal)"></a>Legal</h3><p>Copyright 2012, 2016 Neil Van Dyke.  This program is Free Software; you can
redistribute it and/or modify it under the terms of the GNU Lesser General
Public License as published by the Free Software Foundation; either version 3
of the License, or (at your option) any later version.  This program is
distributed in the hope that it will be useful, but without any warranty;
without even the implied warranty of merchantability or fitness for a
particular purpose.  See http://www.gnu.org/licenses/ for details.  For other
licenses and consulting, please contact the author.

Test files from exif.org (used with permission) and/or that are in the public
domain might also be included with this software, and no copyright on them is
claimed on those test files by the author of this software.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>