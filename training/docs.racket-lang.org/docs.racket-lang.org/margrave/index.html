<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>The Margrave Tool for Policy Analysis</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="../local-redirect/local-redirect.js"></script><script type="text/javascript" src="../local-redirect/local-user-redirect.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">The <span style="font-weight: bold">Margrave</span> Tool for Policy Analysis</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Getting_.Started%29" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Margrave_s_.Command_.Language%29" class="tocviewlink" data-pltdoc="x">Margrave&rsquo;s Command Language</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Representing_.Policies%29" class="tocviewlink" data-pltdoc="x">Representing Policies</a></td></tr><tr><td align="right"></td><td><a href="#%28part._doc-bibliography%29" class="tocviewlink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._top%29" class="tocsubseclink" data-pltdoc="x">The <span style="font-weight: bold">Margrave</span> Tool for Policy Analysis</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Getting_.Started%29" class="tocsubseclink" data-pltdoc="x">Getting Started</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._install%29" class="tocsubseclink" data-pltdoc="x">Installing Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._running-margrave%29" class="tocsubseclink" data-pltdoc="x">Running Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.2.1<tt>&nbsp;</tt></span><a href="#%28part._margrave-prompt%29" class="tocsubseclink" data-pltdoc="x">Tutorial:<span class="mywbr"> &nbsp;</span> The Command Prompt</a></td></tr><tr><td><span class="tocsublinknumber">1.2.2<tt>&nbsp;</tt></span><a href="#%28part._margrave-scripts%29" class="tocsubseclink" data-pltdoc="x">Tutorial:<span class="mywbr"> &nbsp;</span> Margrave Scripts</a></td></tr><tr><td><span class="tocsublinknumber">1.2.3<tt>&nbsp;</tt></span><a href="#%28part._.Moving_.On%29" class="tocsubseclink" data-pltdoc="x">Moving On</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._gs-ios%29" class="tocsubseclink" data-pltdoc="x">IOS in Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Understanding_.I.O.S_.Scenarios%29" class="tocsubseclink" data-pltdoc="x">Understanding IOS Scenarios</a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#%28part._gs-existing%29" class="tocsubseclink" data-pltdoc="x">General Policies in Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.4.1<tt>&nbsp;</tt></span><a href="#%28part._.Tutorial__.Understanding_.Scenarios%29" class="tocsubseclink" data-pltdoc="x">Tutorial:<span class="mywbr"> &nbsp;</span> Understanding Scenarios</a></td></tr><tr><td><span class="tocsublinknumber">1.5<tt>&nbsp;</tt></span><a href="#%28part._gs-create%29" class="tocsubseclink" data-pltdoc="x">Creating Your Own Policies</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Margrave_s_.Command_.Language%29" class="tocsubseclink" data-pltdoc="x">Margrave&rsquo;s Command Language</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._query-language%29" class="tocsubseclink" data-pltdoc="x">The Query Sub-<wbr></wbr>Language</a></td></tr><tr><td><span class="tocsublinknumber">2.1.1<tt>&nbsp;</tt></span><a href="#%28part._.E.X.P.L.O.R.E%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">EXPLORE</span></a></td></tr><tr><td><span class="tocsublinknumber">2.1.2<tt>&nbsp;</tt></span><a href="#%28part._.C.O.M.P.A.R.E%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">COMPARE</span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#%28part._presentation-language%29" class="tocsubseclink" data-pltdoc="x">The Presentation Sub-<wbr></wbr>Language</a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#%28part._command-language%29" class="tocsubseclink" data-pltdoc="x">The Command Sub-<wbr></wbr>Language</a></td></tr><tr><td><span class="tocsublinknumber">2.3.1<tt>&nbsp;</tt></span><a href="#%28part._.Loading_.Policies%29" class="tocsubseclink" data-pltdoc="x">Loading Policies</a></td></tr><tr><td><span class="tocsublinknumber">2.3.2<tt>&nbsp;</tt></span><a href="#%28part._.Renaming_.Prior_.Queries%29" class="tocsubseclink" data-pltdoc="x">Renaming Prior Queries</a></td></tr><tr><td><span class="tocsublinknumber">2.3.3<tt>&nbsp;</tt></span><a href="#%28part._.Getting_.I.N.F.O%29" class="tocsubseclink" data-pltdoc="x">Getting INFO</a></td></tr><tr><td><span class="tocsublinknumber">2.3.4<tt>&nbsp;</tt></span><a href="#%28part._.Comments%29" class="tocsubseclink" data-pltdoc="x">Comments</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Representing_.Policies%29" class="tocsubseclink" data-pltdoc="x">Representing Policies</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._policies%29" class="tocsubseclink" data-pltdoc="x">Elements of a Policy</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._vocabularies%29" class="tocsubseclink" data-pltdoc="x">Elements of a Vocabulary</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#%28part._doc-bibliography%29" class="tocsubseclink" data-pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><h2 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;top&quot;"><a name="(part._top)"></a><a name="(part._.The_.Margrave_.Tool_for_.Policy_.Analysis)"></a>The <span style="font-weight: bold">Margrave</span> Tool for Policy Analysis</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Tim Nelson &lt;<a href="mailto:tn@cs.wpi.edu">tn@cs.wpi.edu</a>&gt;,<br/>Christopher Barratt,<br/>Daniel J. Dougherty,<br/>Kathi Fisler,<br/>Shriram Krishnamurthi,<br/>and Varun Singh</p></span></div><h3 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Getting_Started&quot;">1<tt>&nbsp;</tt><a name="(part._.Getting_.Started)"></a>Getting Started</h3><p>Welcome to Margrave!</p><p>Margrave is part of an ongoing research project. We appreciate your
feedback and suggestions (including feature requests).</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;install&quot;">1.1<tt>&nbsp;</tt><a name="(part._install)"></a>Installing Margrave</h4><ul><li><p>Make sure that you have a recent version of Java installed.
Margrave requires Java 6 or later. You can download the latest
version of Java at</p><p><a href="https://www.java.com/en/download/"><span class="url">http://www.java.com/en/download/</span></a>.</p></li><li><p>Download and install Racket from</p><p><a href="https://racket-lang.org/download/"><span class="url">http://racket-lang.org/download/</span></a></p></li><li><p>Open DrRacket (the graphical development environment for Racket) and select the
<span class="ssansserif">File|Install .plt file</span> menu option. Enter this URL in the <span class="ssansserif">Web</span> tab:</p><p><a href="http://www.cs.wpi.edu/~tn/temp/margrave-dev-1106a.plt"><span class="url">http://www.cs.wpi.edu/~tn/temp/margrave-dev-1106a.plt</span></a></p><p>Alternatively, download the .plt file linked above and enter its location in the <span class="ssansserif">File</span> tab.</p></li></ul><p>Your Margrave install directory depends on your username and the version of Racket you have installed.
Every time you run Margrave, it will tell you where it is installed. For instance:</p><blockquote class="SCodeFlow"><p><span class="RktRes">Searching for java executable ...</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Using the java executable in: /usr/bin/java</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">--------------------------------------------------</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Starting Margrave's Java engine...</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">    Margrave path was: /users/tn/Racket/5.0.1/collects/margrave</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>would tell you that Margrave is installed in <span class="stt">/users/tn/Racket/5.0.1/collects/margrave</span>.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;running-margrave&quot;">1.2<tt>&nbsp;</tt><a name="(part._running-margrave)"></a>Running Margrave</h4><p>Margrave runs in the DrRacket programming environment. To begin, first open DrRacket.</p><p><span style="font-weight: bold">If this is your first time running DrRacket</span>, you will see a message about choosing a language.
Go to the <span class="ssansserif">Language|Choose Language</span> menu and select &ldquo;Use the language declared in the source&rdquo;, then click <span class="ssansserif">Ok</span>.</p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;margrave-prompt&quot;">1.2.1<tt>&nbsp;</tt><a name="(part._margrave-prompt)"></a>Tutorial: The Command Prompt</h5><p><div class="SIntrapara">Run DrRacket and open a new editor via the <span class="ssansserif">File|New</span> menu option.
Change the first line in the file to <span class="stt">#lang margrave</span>, then click <span class="ssansserif">Run</span>.
</div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>When you click <span class="ssansserif">Run</span>, Margrave will always print out its current install location.</p></blockquote></blockquote></blockquote></div></p><p>Margrave will automatically detect where your Java installation is located, start its
Java engine, and display a Margrave prompt on the bottom half of the screen.</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span></p></blockquote><p>Margrave runs queries against policies, so let&rsquo;s start by loading a policy.
Click after the prompt in the bottom window, type:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD POLICY "*MARGRAVE*/tests/conference1.p";</span></p></blockquote><p>and press the enter key. Margrave will reply with:</p><blockquote class="SCodeFlow"><p><span class="RktRes">ConferencePolicy1</span></p></blockquote><p>When loading policies, if you start a file path with <span class="stt">*MARGRAVE*</span>, the <span class="stt">*MARGRAVE*</span>
will be replaced with Margrave&#8217;s installation directory. Once the policy is loaded,
Margrave prints the policy&rsquo;s name for use in queries. Here the policy&rsquo;s name is
<span class="stt">ConferencePolicy1</span>.</p><p>Ask questions using the <span class="stt">EXPLORE</span> command and get answers with the <span class="stt">SHOW ONE/NEXT/ALL</span> commands.
For instance, to ask when the policy we just loaded yields a permit decision:</p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">EXPLORE conferencepolicy1:permit(s, a, r);</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">Query created successfully.</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">SHOW ONE;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">********* SOLUTION FOUND at size = 3 ******************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">s: author reviewer </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">a: readpaper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">r: paper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">conflicted = {} </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">assigned = {} </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS:  </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 3 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 3</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********************************************************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div></p><p><span class="stt">SHOW ONE</span> tells Margrave to print a single scenario (in no particular order).</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Commands in Margrave are case-insensitive. Entering <span class="stt">Show One</span> will do the same thing as entering <span class="stt">SHOW ONE</span>.</p></blockquote></blockquote></blockquote><p>To get additional scenarios, use <span class="stt">SHOW NEXT</span>:</p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">SHOW NEXT;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">********* SOLUTION FOUND at size = 3 ******************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">s: author reviewer </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">a: readpaper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">r: paper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">conflicted = {[s, r]}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">assigned = {[s, r]}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS: </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 3 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 3</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********************************************************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div></p><p>If Margrave finds no more solutions, it will say so.</p><p>You can display <span style="font-style: italic">all</span> the scenarios in the result with the <span class="stt">SHOW ALL</span> command:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">SHOW ALL;</span></p></blockquote><p>(Results omitted.)</p><p><span class="stt">SHOW</span> commands always display results for the most recent <span class="stt">EXPLORE</span> command.</p><p>You can write more refined queries using <span class="stt">AND</span>, <span class="stt">OR</span>, <span class="stt">NOT</span>, <span class="stt">IMPLIES</span>, and <span class="stt">IFF</span>, as well as parentheses. This query asks for scenarios where a request is both permitted and denied:</p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">EXPLORE conferencepolicy1:permit(s, a, r) </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">AND conferencepolicy1:deny(s, a, r);</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">Query created successfully.</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">SHOW ONE;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">---&gt; No more solutions! &lt;---</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS: </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 3 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 3</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div></p><p>Queries can involve multiple policies. Let&rsquo;s load a second policy and try asking how the permit different requests:</p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD POLICY "*MARGRAVE*/tests/conference2.p";</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">ConferencePolicy2</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">EXPLORE (ConferencePolicy1:permit(s,a,r) </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">AND NOT ConferencePolicy2:permit(s,a,r))</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">OR  (ConferencePolicy2:permit(s,a,r)</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">AND NOT ConferencePolicy1:permit(s,a,r));</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">Query created successfully.</span></p></blockquote></div></p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">SHOW ONE;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">********* SOLUTION FOUND at size = 3 ******************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">s: author reviewer </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">a: readpaper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">r: paper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">conflicted = {[s, r]}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">assigned = {[s, r]}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS: </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 3 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 3</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********************************************************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div></p><p>Since queries like this one completely describe how new and old versions of a policy disagree, we call them <a name="(tech._change._impact)"></a><span style="font-style: italic">change-impact</span> queries.</p><p>It can be cumbersome to manually write change-impact queries for policies with many decisions, so we provide a shortcut with the <span class="stt">COMPARE</span> command:</p><p><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">COMPARE ConferencePolicy1 ConferencePolicy2;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktRes">Query created successfully.</span></p></blockquote></div></p><p>Margrave commands are case-insensitive. The following queries are equivalent:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">EXPLORE conferencepolicy1:permit(s, a, r);</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">explore ConferencePolicy1:Permit(s, a, r);</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;margrave-scripts&quot;">1.2.2<tt>&nbsp;</tt><a name="(part._margrave-scripts)"></a>Tutorial: Margrave Scripts</h5><p>Of course, re-entering commands at the prompt can be tedious. You can avoid re-entering commands by using a script instead.
A Margrave script is a sequence of semicolon-terminated Margrave commands preceded by <span style="font-weight: bold">#lang margrave</span>.</p><p>Open a new DrRacket editor and change the first line to
<span class="stt">#lang margrave</span>. Instead of clicking <span class="ssansserif">Run</span> right away, add the following lines just under the <span class="stt">#lang margrave</span> line:</p><blockquote class="SCodeFlow"><p><span class="RktRes">LOAD POLICY "*MARGRAVE*/tests/conference1.p";</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">LOAD POLICY "*MARGRAVE*/tests/conference2.p";</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">EXPLORE conferencepolicy1:permit(s, a, r);</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">SHOW ONE;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>Then click <span class="ssansserif">Run</span>.
In the previous tutorial, you created and ran an empty script to get to
the prompt immediately. In this case, however, Margrave executes those four commands before giving you a prompt:</p><blockquote class="SCodeFlow"><p><span class="RktRes">ConferencePolicy1</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">ConferencePolicy2</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Query created successfully.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********* SOLUTION FOUND at size = 3 ******************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">s: author reviewer </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">a: readpaper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">r: paper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">conflicted = {}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">assigned = {[s, r]}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS: </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 3 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 3</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********************************************************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">&gt; </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>You can create scripts in DrRacket and save them via the <span class="ssansserif">File|Save Definitions As</span> menu option.
To open a saved Margrave script, use DrRacket&rsquo;s <span class="ssansserif">File|Open</span> menu option.
The script will execute when you click <span class="ssansserif">Run</span>, and its results will appear in the bottom
half of the window, followed by a Margrave prompt.</p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Moving_On&quot;">1.2.3<tt>&nbsp;</tt><a name="(part._.Moving_.On)"></a>Moving On</h5><p>For help understanding scenario output and a primer on Margrave&rsquo;s intermediate policy language, go to
<a href="#%28part._gs-existing%29" data-pltdoc="x">General Policies in Margrave</a>.</p><p>For help using Margrave on IOS configurations, go to <a href="#%28part._gs-ios%29" data-pltdoc="x">IOS in Margrave</a>.</p><p>If you would rather jump right to more complex examples, see the scripts in the
<span class="stt">examples/scripts</span> sub-directory of your Margrave installation.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;gs-ios&quot;">1.3<tt>&nbsp;</tt><a name="(part._gs-ios)"></a>IOS in Margrave</h4><p>Margrave supports a core subset of the IOS language involving
standard and most extended ACLs, static NAT,
ACL-based and map-based dynamic NAT, static routing,
and policy-based routing. Support for filtering based on TCP flags is
available for named, extended ACLs via the <span class="stt">match-all</span> and <span class="stt">match-any</span>
keywords (rather than the deprecated <span class="stt">established</span> keyword). At the moment, our support for state is
limited to reflexive access-lists.</p><p>To parse and load an IOS policy into Margrave, use:</p><p><span class="stt">LOAD IOS &lt;config-file-name&gt;</span></p><p>where <span class="stt">&lt;config-file-name&gt;</span> is the file name of the IOS configuration
saved as a text file.</p><p>Margrave will produce several intermediate policy files (discussed in Section 4 of [<a href="#%28cite._nbdfk10%29" data-pltdoc="x">nbdfk10</a>]) in
the same path as <span class="stt">&lt;config-file-name&gt;</span> and load them.
For instance, if you have a configuration saved to a file <span class="stt">config.txt</span> in
the directory <span class="stt">/myfiles/Margrave/IOS</span>, you should invoke:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS "/myfiles/Margrave/IOS/config.txt";</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>If the configuration contains unsupported IOS commands, Margrave will skip the line in question and print a warning.</p></blockquote></blockquote></blockquote><p>For detailed examples of running queries in IOS, see the <span class="stt">ios-demo.rkt</span> script
in the <span class="stt">examples/scripts</span> sub-directory of your Margrave installation.
If you would like to experiment with a small IOS
configuration, we suggest using
<span class="stt">examples/policies/ios-demo/initial/demo.txt</span>.</p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Understanding_IOS_Scenarios&quot;">1.3.1<tt>&nbsp;</tt><a name="(part._.Understanding_.I.O.S_.Scenarios)"></a>Understanding IOS Scenarios</h5><p>The <span class="stt">SHOW ALL</span>, <span class="stt">SHOW ONE</span>, and <span class="stt">SHOW NEXT</span> commands format query results and display them
in a concise format. A <span class="stt">SHOW ONE</span> command for an IOS query will produce output in this style:</p><blockquote class="SCodeFlow"><p><span class="RktRes">********* SOLUTION FOUND at size = 16 ******************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">message: icmpmessage </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">protocol: prot-tcp </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">src-port-out: port </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">dest-port-out: port </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">next-hop: ipaddress </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">entry-interface: fe0 </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">length: length </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">dest-addr-in: 192.168.5.11 </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">src-addr-in: ipaddress </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">dest-addr-out: ipaddress </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">src-port-in: port </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">exit-interface: interface </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">hostname: hostname-router </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">flags: tcpflags </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">dest-port-in: port-25 </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">src-addr-out: ipaddress </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS: </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 1 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 1</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********************************************************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>On the first line, <span class="RktRes">Size = 16</span> says that this scenario involves 16 atoms, where
each atom is an IP address, port, interface, etc.</p><p>The scenario itself says that the query can be satisfied when the packet
is a TCP request to the host <span class="RktRes">192.168.5.11</span> on port <span class="RktRes">25</span>,
entering the firewall at the <span class="RktRes">fe0</span> interface.
There are no restrictions on the source fields of the packet header in this
scenario: &ldquo;<span class="RktRes">IPAddress</span>&rdquo; represents some IP address not explicitly
mentioned in the IOS configuration. Similarly for &ldquo;<span class="RktRes">port</span>&rdquo; and &ldquo;<span class="RktRes">interface</span>&rdquo;.</p><p>The <span class="RktRes">message</span> binding is only applicable for ICMP packets,
and can be ignored in this scenario. The <span class="RktRes">length</span> binding is not yet used.
The <span class="RktRes">-out</span> bindings give information about NAT effects on the packet; there
are none in this scenario. Similarly the <span class="RktRes">flags</span> binding gives information
about the packet&rsquo;s TCP flags, which are not important in this scenario.
The <span class="RktRes">STATISTICS</span> section gives technical information about Margrave&rsquo;s scenario-finding process.</p><p>When printing, only the most specific applicable
information will be shown. You will never see:</p><blockquote class="SCodeFlow"><p><span class="RktRes">src-addr-in: 10.0.0.0/255.0.0.0 10.100.100.100</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>since the host <span class="RktRes">10.100.100.100</span> is always contained in the network
<span class="RktRes">10.0.0.0/255.0.0.0</span>. Instead, you would see</p><blockquote class="SCodeFlow"><p><span class="RktRes">src-addr-in: 10.100.100.100</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;gs-existing&quot;">1.4<tt>&nbsp;</tt><a name="(part._gs-existing)"></a>General Policies in Margrave</h4><p>Margrave&rsquo;s intermediate
language can capture many different kinds of policies. In this section,
we discuss how to use the intermediate language to express policies for analysis.</p><p>First, we&rsquo;ll quickly overview what a Margrave policy looks like.</p><p>A policy&rsquo;s form depends on its <a href="#%28tech._vocabulary%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary</span></a>. A vocabulary dictates what
a <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> <font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font> is, what <a href="#%28tech._decision%29" class="techoutside" data-pltdoc="x"><span class="techinside">decision</span></a>s a policy renders,
and so on.</p><p>Here is one of Margrave&rsquo;s built-in example policies, a fragment of an
access-control policy for a conference management system. Its vocabulary and policy files
are respectively <span class="stt">conference1.v</span> and <span class="stt">conference1.p</span> in your installation&rsquo;s
<span class="stt">tests</span> directory.</p><p>The vocabulary file contains:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">PolicyVocab</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Types</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Subject</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Author</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Action</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitReview</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Resource</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">Review</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Decisions</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Permit</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Deny</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Predicates</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">ReqVariables</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">OthVariables</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Constraints</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">atmostone-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>The section &ldquo;<a href="#%28part._vocabularies%29" data-pltdoc="x">Elements of a Vocabulary</a>&rdquo; contains details about this language. For now, note that this particular vocabulary gives the following:</p><ul><li><p>the notion of &ldquo;subjects&rdquo;, &ldquo;actions&rdquo;, and &ldquo;resources&rdquo; and some sub-types for each;</p></li><li><p>&ldquo;permit&rdquo; and &ldquo;deny&rdquo; as valid decisions; and</p></li><li><p>the fact that each request contains a subject, an action, and a resource (given by the <span class="stt">ReqVariables</span> construct).</p></li></ul><p>The policy for this example is:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy1</span><span class="hspace">&nbsp;</span><span class="RktSym">uses</span><span class="hspace">&nbsp;</span><span class="RktSym">conferencepolicy</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Target</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperNoConflict</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperAssigned</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperConflict</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://download.racket-lang.org/releases/7.4/doc/local-redirect/index.html?doc=reference&amp;rel=generic-numbers.html%23%2528def._%2528%2528quote._%7E23%7E25kernel%2529._%7E3d%2529%2529&amp;version=7.4" class="RktValLink Sq" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Deny</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>This <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> uses the above vocabulary, and
contains three <a href="#%28tech._rule%29" class="techoutside" data-pltdoc="x"><span class="techinside">rules</span></a> that each map certain
<font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font>s to <a href="#%28tech._decision%29" class="techoutside" data-pltdoc="x"><span class="techinside">decision</span></a>s. For instance, the first rule,
named <span class="stt">PaperNoConflict</span>, causes the policy to permit requests to read
papers, provided the subject is not known to be conflicted on the
paper. (For details, see the section &ldquo;<a href="#%28part._policies%29" data-pltdoc="x">Elements of a Policy</a>&rdquo;.)</p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Tutorial__Understanding_Scenarios&quot;">1.4.1<tt>&nbsp;</tt><a name="(part._.Tutorial__.Understanding_.Scenarios)"></a>Tutorial: Understanding Scenarios</h5><p>Paste the following script into DrRacket:</p><blockquote class="SCodeFlow"><p>#lang margrave<span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span>LOAD POLICY "*MARGRAVE*/tests/conference1.p";<span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span>EXPLORE ConferencePolicy1:Deny(s, a, r) AND <span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span>        reviewer(s) AND paper(r) AND readpaper(a);<span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>and click <span class="ssansserif">Run</span>. At the command prompt, enter:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">SHOW ALL;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>One of the two scenarios printed will be this one:</p><blockquote class="SCodeFlow"><p><span class="RktRes">********* SOLUTION FOUND at size = 3 ******************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">s: author reviewer </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">a: readpaper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">r: paper </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">conflicted = {[s, r]}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">assigned = {}</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes"></span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">STATISTICS: </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Margrave computed that 3 would be a sufficient size ceiling.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">No ceiling explicitly provided in the query's CEILING clause.</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">Used size ceiling: 3</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">********************************************************</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>This text represents a scenario where the query is
satisfied. The <span class="stt">SHOW ALL</span>, <span class="stt">SHOW ONE</span>, and <span class="stt">SHOW NEXT</span>
commands format query results and display them
in this concise format. The scenario above says:
&ldquo;The query is satisfied when the subject is
both a <span class="RktRes">reviewer</span> and an <span class="RktRes">author</span>, the resource is a <span class="RktRes">paper</span>, and
the action is <span class="RktRes">readpaper</span> (i.e. reading the paper), provided that
the subject is <span class="RktRes">conflicted</span> on the paper but not <span class="RktRes">assigned</span> to it.&rdquo;</p><p>Here, <span class="RktRes">s</span>, <span class="RktRes">a</span>, and <span class="RktRes">r</span> correspond to the variables that appear in
the query.
<span class="RktRes">Size = 3</span> means that in this scenario, there were 3 objects.
In this case, one is <span class="RktRes"><span style="font-style: italic">both</span></span> an <span class="RktRes">author</span> and a <span class="RktRes">reviewer</span>.
Another is a <span class="RktRes">paper</span>. The third represents the action <span class="RktRes">readpaper</span>.</p><p><span class="RktRes">Conflicted</span> and <span class="RktRes">assigned</span> are
binary <a href="#%28tech._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">predicates</span></a> mentioned in the policy. Any such facts
will be printed after information about individual variables.</p><p>The <span class="RktRes">STATISTICS</span> section gives technical information about Margrave&rsquo;s scenario-finding process.</p><p>Note: When printing, only the most specific applicable
information will be shown. E.g., you will never see
<span class="RktRes">s: reviewer subject</span>
because a reviewer is always a subject in this policy.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;gs-create&quot;">1.5<tt>&nbsp;</tt><a name="(part._gs-create)"></a>Creating Your Own Policies</h4><p>You can create your own policies in the same style as the examples above. The sections &ldquo;<a href="#%28part._policies%29" data-pltdoc="x">Elements of a Policy</a>&rdquo; and &ldquo;<a href="#%28part._vocabularies%29" data-pltdoc="x">Elements of a Vocabulary</a>&rdquo; contain more details on the policy language. Place the vocabulary in a text-file with the .v extension, and the policy in a text-file with the .p extension. Make sure that you refer to the correct vocabulary name in the policy file. For instance, if your vocabulary is in the file <span class="stt">myvocab.v</span>, make sure that the vocabulary is named <span class="stt">myvocab</span> and the policy <span class="stt">uses myvocab</span>.</p><h3 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Margrave_s_Command_Language&quot;">2<tt>&nbsp;</tt><a name="(part._.Margrave_s_.Command_.Language)"></a>Margrave&rsquo;s Command Language</h3><p>There are three kinds of Margrave commands: queries, presentation commands, and system commands.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;query-language&quot;">2.1<tt>&nbsp;</tt><a name="(part._query-language)"></a>The Query Sub-Language</h4><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;EXPLORE&quot;">2.1.1<tt>&nbsp;</tt><a name="(part._.E.X.P.L.O.R.E)"></a><span class="stt">EXPLORE</span></h5><p>Explore statements instruct Margrave to look for scenarios that satisfy the statement&rsquo;s conditions. For instance, in:</p><blockquote class="SCodeFlow"><p><span class="RktRes">EXPLORE ConferencePolicy1:Deny(s, a, r) AND </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktRes">        reviewer(s) AND paper(r) AND readpaper(a);</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p><div class="SIntrapara"><span class="stt">reviewer(s)</span>, <span class="stt">paper(r)</span> and <span class="stt">readpaper(a)</span>
signify properties about the request: The subject is a reviewer,
etc. The term <span class="stt">ConferencePolicy:Deny(s, a, r)</span> states that the policy
renders the &ldquo;Deny&rdquo; decision for the request. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Rendering deny is
not the same as failing to render permit!</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">The <span class="stt">EXPLORE</span> statement as a whole instructs Margrave to find
scenarios that meet all of those conditions.</div></p><p>When querying a policy, first use an EXPLORE statement to define the scenarios of interest, and then use a presentation command to get the results.</p><p><span class="stt">EXPLORE</span> statements have the following form:</p><p><span class="stt">EXPLORE</span> &lt;condition&gt; <br/>
[<span class="stt">UNDER</span> &lt;policy-name&gt;, ...] <br/>
[<span class="stt">PUBLISH</span> &lt;variable-name&gt;, ...] <br/>
[<span class="stt">TUPLING</span>] <br/>
[<span class="stt">INCLUDE</span> &lt;id&gt;, ...] <br/>
[<span class="stt">CEILING</span> &lt;number&gt;] <br/></p><p>Clauses enclosed in [] are optional, and can appear in any order.</p><p>A <a name="(tech._vocabulary._predicate)"></a><span style="font-style: italic">vocabulary predicate</span> is the name of either a <a href="#%28tech._type%29" class="techoutside" data-pltdoc="x"><span class="techinside">type</span></a> or
<font class="badlink"><span class="techoutside"><span class="techinside">other predicate</span></span></font> in the query&rsquo;s <a href="#%28tech._vocabulary._context%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary context</span></a>.
Every <a href="#%28tech._vocabulary._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary predicate</span></a> has an arity no less than 1.
If a <a href="#%28tech._vocabulary._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary predicate</span></a> is the name of a <a href="#%28tech._type%29" class="techoutside" data-pltdoc="x"><span class="techinside">type</span></a>,
its arity is 1, and it is called a <a name="(tech._unary)"></a><span style="font-style: italic">unary</span> predicate.</p><p>A <a name="(tech._variable._vector)"></a><span style="font-style: italic">variable vector</span> is one of:</p><ul><li><p><span class="stt">x</span>, where <span class="stt">x</span> is a variable symbol;</p></li><li><p><span class="stt">&lt;id:req&gt;</span>, where <span class="stt">id</span> is the name of a policy or saved query;</p></li><li><p>A comma-delimited sequence of <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a>s.</p></li></ul><p>The <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a> of the form <span class="stt">&lt;id:req&gt;</span> is equivalent to explicitly stating the request vector of the vocabulary associated with <span class="stt">id</span>.</p><p>Each <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a> has an associated <span style="font-style: italic">arity</span>. A single variable <span class="stt">x</span> has arity 1. A <span class="stt">&lt;id:req&gt;</span> reference has the same arity as <span class="stt">id</span>&rsquo;s <font class="badlink"><span class="techoutside"><span class="techinside">request vector</span></span></font>. A comma-delimited sequence of vectors has arity equal to the sum of its sub-vectors&rsquo; arities.</p><p>A &lt;condition&gt; is a boolean combination (via <span class="stt">AND</span>, <span class="stt">OR</span>, <span class="stt">IFF</span>, <span class="stt">IMPLIES</span>, <span class="stt">NOT</span>, and parentheses) of <a href="#%28tech._atomic._formula%29" class="techoutside" data-pltdoc="x"><span class="techinside">atomic formula</span></a>s.</p><p>An <a name="(tech._atomic._formula)"></a><span style="font-style: italic">atomic formula</span> is one of:</p><ul><li><p><div class="SIntrapara">an <a name="(tech._atomic._vocabulary._formula)"></a><span style="font-style: italic">atomic vocabulary formula</span>, which is one of:
</div><div class="SIntrapara"><ul><li><p><span class="stt">predname(X)</span>,
 where <span class="stt">X</span> is a <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a> and <span style="font-style: italic">predname</span> is a <a href="#%28tech._vocabulary._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary predicate</span></a> of the same arity;</p></li><li><p><span class="stt">x IN predname</span>, where <span class="stt">x</span> is a variable symbol and
 <span class="stt">predname</span> is a unary <a href="#%28tech._vocabulary._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary predicate</span></a>;</p></li><li><p><span class="stt">(X) IN predname</span>,
 where <span class="stt">X</span> is a <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a> and <span style="font-style: italic">predname</span> is a <a href="#%28tech._vocabulary._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary predicate</span></a> of the same arity;</p></li><li><p><span class="stt">x = typename</span>, where <span class="stt">x</span> is a variable symbol and
 <span class="stt">typename</span> is the name of an <a href="#%28tech._at._most._one%29" class="techoutside" data-pltdoc="x"><span class="techinside">at-most-one</span></a>
 or <a href="#%28tech._singleton%29" class="techoutside" data-pltdoc="x"><span class="techinside">singleton</span></a> constrained type in the
 statement&rsquo;s <a href="#%28tech._vocabulary._context%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary context</span></a></p></li></ul></div></p></li><li><p><div class="SIntrapara">an <a name="(tech._atomic._idb._formula)"></a><span style="font-style: italic">atomic IDB formula</span>, which is one of:
</div><div class="SIntrapara"><ul><li><p><span class="stt">policyid:idbname(X)</span>, where <span class="stt">policyid</span> is an identifier
for a <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> with a k-ary <font class="badlink"><span class="techoutside"><span class="techinside">request vector</span></span></font>, <span class="stt">idbname</span> is a valid <a href="#%28tech._idb%29" class="techoutside" data-pltdoc="x"><span class="techinside">IDB</span></a>
in that policy),
and <span class="stt">X</span> is a <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a> of arity k;</p></li><li><p><span class="stt">savedquery(X)</span>, where <span class="stt">savedquery</span> is an identifier for a
k-ary saved query and <span class="stt">X</span> is a <a href="#%28tech._variable._vector%29" class="techoutside" data-pltdoc="x"><span class="techinside">variable vector</span></a> of arity k;</p></li></ul></div></p></li><li><p>or a <a name="(tech._variable._equality._formula)"></a><span style="font-style: italic">variable equality formula</span>: <span class="stt">x = y</span>, where <span class="stt">x</span> and <span class="stt">y</span> are variable symbols.</p></li></ul><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The saved query identifier <span class="stt">last</span> always refers to the last successful <span class="stt">EXPLORE</span> statement.</p></blockquote></blockquote></blockquote><p>Every <span class="stt">EXPLORE</span> statement has a <a name="(tech._vocabulary._context)"></a><span style="font-style: italic">vocabulary context</span>: the set of
vocabularies across all policies mentioned in the query&rsquo;s &lt;condition&gt;
and its <span class="stt">UNDER</span> clause, if any. If the policies have incompatable vocabularies
(for example, if they both define the same predicate name, but with a
different arity) the query will produce an error.</p><p>The term <a name="(tech._idb)"></a><span style="font-style: italic">IDB</span> is taken from the database field.
Each policy provides a set of <a href="#%28tech._idb%29" class="techoutside" data-pltdoc="x"><span class="techinside">IDB</span></a>s that represent
policy decisions, rule applicability, and more.
For details, see Section 2 of [<a href="#%28cite._nbdfk10%29" data-pltdoc="x">nbdfk10</a>].</p><p>The <a name="(tech._under)"></a><span style="font-style: italic"><span class="stt">UNDER</span></span> clause adds policies to the query&rsquo;s <a href="#%28tech._vocabulary._context%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary context</span></a> that do not appear in the query &lt;condition&gt;.
If the &lt;condition&gt; does not explicitly refer to a policy, the query must include an <span class="stt">UNDER</span> clause.</p><p>The <a name="(tech._publish)"></a><span style="font-style: italic"><span class="stt">PUBLISH</span></span> clause dictates which variables in the query condition are published for use in later queries.</p><p>The <a name="(tech._tupling)"></a><span style="font-style: italic"><span class="stt">TUPLING</span></span> clause activates the optional tupling optimization. In order to qualify for tupling,
all of the query&rsquo;s saved-query predicates (if any) must refer to saved queries that <span class="stt">PUBLISH</span>ed all of their variables.</p><p>The syntax of the <a name="(tech._include)"></a><span style="font-style: italic"><span class="stt">INCLUDE</span></span> clause differs depending on whether tupling has been enabled.</p><ul><li><p>If <a href="#%28tech._tupling%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="stt">TUPLING</span></span></a> is not enabled, then the <a href="#%28tech._include%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="stt">INCLUDE</span></span></a> clause contains a nonempty list of
   policy <a href="#%28tech._idb%29" class="techoutside" data-pltdoc="x"><span class="techinside">IDB</span></a> predicates whose instantiations are to be included in the scenario
   output.</p><p><span style="font-weight: bold">Example:</span>
   <span class="stt">INCLUDE mypolicy:permit</span> will cause each output scenario to include the requests that <span class="stt">mypolicy</span> permits.</p></li><li><p>If <a href="#%28tech._tupling%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="stt">TUPLING</span></span></a> is enabled, then the <a href="#%28tech._include%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="stt">INCLUDE</span></span></a> clause may contain a nonempty list of IDB
   and/or <a href="#%28tech._vocabulary._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary predicate</span></a>s; however a tuple of
   arguments must be supplied to each predicate.
   Variable names shared between <a href="#%28tech._include%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="stt">INCLUDE</span></span></a> and
   the &lt;condition&gt; are assumed to refer to the same variable.</p><p><span style="font-weight: bold">Examples:</span>
   <span class="stt">INCLUDE mypolicy:permit(r, a, s)</span> causes each scenario to report if the request <span class="stt">(r, a, s)</span> is permitted by mypol.</p><p><span class="stt">INCLUDE mypolicy:permit(s, a, r), mypolicy:permit(r, a, s)</span> sets the watch on both <span class="stt">(s, a, r)</span> and <span class="stt">(r, a, s)</span>. </p></li></ul><p>The <a name="(tech._ceiling)"></a><span style="font-style: italic"><span class="stt">CEILING</span></span> clause provides a limit on the scenario-sizes Margrave will check. In most cases, Margrave can infer its own sufficient ceiling (see the Margrave firewall paper [<a href="#%28cite._nbdfk10%29" data-pltdoc="x">nbdfk10</a>]). If not, Margrave uses the user-provided ceiling (or <span style="font-style: italic">6</span>, if none is provided).</p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;COMPARE&quot;">2.1.2<tt>&nbsp;</tt><a name="(part._.C.O.M.P.A.R.E)"></a><span class="stt">COMPARE</span></h5><p>Margrave provides shorthand for change-impact queries in the form of the <span class="stt">COMPARE</span> command. The syntax of <span class="stt">COMPARE</span> is:</p><p><span class="stt">COMPARE</span> &lt;policy&gt; &lt;policy&gt; <br/>
[<span class="stt">TUPLING</span>] <br/>
[<span class="stt">CEILING</span> &lt;number&gt;] <br/></p><p>Running <span class="stt">COMPARE</span> on a pair of policies is equivalent to writing an <span class="stt">EXPLORE</span> statement that produces the scenarios in which the two policies render different decisions.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;presentation-language&quot;">2.2<tt>&nbsp;</tt><a name="(part._presentation-language)"></a>The Presentation Sub-Language</h4><p>The presentation sub-language is concerned with getting the results of the previous query.</p><p><a name="(tech._is._possible~3f)"></a><span style="font-style: italic"><span class="stt">IS POSSIBLE?</span></span>: If you just want to know if any scenarios exist to satisfy a query, follow it up with the <span class="stt">IS POSSIBLE?</span> command.</p><p>To get concrete scenarios, use:</p><p><div class="SIntrapara"><a name="(tech._show._all)"></a><span style="font-style: italic"><span class="stt">SHOW ALL</span></span>: Returns a string containing <span style="font-style: italic">all</span> satisfying scenarios, pretty-printed for human consumption. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Beware casual use of the SHOW ALL and GET ALL commands, as some queries can have enormous numbers of satisfying scenarios.</p></blockquote></blockquote></blockquote></div></p><p><a name="(tech._show._one)"></a><span style="font-style: italic"><span class="stt">SHOW ONE</span></span>: Returns a string containing a single satisfying scenario that Margrave finds (in no particular order), pretty-printed for human consumption.</p><p><div class="SIntrapara"><a name="(tech._show._next)"></a><span style="font-style: italic"><span class="stt">SHOW NEXT</span></span>: Returns a string containing a <span style="font-style: italic">different</span> satisfying scenario, if one exists. Each successive use of <span class="stt">SHOW NEXT</span> will produce a different scenario until all have been given. Using <span class="stt">SHOW ONE</span> or defining a new query with <span class="stt">EXPLORE</span> will cause Margrave to forget which scenarios it has already printed. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Without a preceding <span class="stt">SHOW ONE</span>, the first <span class="stt">SHOW NEXT</span> will behave like <span class="stt">SHOW ONE</span>.</p></blockquote></blockquote></blockquote></div></p><p><a name="(tech._get._one)"></a><span style="font-style: italic"><span class="stt">GET ONE</span></span>, <a name="(tech._get._next)"></a><span style="font-style: italic"><span class="stt">GET NEXT</span></span>, <a name="(tech._get._all)"></a><span style="font-style: italic"><span class="stt">GET ALL</span></span>: Same as above, except returns an XML object that represents the scenario and can be used in programs.</p><p>If the <a href="#%28tech._tupling%29" class="techoutside" data-pltdoc="x"><span class="techinside"><span class="stt">TUPLING</span></span></a> optimization is enabled, the following commands also become available:</p><p><span class="stt">SHOW (UN)REALIZED &lt;atom&gt;, ...</span>: Given a list (&ldquo;candidates&rdquo;) of
<a href="#%28tech._atomic._idb._formula%29" class="techoutside" data-pltdoc="x"><span class="techinside">atomic IDB formula</span></a>s, <font class="badlink"><span class="techoutside"><span class="techinside">atomic predicate formula</span></span></font>s, and
<font class="badlink"><span class="techoutside"><span class="techinside">atomic type formula</span></span></font>s,
returns the subset of the atomic formualas given that can be true (are never true) in a satisfying scenario.
<span style="font-weight: bold">All candidates must be declared in the <span class="stt">INCLUDE</span> clause.</span></p><p>For example:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">EXPLORE mypolicy:permit(s, a, r) </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="stt">INCLUDE mypolicy:rule10_matches(s, a, r)</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="stt">TUPLING; </span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="stt">SHOW REALIZED mypolicy:rule10_matches(s, a, r);</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p><span class="stt">SHOW (UN)REALIZED &lt;atom&gt;, ... FOR CASES &lt;atom&gt;, ...</span>:
Given two lists (&ldquo;candidates&rdquo; and &ldquo;cases&rdquo;) of <a href="#%28tech._atomic._idb._formula%29" class="techoutside" data-pltdoc="x"><span class="techinside">atomic IDB formula</span></a>s,
<font class="badlink"><span class="techoutside"><span class="techinside">atomic predicate formula</span></span></font>s, and <font class="badlink"><span class="techoutside"><span class="techinside">atomic type formula</span></span></font>s,
returns a map taking each case to a separate <span class="stt">SHOW (UN)REALIZED</span> list
where the case was included in the &lt;condition&gt;.</p><p>The Margrave paper [<a href="#%28cite._nbdfk10%29" data-pltdoc="x">nbdfk10</a>] contains more information on the subtleties of the <span class="stt">SHOW REALIZED</span> command,
and the example files contain sample uses. <span class="stt">SHOW REALIZED</span> is especially useful when reasoning about interactions between rules.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;command-language&quot;">2.3<tt>&nbsp;</tt><a name="(part._command-language)"></a>The Command Sub-Language</h4><p>The rest of Margrave&rsquo;s language comprises system commands.</p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Loading_Policies&quot;">2.3.1<tt>&nbsp;</tt><a name="(part._.Loading_.Policies)"></a>Loading Policies</h5><p>To load a policy in Margrave&rsquo;s intermediate language use the <span class="stt">LOAD POLICY</span> command:</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>If the filename path begins with <span class="RktSym">*MARGRAVE*</span>, the <span class="RktSym">*MARGRAVE*</span> will be replaced with Margrave&rsquo;s installation directory.</p></blockquote></blockquote></blockquote><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD POLICY &lt;filename&gt;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>To load a Cisco IOS configuration (that uses the subset of IOS we support; see <a href="#%28part._gs-ios%29" data-pltdoc="x">IOS in Margrave</a>) use the <span class="stt">LOAD IOS</span> command:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS &lt;filename&gt;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>This command will create several new policies in Margrave: <span style="font-style: italic">InboundACL</span>, <span style="font-style: italic">OutboundACL</span>, <span style="font-style: italic">LocalSwitching</span>, <span style="font-style: italic">NetworkSwitching</span>, <span style="font-style: italic">StaticRoute</span>, <span style="font-style: italic">PolicyRoute</span>, and <span style="font-style: italic">DefaultPolicyRoute</span>, each representing a part of the configuration. (For details, see the Margrave paper [<a href="#%28cite._nbdfk10%29" data-pltdoc="x">nbdfk10</a>].)</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS &lt;filename&gt; WITH &lt;prefix&gt; &lt;suffix&gt;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>also creates the above 7 policies, but renames them with the given <span class="stt">&lt;prefix&gt;</span> and <span class="stt">&lt;suffix&gt;</span>.
For instance, given the command:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS "myconfig.txt" WITH "pre" "suff"</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>instead of a policy named <span style="font-style: italic">InboundACL</span>, one named <span style="font-style: italic">preInboundACLsuff</span> will be created. To avoid naming conflicts, use this variant command when loading multiple IOS configurations in the same Margrave session.</p><p>To load multiple router configurations at once, use</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS &lt;filename1&gt;, &lt;filename2&gt;,... IN &lt;directory&gt;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>or</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS &lt;filename1&gt;, &lt;filename2&gt;,... IN &lt;directory&gt; WITH &lt;prefix&gt; &lt;suffix&gt;</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>For instance:</p><blockquote class="SCodeFlow"><p><span class="stt">&gt; </span><span class="stt">LOAD IOS "inner-router.txt", "outer-router.txt" IN "user/tn/myconfigs"</span><span class="hspace">&nbsp;</span><br/><span class="hspace">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span></p></blockquote><p>will include both configurations in the same Margrave policies. (For an example of this, see Section 6.2 of the Margrave firewall paper [<a href="#%28cite._nbdfk10%29" data-pltdoc="x">nbdfk10</a>].)</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>A relative path will be interpreted relative to the location of the script file. If the file is unsaved, or if you are working at the prompt, do not use a relative path.</p></blockquote></blockquote></blockquote><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Renaming_Prior_Queries&quot;">2.3.2<tt>&nbsp;</tt><a name="(part._.Renaming_.Prior_.Queries)"></a>Renaming Prior Queries</h5><p>To rename a query or policy, use the <span class="stt">RENAME</span> command:</p><p><span class="stt">RENAME &lt;old-identifier&gt; &lt;new-identifier&gt;</span></p><p>For example, suppose you want to compare two different versions of the same policy, which have the same name by default. You can load the first version, then</p><p><span class="stt">RENAME policy policy_orig</span></p><p>then load the new version and</p><p><span class="stt">RENAME policy policy_new</span></p><p>Now you can write a single query that refers to both policies, such as this partial change-impact query:</p><p><span class="stt">EXPLORE policy_old:deny(x) AND policy_new:permit(x)</span></p><p>You can also use the <span class="stt">RENAME</span> command to save the <span class="stt">last</span> query created under a unique name:</p><p><span class="stt">RENAME last otherquery</span></p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Getting_INFO&quot;">2.3.3<tt>&nbsp;</tt><a name="(part._.Getting_.I.N.F.O)"></a>Getting INFO</h5><p>To get general information about the Margrave engine, including memory use and other statistics, use the <span class="stt">INFO</span> command:</p><p><span class="stt">INFO</span></p><p>To get information about a specific policy, vocabulary, or saved query, append the policy, vocabulary, or query identifier:</p><p><span class="stt">INFO mypolicy</span></p><h5 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Comments&quot;">2.3.4<tt>&nbsp;</tt><a name="(part._.Comments)"></a>Comments</h5><p>Lines beginning with <span class="stt">//</span> are comments and will be ignored by Margrave.</p><h3 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;Representing_Policies&quot;">3<tt>&nbsp;</tt><a name="(part._.Representing_.Policies)"></a>Representing Policies</h3><p>Policies map <font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font>s to <a href="#%28tech._decision%29" class="techoutside" data-pltdoc="x"><span class="techinside">decision</span></a>s. Each <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> is associated with exactly one <a href="#%28tech._vocabulary%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary</span></a>.
In this section, we demonstrate the elements of policies and vocabularies using the conference policy presented in <a href="#%28part._gs-existing%29" data-pltdoc="x">General Policies in Margrave</a>.</p><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;policies&quot;">3.1<tt>&nbsp;</tt><a name="(part._policies)"></a>Elements of a Policy</h4><p><span class="SSubSubSubSection">The Example Policy</span></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy1</span><span class="hspace">&nbsp;</span><span class="RktSym">uses</span><span class="hspace">&nbsp;</span><span class="RktSym">conferencepolicy</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Target</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperNoConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperAssigned</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Deny</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><ul><li><p><span class="stt">ConferencePolicy1</span> is the <a name="(tech._policy._name)"></a><span style="font-style: italic">policy name</span>.
 Use the policy name to reference the policy in Margrave queries.</p></li><li><p><span class="stt">conferencepolicy</span> is the policy&rsquo;s <a name="(tech._vocabulary._name)"></a><span style="font-style: italic">vocabulary name</span>.
 Every policy has a single <a href="#%28tech._vocabulary%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary</span></a> that dictates what kind of
 <font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font> it handles and which <a href="#%28tech._decision%29" class="techoutside" data-pltdoc="x"><span class="techinside">decision</span></a>s it renders. </p></li><li><p><span class="stt">(Target )</span> is the policy&rsquo;s <a name="(tech._target)"></a><span style="font-style: italic">target</span>. The <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a>
 specifies a guard on the policy&rsquo;s applicability. In order for any rule
 in the policy to apply, the policy&rsquo;s <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a> condition must also
 apply. For instance, <span class="stt">(Target (Reviewer s))</span> would mean that the
 policy applies only to subjects who are reviewers.</p><p>An empty <a href="#%28tech._target%29" class="techoutside" data-pltdoc="x"><span class="techinside">target</span></a>, as shown above, means that
 the policy always applies.</p></li><li><p>The <span class="stt">(Rules ...)</span> construct gives the policy&rsquo;s <a name="(tech._rule)"></a><span style="font-style: italic">rule</span> set.
    Each <a href="#%28tech._rule%29" class="techoutside" data-pltdoc="x"><span class="techinside">rule</span></a> has a name, a decision, and a set of <a name="(tech._condition)"></a><span style="font-style: italic">conditions</span>.
    Each <a href="#%28tech._condition%29" class="techoutside" data-pltdoc="x"><span class="techinside">condition</span></a> must be the use of a <a href="#%28tech._type%29" class="techoutside" data-pltdoc="x"><span class="techinside">type</span></a> or <a href="#%28tech._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">predicate</span></a>
    in the policy&rsquo;s vocabulary. A "!" before a <a href="#%28tech._type%29" class="techoutside" data-pltdoc="x"><span class="techinside">type</span></a> or <a href="#%28tech._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">predicate</span></a>
    name means that the type or predicate does <span style="font-style: italic">not</span> apply.</p><p>The first rule in the example policy:</p><p><span class="stt">(PaperNoConflict = (Permit s a r) :- (!Conflicted s r) (ReadPaper a) (Paper r))</span></p><p>is named <span class="stt">PaperNoConflict</span>, renders the <span class="stt">Permit</span> decision, and applies when
    the subject is trying to read a paper on which he or she is not conflicted.</p><p>The variable names that appear after the decision name (e.g. <span class="stt">Permit s a r</span>) must exactly match
    the names of the request variables declared in the policy&rsquo;s <a href="#%28tech._vocabulary%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabulary</span></a>. New variables can
    be introduced on the right hand side of the rule, in which case they are interpreted
    existentially.</p><p>For instance, in a policy for vehicle access, this rule would apply for any subject
    who owns <span style="font-style: italic">some</span> car, regardless of the action and resource involved:</p><p><span class="stt">(PermitIfOwnsCar = (Permit s a r) :- (Owns s c) (Car c))</span></p></li><li><p><span class="stt">(RComb ...)</span> denotes the policy&rsquo;s
 <a name="(tech._rule._combination._algorithm)"></a><span style="font-style: italic">rule-combination algorithm</span>. This is used to resolve rule conflicts.
 Margrave currently supports <a href="#%28tech._first._applicable%29" class="techoutside" data-pltdoc="x"><span class="techinside">first-applicable</span></a>, <a href="#%28tech._override%29" class="techoutside" data-pltdoc="x"><span class="techinside">overrides</span></a>,
 and <a href="#%28tech._none%29" class="techoutside" data-pltdoc="x"><span class="techinside">none</span></a> combinators:</p><ul><li><p><span class="stt">(RComb FAC)</span>: In <a name="(tech._first._applicable)"></a><span style="font-style: italic">first-applicable</span> policies, rules apply in
   the order in which they appear.</p></li><li><p><span class="stt">(RComb O &lt;decisions&gt;)</span>: In <a name="(tech._override)"></a><span style="font-style: italic">overrides</span> policies,
 the vocabulary gives an
 ordering on the decisions, and higher-priority decisions
 take precedence over lower-priority decisions. E.g.,
 <span class="stt">(RComb O CallPolice Deny Permit)</span> means that the
 CallPolice decision overrides the Deny and Permit decisions,
 and the Deny decision overrides the Permit decision.</p></li><li><p><span class="stt">(RComb none)</span>: In <a name="(tech._none)"></a><span style="font-style: italic">none</span> policies, multiple rules (indeed, multiple
   decisions) can apply to a single request.</p></li></ul></li><li><p>Margrave also supports hierarchical policies via <span class="stt">(Children ...)</span>: A policy&rsquo;s <a name="(tech._children)"></a><span style="font-style: italic">children</span> are a list
 of sub-policies that together form the parent policy. A policy
 contains either <a href="#%28tech._rule%29" class="techoutside" data-pltdoc="x"><span class="techinside">rules</span></a> (in which case it is a
 <a name="(tech._leaf._policy)"></a><span style="font-style: italic">leaf policy</span>) or <a href="#%28tech._children%29" class="techoutside" data-pltdoc="x"><span class="techinside">children</span></a> but never both. For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">Parentpolicy</span><span class="hspace">&nbsp;</span><span class="RktSym">uses</span><span class="hspace">&nbsp;</span><span class="RktSym">myvocab</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">Child1</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">Child2</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>Conflicts between sub-policies are resolved via a <a name="(tech._policy._combination._algorithm)"></a><span style="font-style: italic">policy-combination algorithm</span>, which is set
 with the <span class="stt">(PComb ...)</span> construct. The same options are available to policy combination as to
 rule combination.</p></li></ul><h4 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;vocabularies&quot;">3.2<tt>&nbsp;</tt><a name="(part._vocabularies)"></a>Elements of a Vocabulary</h4><p><span class="SSubSubSubSection">The Example Vocabulary</span></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">PolicyVocab</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Types</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Subject</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Author</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Action</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitReview</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Resource</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">Review</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Decisions</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Permit</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Deny</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Predicates</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">ReqVariables</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">OthVariables</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">Constraints</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">atmostone-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>A policy for a door lock may take keys as requests, and decide whether or not the door opens.
A phone company policy may take source and destination phone numbers and decide whether the call is denied, toll-free, or toll.
Margrave allows users to specify these domain-specific details about a policy using <a href="#%28tech._vocabulary%29" class="techoutside" data-pltdoc="x"><span class="techinside">vocabularies</span></a>.</p><p>A <a name="(tech._vocabulary)"></a><span style="font-style: italic">vocabulary</span> in Margrave contains the following:</p><ul><li><p>The <span class="stt">(Types ...)</span> construct defines a hierarchy of
    <a name="(tech._type)"></a><span style="font-style: italic">type</span>s (also called <a name="(tech._sort)"></a><span style="font-style: italic">sort</span>s) that
    elements of a request may belong to.</p><p>Top-level types (<span class="stt">Subject</span>, <span class="stt">Action</span>, and <span class="stt">Resource</span> in the above example)
    are always pairwise <a href="#%28tech._disjoint%29" class="techoutside" data-pltdoc="x"><span class="techinside">disjoint</span></a>.</p></li><li><p>The <span class="stt">(Predicates ...)</span> construct defines a set of
    <a name="(tech._predicate)"></a><span style="font-style: italic">predicate</span>s that may hold of request
    properties in a scenario. For instance, the binary <a href="#%28tech._predicate%29" class="techoutside" data-pltdoc="x"><span class="techinside">predicate</span></a> <span class="stt">Assigned</span>
    contains reviewer-to-paper assignments in a given scenario.</p></li><li><p>The <span class="stt">(Decisions ...)</span> construct gives a set of <a name="(tech._decision)"></a><span style="font-style: italic">Decisions</span>
    that policies using this vocabulary render. The usual decisions are
    <span class="stt">permit</span> and <span class="stt">deny</span>, but others can appear in more detailed policies.</p></li><li><p>The <span class="stt">(ReqVariables ...)</span> construct defines the shape of a request
    in this vocabulary. The request variables are an ordered list of variable
    names and a type assignment for each.
    For instance, in the access-control domain, the request variables will
    often be <span class="stt">(s, a, r)</span>, representing a single subject, action, and resource.
    In the firewall domain, the request variables will involve IP addresses, ports, etc.</p></li><li><p>The <span class="stt">(Constraints ...)</span> construct gives domain-specific assertions
                     about how types and predicates can be populated. Margrave will not consider
                     scenarios that violate vocabulary constraints, ruling out non-sensical results.</p><p>Valid <a name="(tech._constraint)"></a><span style="font-style: italic">constraint</span> types are:</p><ul><li><p><span class="stt">atmostone</span>: If a type is <a name="(tech._at._most._one)"></a><span style="font-style: italic">at-most-one</span> constrained, it can never contain more than one thing.</p></li><li><p><span class="stt">singleton</span>: If a type is <a name="(tech._singleton)"></a><span style="font-style: italic">singleton</span> constrained, it must contain exactly one thing.</p></li><li><p><span class="stt">nonempty</span>: A <a name="(tech._nonempty)"></a><span style="font-style: italic">nonempty</span> type must never be empty.</p></li><li><p><span class="stt">abstract</span>: An <a name="(tech._abstract)"></a><span style="font-style: italic">abstract</span> type is fully covered by its children.
 For instance, consider a type Bit with child types ZeroBit and OneBit.
 If Bit is abstract, every Bit must be either a zero or a one. </p></li><li><p><span class="stt">partial-function</span>, <span class="stt">total-function</span>: A binary predicate P: (A x B) can be constrained to behave as a total or partial function from A to B.</p></li><li><p><span class="stt">disjoint</span>: Two types that are <a name="(tech._disjoint)"></a><span style="font-style: italic">disjoint</span> must never share an atom.</p></li><li><p><span class="stt">subset</span>: Used to enforce subset constraints that cannot be captured in the type hierarchy.
 If type A is constrained to be a <a name="(tech._subset)"></a><span style="font-style: italic">subset</span> of B, every scenario
 will have A contained in B, even if B is not a super-type of A.</p></li></ul><p>The constraints <a href="#%28tech._disjoint%29" class="techoutside" data-pltdoc="x"><span class="techinside">disjoint</span></a>, <a href="#%28tech._at._most._one%29" class="techoutside" data-pltdoc="x"><span class="techinside">at-most-one</span></a>, <a href="#%28tech._singleton%29" class="techoutside" data-pltdoc="x"><span class="techinside">singleton</span></a>, and <a href="#%28tech._nonempty%29" class="techoutside" data-pltdoc="x"><span class="techinside">nonempty</span></a>
can be applied to <span style="font-style: italic">all</span> subtypes of a type at once by using the <span class="stt">-all</span> suffix.
For instance: Declaring that the <span class="stt">IPAddress</span> type is <span class="stt">disjoint-all</span> constrained forces all of its sub-types to be pairwise disjoint.</p></li></ul><h3 x-source-module="(lib &quot;margrave/scribblings/margrave.scrbl&quot;)" x-source-pkg="margrave" x-part-tag="&quot;doc-bibliography&quot;"><a name="(part._doc-bibliography)"></a>Bibliography</h3><p><table cellspacing="0" cellpadding="0" class="RBibliography"><tr><td><a name="(cite._nbdfk10)"></a>[nbdfk10]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">Timothy Nelson and Christopher Barratt and Daniel J. Dougherty and Kathi Fisler and Shriram Krishnamurthi, &ldquo;The Margrave Tool for Firewall Analysis,&rdquo; Proceedings of the 24th USENIX Large Installation System Administration Conference (LISA 2010), 2010. <a href="http://web.cs.wpi.edu/~tn/publications/index.html#nbdfk10"><span class="stt">http://web.cs.wpi.edu/~tn/publications/index.html#nbdfk10</span></a></span></td></tr></table></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;7.4&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">top</a></span><span class="navright">&nbsp;&nbsp;<span class="nonavigation">&larr; prev</span>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;7.4&quot;);">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>